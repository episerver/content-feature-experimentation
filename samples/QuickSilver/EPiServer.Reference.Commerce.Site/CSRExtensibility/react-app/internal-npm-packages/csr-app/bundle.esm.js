import e,{createElement as t,Fragment as r,Component as n,createRef as s,useState as i,useEffect as o,useCallback as a}from"react";import"@episerver/ui-framework/dist/main.css";import{connect as u,Provider as d}from"react-redux";import{createStyles as c,withStyles as p,Grid as l,TextField as h,Typography as m,Dialog as f,DialogTitle as g,DialogContent as y,DialogActions as v,FormControlLabel as C,Select as S,MenuItem as I,Card as b,CardHeader as A,CardContent as O,MenuList as w,ListItemText as T,Drawer as D,InputBase as P,FormControl as G,InputLabel as N,OutlinedInput as R,Collapse as E,CardActions as x,Divider as L,Paper as M,CircularProgress as F,Avatar as k,Radio as _,AppBar as V,InputAdornment as U,MuiThemeProvider as B}from"@material-ui/core";import{DatePicker as H,DateTimePicker as W,MuiPickersUtilsProvider as q}from"material-ui-pickers";import{combineReducers as j,createStore as Y}from"redux";import{withStyles as z,createStyles as Q,createMuiTheme as K}from"@material-ui/core/styles";import X from"@date-io/moment";import J from"@material-ui/core/Fab";import Z from"@material-ui/icons/FeedbackOutlined";import $ from"@material-ui/core/Grid";import ee from"@material-ui/icons/Warning";import te from"@material-ui/core/Dialog";import re from"@material-ui/core/DialogActions";import ne from"@material-ui/core/DialogContent";import{TextButton as se,IconButton as ie,EditIcon as oe,DeleteIcon as ae,Checkbox as ue,CloseIcon as de,MenuSurface as ce,List as pe,ListItem as le,ListItemText as he,ListDivider as me,TabBar as fe,Tab as ge}from"@episerver/ui-framework";import ye from"@material-ui/core/Typography/Typography";import ve from"@material-ui/core/Snackbar";import Ce from"@material-ui/core/CircularProgress";import Se from"axios";import{getStateNameByStateCode as Ie}from"us-state-codes";import{lookup as be}from"zipcodes";import{object as Ae,string as Oe,number as we,date as Te,boolean as De,bool as Pe,ref as Ge}from"yup";import Ne,{Option as Re}from"@material/react-select";import"@material/react-menu/index.scss";import"@material/react-select/index.scss";import{ValidatorForm as Ee,TextValidator as xe}from"react-material-ui-form-validator";import{BigNumber as Le}from"bignumber.js";import{countries as Me}from"countries-list";import{Link as Fe,Switch as ke,Route as _e,HashRouter as Ve}from"react-router-dom";import Ue from"@material-ui/core/Card";import Be from"@material-ui/core/CardHeader";import He from"@material-ui/core/CardContent";import We from"@material-ui/core/Typography";import qe from"@material-ui/icons/Mail";import je from"@material-ui/icons/Phone";import Ye from"@material-ui/icons/AddCircle";import ze from"@material-ui/core/CardActionArea";import Qe from"@material-ui/core/Slide";import Ke from"@material-ui/core/Hidden";import Xe from"@material-ui/core/AppBar";import Je from"@material-ui/core/Toolbar";import Ze from"@material-ui/icons/Menu";import $e from"@material-ui/core/Table";import et from"@material-ui/core/TableBody";import tt from"@material-ui/core/TableCell";import rt from"@material-ui/core/TableHead";import nt from"@material-ui/core/TablePagination";import st from"@material-ui/core/TableRow";import it from"@material-ui/core/Paper";import ot from"moment";import at from"@material-ui/core/Tooltip";import ut from"@material-ui/core/IconButton";import dt from"@material-ui/icons/Edit";import ct from"@material-ui/icons/Delete";import pt from"@material-ui/icons/Save";import lt from"@material-ui/icons/Close";import{MDCDataTable as ht,MDCDataTableFoundation as mt}from"@material/data-table";import ft from"@material-ui/core/RadioGroup";import gt from"@material-ui/core/FormControlLabel";import yt from"@material-ui/core/FormLabel";import vt from"@material-ui/core/Radio";import Ct from"@material-ui/core/DialogTitle";import St from"@material-ui/core/DialogContentText";import It from"@material-ui/core/Divider";import bt from"@material-ui/core/Chip";import At from"@material-ui/core/TextField";import Ot from"@material-ui/core/InputAdornment";import wt from"@material-ui/core/Avatar";import Tt from"@material-ui/icons/Done";import Dt from"@material-ui/icons/LocalOffer";import Pt from"@material-ui/icons/CardGiftcard";import Gt from"@material-ui/core/Badge";import{debounce as Nt,throttle as Rt}from"lodash-es";import Et from"react-autosuggest";import xt from"@material-ui/icons/ShoppingCart";import Lt,{Input as Mt}from"@material/react-text-field";import{Search as Ft,Clear as kt}from"@material-ui/icons";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var _t=function(e,t){return(_t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function Vt(e,t){function r(){this.constructor=e}_t(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Ut,Bt=function(){return(Bt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function Ht(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r}function Wt(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?s(e.value):new r((function(t){t(e.value)})).then(o,a)}u((n=n.apply(e,t||[])).next())}))}function qt(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function jt(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),s=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}!function(e){e.None="None",e.DeleteAddress="Delete_Address",e.DiscardChanges="Discard_Changes",e.UpdateShipmentStatus="Update_Shipment_Status",e.UpdateOrderStatus="Update_Order_Status",e.UpdateOrderMarket="Update_Order_Market",e.UpdateOrderCurrency="Update_Order_Currency"}(Ut||(Ut={}));var Yt,zt=Ut;!function(e){e.ShippingAddress="Shipping Address",e.BillingAddress="Billing Address"}(Yt||(Yt={}));var Qt,Kt=Yt;!function(e){e.Hide="Hide",e.Add="Add",e.Edit="Edit"}(Qt||(Qt={}));var Xt,Jt=Qt;!function(e){e.None="None",e.PersonalInformation="PersonalInformation",e.AddressBook="AddressBook"}(Xt||(Xt={}));var Zt=Xt,$t={application:{pageIndex:0,rowsPerPage:20,totalOrderGroups:0,notificationMessage:"",customerSelectionViewIsVisible:!1,orderGroupViewIsVisible:!1,lineItemDeleteConfirmationIsVisible:!1,orderGroupFilterIsVisible:!1,notificationMessageIsVisible:!1,baseApiUrl:"./",customerSearchFieldValue:"",customerSearchFieldSuggestions:[],entrySearchFieldValue:"",entrySearchFieldSuggestions:[],entrySelectedSuggestion:null,entrySuggestionQuantity:0,entrySuggestionPlacedPrice:{Currency:"USD",Amount:0,Fractions:2},isLoadingResource:!1,isCurrentFormValid:!1,isCurrentFormDirty:!1,currentDialog:zt.None,selectedContactId:"",isAuthenticated:!0,isLoadingOverlayActive:!1},orderGroup:{currentLineItemId:-1,selectedFormIndex:0,selectedShipmentIndex:0,selectedEntry:null,currentOrderGroup:null,listedOrderGroups:[],couponTextFieldValue:"",orderStatuses:[],currencies:[],paymentPlanSetting:null,currentOrderGroupId:null},orderAddressDropdown:{selectedAddressIndex:-1,searchFieldValue:"",currentOrderAddress:null,currentOrderAddresses:[]},shipment:{shippingMethods:[],currentLineItemExpandedRow:-1,statuses:[]},createOrderAddressForm:{isVisible:!1,isValid:!1,address:{AddressId:"",Name:"",FirstName:"",LastName:"",Email:"",Line1:"",Line2:"",City:"",CountryName:"",RegionCode:"",PostalCode:"",CountryCode:"",DaytimePhoneNumber:"",IsPreferredShippingAddress:!1,IsPreferredBillingAddress:!1,DisplayName:""},phoneNumber:"",callingCode:"",addressType:Kt.ShippingAddress},contact:{currentContact:null,currentAddress:null,contactProfileIsVisible:!1,personalInformationEditViewIsVisible:!1,addressBookIsVisible:!1,addressDetailsViewMode:Jt.Hide,drawerSelectedMenu:Zt.None,drawerNextMenu:Zt.None,customerGroups:[],drawerIsExpanded:!0},createContactForm:{isVisible:!1,isValid:!1,contact:{Id:"",Addresses:[],IsAnonymous:!1}},geographics:{countries:[]},market:{markets:[],selectedMarket:""},addressForm:{phoneNumber:null,callingCode:"",countryCode:""},payment:{isAcceptPaymentFormVisible:!1,addressIsExpanded:!1,paymentMethods:[],paymentMethodId:"",payment:null,billingAddress:null},setting:{pageConfig:{}}};var er=Object.freeze({__proto__:null,showNotification:function(e){return{type:"SHOW_NOTIFICATION",message:e}},openDeleteLineItemConfirmationView:function(){return{type:"OPEN_DELETE_LINE_ITEM_CONFIRMATION_VIEW"}},closeDeleteLineItemConfirmationView:function(){return{type:"CLOSE_DELETE_LINE_ITEM_CONFIRMATION_VIEW"}},hideNotification:function(){return{type:"HIDE_NOTIFICATION"}},toggleOrderGroupFilter:function(){return{type:"TOGGLE_ORDER_GROUP_FILTER"}},setOrderGroupListPageIndex:function(e){return{type:"SET_ORDER_GROUP_LIST_PAGE_INDEX",value:e}},openOrderGroupView:function(){return{type:"OPEN_ORDER_GROUP_VIEW"}},closeOrderGroupView:function(){return{type:"CLOSE_ORDER_GROUP_VIEW"}},openCustomerSelectionView:function(){return{type:"OPEN_CUSTOMER_SELECTION_VIEW"}},closeCustomerSelectionView:function(){return{type:"CLOSE_CUSTOMER_SELECTION_VIEW"}},setBaseApiUrl:function(e){return{type:"SET_BASE_API_URL",url:e}},setCustomerSearchFieldValue:function(e){return{type:"SET_CUSTOMER_SEARCH_FIELD_VALUE",value:e}},setOrderGroupListRowsPerPage:function(e){return{type:"SET_ORDER_GROUP_LIST_ROWS_PER_PAGE",value:e}},setTotalOrderGroups:function(e){return{type:"SET_TOTAL_ORDER_GROUPS",value:e}},setCustomerSearchFieldSuggestions:function(e){return{type:"SET_CUSTOMER_SEARCH_FIELD_SUGGESTIONS",suggestions:e}},setEntrySearchFieldValue:function(e){return{type:"SET_ENTRY_SEARCH_FIELD_VALUE",value:e}},setEntrySearchFieldSuggestions:function(e){return{type:"SET_ENTRY_SEARCH_FIELD_SUGGESTIONS",suggestions:e}},selectEntrySuggestion:function(e){return{type:"SELECT_ENTRY_SUGGESTION",suggestion:e}},setEntrySuggestionQuantity:function(e){return{type:"SET_ENTRY_SUGGESTION_QUANTITY",value:e}},setEntrySuggestionPlacedPrice:function(e){return{type:"SET_ENTRY_SUGGESTION_PLACED_PRICE",value:e}},setIsLoadingResource:function(e){return{type:"SET_IS_LOADING_RESOURCE",value:e}},setIsCurrentFormValid:function(e){return{type:"SET_IS_CURRENT_FORM_VALID",value:e}},setIsCurrentFormDirty:function(e){return{type:"SET_IS_CURRENT_FORM_DIRTY",value:e}},setCurrentDialog:function(e){return{type:"SET_CURRENT_DIALOG",value:e}},setSelectedContactId:function(e){return{type:"SET_SELECTED_CONTACT_ID",contactId:e}},setAuthorized:function(e){return{type:"SET_AUTHORIZED",isAuthenticated:e}},setLoadingOverlayState:function(e){return{type:"SET_LOADING_OVERLAY_STATE",isActive:e}}});var tr=Object.freeze({__proto__:null,setCouponTextFieldValue:function(e){return{type:"SET_COUPON_TEXTFIELD_VALUE",value:e}},setSelectedFormIndex:function(e){return{type:"SET_SELECTED_FORM_INDEX",index:e}},setSelectedShipmentIndex:function(e){return{type:"SET_SELECTED_SHIPMENT_INDEX",index:e}},setSelectedEntry:function(e){return{type:"SET_SELECTED_ENTRY",entry:e}},setCurrentLineItemId:function(e){return{type:"SET_CURRENT_LINE_ITEM_ID",lineItemId:e}},setCurrentOrderGroup:function(e){return{type:"SET_CURRENT_ORDER_GROUP",orderGroup:e}},listOrderGroups:function(e){return{type:"LIST_ORDER_GROUPS",orderGroups:e}},updateCurrentOrderGroup:function(e){return{type:"UPDATE_CURRENT_ORDER_GROUP",orderGroup:e}},setOrderStatuses:function(e){return{type:"SET_ORDER_STATUSES",value:e}},setCurrencies:function(e){return{type:"SET_CURRENCIES",currencies:e}},setSelectedCurrency:function(e){return{type:"SET_SELECTED_CURRENCY",currency:e}},setPaymentPlanSetting:function(e){return{type:"SET_PAYMENTPLAN_SETTING",paymentPlanSetting:e}},setCurrentOrderGroupId:function(e){return{type:"SET_CURRENT_ORDERGROUPID",payload:e}}});var rr=Object.freeze({__proto__:null,setOrderAddresses:function(e){return{type:"SET_ORDER_ADDRESSES",addresses:e}},setSearchFieldValue:function(e){return{type:"SET_SEARCH_FIELD_VALUE",searchFieldValue:e}}});var nr=Object.freeze({__proto__:null,setShippingMethods:function(e){return{type:"SET_SHIPPING_METHODS",shippingMethods:e}},setShipmentStatuses:function(e){return{type:"SET_SHIPMENT_STATUSES",statuses:e}}});var sr=Object.freeze({__proto__:null,setPaymentMethods:function(e){return{type:"SET_PAYMENT_METHODS",paymentMethods:e}},showAcceptPaymentForm:function(){return{type:"SHOW_ACCEPT_PAYMENT_FORM"}},hideAcceptPaymentForm:function(){return{type:"HIDE_ACCEPT_PAYMENT_FORM"}},setPaymentMethodId:function(e){return{type:"SET_PAYMENT_METHOD_ID",id:e}},setPayment:function(e){return{type:"SET_PAYMENT",payment:e}},setBillingAddress:function(e){return{type:"SET_BILLING_ADDRESS",billingAddress:e}},setBillingAddressDropdownIsExpanded:function(e){return{type:"SET_BILLING_ADDRESS_DROPDOWN_IS_EXPANDED",value:e}}});var ir=Object.freeze({__proto__:null,setDrawerIsExpanded:function(e){return{type:"SET_DRAWER_IS_EXPANDED",value:e}},setCurrentContactId:function(e){return{type:"SET_CURRENT_CONTACT_ID",contactId:e}},setCurrentContact:function(e){return{type:"SET_CURRENT_CONTACT",contact:e}},showContactProfile:function(e){return void 0===e&&(e=!1),{type:"SHOW_CONTACT_PROFILE",isReadonly:e}},showAddressBook:function(){return{type:"SHOW_ADDRESS_BOOK"}},showPersonalInformationEditView:function(){return{type:"SHOW_PERSONAL_INFORMATION_EDIT_VIEW"}},setAddressDetailsViewMode:function(e){return{type:"SET_ADDRESS_DETAILS_VIEW_MODE",mode:e}},setDrawerSelectedMenu:function(e){return{type:"SET_DRAWER_SELECTED_MENU",value:e}},setDrawerNextMenu:function(e){return{type:"SET_DRAWER_NEXT_MENU",value:e}},setCurrentAddress:function(e){return{type:"SET_CURRENT_ADDRESS",address:e}},setCustomerGroups:function(e){return{type:"SET_CUSTOMER_GROUPS",customerGroups:e}}});var or=Object.freeze({__proto__:null,showCreateContactForm:function(){return{type:"SHOW_CREATE_CONTACT_FORM"}},hideCreateContactForm:function(){return{type:"HIDE_CREATE_CONTACT_FORM"}},setCreateContactFormContact:function(e){return{type:"SET_CREATE_CONTACT_FORM_CONTACT",contact:e}},setCreateContactFormIsValid:function(e){return{type:"SET_CREATE_CONTACT_FORM_ISVALID",isValid:e}}});var ar=Object.freeze({__proto__:null,showCreateOrderAddressForm:function(e){return{type:"SHOW_CREATE_ORDER_ADDRESS_FORM",addressType:e}},hideCreateOrderAddressForm:function(){return{type:"HIDE_CREATE_ORDER_ADDRESS_FORM"}},setCreateOrderAddressFormAddress:function(e){return{type:"SET_CREATE_ORDER_ADDRESS_FORM_ADDRESS",address:e}},setCreateOrderAddressFormIsValid:function(e){return{type:"SET_CREATE_ORDER_ADDRESS_FORM_ISVALID",isValid:e}}});var ur=Object.freeze({__proto__:null,setCountries:function(e){return{type:"SET_COUNTRIES",countries:e}}});var dr=Object.freeze({__proto__:null,setMarkets:function(e){return{type:"SET_MARKETS",markets:e}},setSelectedMarket:function(e){return{type:"SET_SELECTED_MARKET",market:e}}});var cr=Object.freeze({__proto__:null,clearAddressForm:function(){return{type:"CLEAR_ADDRESS_FORM"}},initializeAddressForm:function(e){return{type:"INITIALIZE_ADDRESS_FORM",payload:e}}});var pr,lr,hr=Object.freeze({__proto__:null,updateSetting:function(e){return{type:"UPDATE_SETTING",payload:e}}}),mr=j({application:function(e,t){switch(void 0===e&&(e=$t.application),t.type){case"SHOW_NOTIFICATION":return Bt(Bt({},e),{notificationMessage:t.message,notificationMessageIsVisible:!0});case"HIDE_NOTIFICATION":return Bt(Bt({},e),{notificationMessage:"",notificationMessageIsVisible:!1});case"OPEN_CUSTOMER_SELECTION_VIEW":return Bt(Bt({},e),{customerSelectionViewIsVisible:!0});case"CLOSE_CUSTOMER_SELECTION_VIEW":return Bt(Bt({},e),{customerSelectionViewIsVisible:!1});case"OPEN_DELETE_LINE_ITEM_CONFIRMATION_VIEW":return Bt(Bt({},e),{lineItemDeleteConfirmationIsVisible:!0});case"CLOSE_DELETE_LINE_ITEM_CONFIRMATION_VIEW":return Bt(Bt({},e),{lineItemDeleteConfirmationIsVisible:!1});case"OPEN_ORDER_GROUP_VIEW":return Bt(Bt({},e),{orderGroupViewIsVisible:!0});case"CLOSE_ORDER_GROUP_VIEW":return Bt(Bt({},e),{orderGroupViewIsVisible:!1,entrySearchFieldSuggestions:[],entrySelectedSuggestion:null,entrySearchFieldValue:"",entrySuggestionQuantity:$t.application.entrySuggestionQuantity,isLoadingResource:!1});case"TOGGLE_ORDER_GROUP_FILTER":return Bt(Bt({},e),{orderGroupFilterIsVisible:!e.orderGroupFilterIsVisible});case"SET_CUSTOMER_SEARCH_FIELD_VALUE":return Bt(Bt({},e),{customerSearchFieldValue:t.value});case"SET_CUSTOMER_SEARCH_FIELD_SUGGESTIONS":return Bt(Bt({},e),{customerSearchFieldSuggestions:t.suggestions});case"SET_BASE_API_URL":return Bt(Bt({},e),{baseApiUrl:t.url});case"SET_ENTRY_SEARCH_FIELD_VALUE":return Bt(Bt({},e),{entrySearchFieldValue:t.value,entrySelectedSuggestion:null,entrySuggestionQuantity:$t.application.entrySuggestionQuantity,entrySuggestionPlacedPrice:$t.application.entrySuggestionPlacedPrice});case"SET_ENTRY_SEARCH_FIELD_SUGGESTIONS":return Bt(Bt({},e),{entrySearchFieldSuggestions:t.suggestions});case"SELECT_ENTRY_SUGGESTION":return Bt(Bt({},e),{entrySelectedSuggestion:t.suggestion,entrySuggestionQuantity:1,entrySuggestionPlacedPrice:t.suggestion.Price});case"SET_ENTRY_SUGGESTION_QUANTITY":return Bt(Bt({},e),{entrySuggestionQuantity:t.value});case"SET_ENTRY_SUGGESTION_PLACED_PRICE":return Bt(Bt({},e),{entrySuggestionPlacedPrice:t.value});case"SET_IS_LOADING_RESOURCE":return Bt(Bt({},e),{isLoadingResource:t.value});case"SET_ORDER_GROUP_LIST_PAGE_INDEX":return Bt(Bt({},e),{pageIndex:t.value});case"SET_ORDER_GROUP_LIST_ROWS_PER_PAGE":return Bt(Bt({},e),{rowsPerPage:t.value});case"SET_TOTAL_ORDER_GROUPS":return Bt(Bt({},e),{totalOrderGroups:t.value});case"SET_IS_CURRENT_FORM_VALID":return Bt(Bt({},e),{isCurrentFormValid:t.value});case"SET_IS_CURRENT_FORM_DIRTY":return Bt(Bt({},e),{isCurrentFormDirty:t.value});case"SET_CURRENT_DIALOG":return Bt(Bt({},e),{currentDialog:t.value});case"SET_SELECTED_CONTACT_ID":return Bt(Bt({},e),{selectedContactId:t.contactId});case"SET_AUTHORIZED":return Bt(Bt({},e),{isAuthenticated:t.isAuthenticated});case"SET_LOADING_OVERLAY_STATE":return Bt(Bt({},e),{isLoadingOverlayActive:t.isActive});default:return e}},orderGroup:function(e,t){switch(void 0===e&&(e=$t.orderGroup),t.type){case"SET_SELECTED_FORM_INDEX":return Bt(Bt({},e),{selectedFormIndex:t.index});case"SET_SELECTED_SHIPMENT_INDEX":return Bt(Bt({},e),{selectedShipmentIndex:t.index});case"SET_SELECTED_ENTRY":return Bt(Bt({},e),{selectedEntry:t.entry});case"LIST_ORDER_GROUPS":return Bt(Bt({},e),{listedOrderGroups:t.orderGroups});case"SET_CURRENT_ORDER_GROUP":return Bt(Bt({},e),{currentOrderGroup:Object.assign({},t.orderGroup)});case"UPDATE_CURRENT_ORDER_GROUP":var r=e.listedOrderGroups.map((function(e){return e.OrderGroupId===t.orderGroup.OrderGroupId?Object.assign(e,t.orderGroup):e}));return Bt(Bt({},e),{currentOrderGroup:Object.assign({},t.orderGroup),listedOrderGroups:r});case"SET_CURRENT_LINE_ITEM_ID":return Bt(Bt({},e),{currentLineItemId:t.lineItemId});case"SET_COUPON_TEXTFIELD_VALUE":return Bt(Bt({},e),{couponTextFieldValue:t.value});case"SET_ORDER_STATUSES":return Bt(Bt({},e),{orderStatuses:t.value});case"SET_CURRENCIES":return Bt(Bt({},e),{currencies:t.currencies});case"SET_PAYMENTPLAN_SETTING":return Bt(Bt({},e),{paymentPlanSetting:t.paymentPlanSetting});case"SET_CURRENT_ORDERGROUPID":return Bt(Bt({},e),{currentOrderGroupId:t.payload});default:return e}},contact:function(e,t){switch(void 0===e&&(e=$t.contact),t.type){case"SHOW_CONTACT_PROFILE":return Bt(Bt({},e),{contactProfileIsVisible:!0,personalInformationEditViewIsVisible:!1,addressBookIsVisible:!1,addressDetailsViewMode:Jt.Hide,drawerSelectedMenu:Zt.PersonalInformation});case"SHOW_ADDRESS_BOOK":return Bt(Bt({},e),{contactProfileIsVisible:!1,personalInformationEditViewIsVisible:!1,addressBookIsVisible:!0,addressDetailsViewMode:Jt.Hide,drawerSelectedMenu:Zt.AddressBook});case"SET_DRAWER_IS_EXPANDED":return Bt(Bt({},e),{drawerIsExpanded:t.value});case"SHOW_PERSONAL_INFORMATION_EDIT_VIEW":return Bt(Bt({},e),{contactProfileIsVisible:!0,personalInformationEditViewIsVisible:!0,drawerSelectedMenu:Zt.PersonalInformation});case"SET_ADDRESS_DETAILS_VIEW_MODE":return Bt(Bt({},e),{addressDetailsViewMode:t.mode});case"SET_DRAWER_SELECTED_MENU":return Bt(Bt({},e),{drawerSelectedMenu:t.value});case"SET_DRAWER_NEXT_MENU":return Bt(Bt({},e),{drawerNextMenu:t.value});case"SET_CURRENT_CONTACT":return Bt(Bt({},e),{currentContact:Object.assign({},t.contact)});case"SET_CURRENT_ADDRESS":return Bt(Bt({},e),{currentAddress:Object.assign({},t.address)});case"SET_CUSTOMER_GROUPS":return Bt(Bt({},e),{customerGroups:jt(t.customerGroups)});default:return e}},geographics:function(e,t){switch(void 0===e&&(e=$t.geographics),t.type){case"SET_COUNTRIES":return Bt(Bt({},e),{countries:t.countries});default:return e}},market:function(e,t){switch(void 0===e&&(e=$t.market),t.type){case"SET_MARKETS":return Bt(Bt({},e),{markets:t.markets});case"SET_SELECTED_MARKET":return Bt(Bt({},e),{selectedMarket:t.market});default:return e}},addressForm:function(e,t){switch(void 0===e&&(e=$t.addressForm),t.type){case"INITIALIZE_ADDRESS_FORM":return Bt(Bt({},e),{phoneNumber:t.payload.DaytimePhoneNumber});case"CLEAR_ADDRESS_FORM":return Object.assign({},$t.addressForm);default:return e}},createContactForm:function(e,t){switch(void 0===e&&(e=$t.createContactForm),t.type){case"SHOW_CREATE_CONTACT_FORM":return Bt(Bt({},e),{isVisible:!0,isValid:!1,contact:$t.createContactForm.contact});case"HIDE_CREATE_CONTACT_FORM":return Bt(Bt({},e),{isVisible:!1});case"SET_CREATE_CONTACT_FORM_CONTACT":return Bt(Bt({},e),{contact:t.contact});case"SET_CREATE_CONTACT_FORM_ISVALID":return Bt(Bt({},e),{isValid:t.isValid});default:return e}},createOrderAddressForm:function(e,t){switch(void 0===e&&(e=$t.createOrderAddressForm),t.type){case"SHOW_CREATE_ORDER_ADDRESS_FORM":return Bt(Bt({},e),{isVisible:!0,addressType:t.addressType});case"HIDE_CREATE_ORDER_ADDRESS_FORM":return Bt(Bt({},e),{isVisible:!1});case"SET_CREATE_ORDER_ADDRESS_FORM_ADDRESS":return Bt(Bt({},e),{address:Object.assign({},t.address)});case"SET_CREATE_ORDER_ADDRESS_FORM_ISVALID":return Bt(Bt({},e),{isValid:t.isValid});default:return e}},orderAddressDropdown:function(e,t){switch(void 0===e&&(e=$t.orderAddressDropdown),t.type){case"SET_ORDER_ADDRESSES":return Bt(Bt({},e),{currentOrderAddresses:jt(t.addresses)});case"SET_SEARCH_FIELD_VALUE":return Bt(Bt({},e),{searchFieldValue:t.searchFieldValue});default:return e}},shipment:function(e,t){switch(void 0===e&&(e=$t.shipment),t.type){case"SET_SHIPPING_METHODS":return Bt(Bt({},e),{shippingMethods:jt(t.shippingMethods)});case"SET_SHIPMENT_STATUSES":return Bt(Bt({},e),{statuses:jt(t.statuses)});default:return e}},payment:function(e,t){switch(void 0===e&&(e=$t.payment),t.type){case"SET_PAYMENT_METHODS":return Bt(Bt({},e),{paymentMethods:jt(t.paymentMethods)});case"SHOW_ACCEPT_PAYMENT_FORM":return Bt(Bt({},e),{isAcceptPaymentFormVisible:!0});case"HIDE_ACCEPT_PAYMENT_FORM":return Bt(Bt({},$t.payment),{paymentMethods:e.paymentMethods,isAcceptPaymentFormVisible:!1});case"SET_PAYMENT_METHOD_ID":return Bt(Bt({},e),{paymentMethodId:t.id});case"SET_PAYMENT":return Bt(Bt({},e),{payment:t.payment?Object.assign({},t.payment):null});case"SET_BILLING_ADDRESS":return Bt(Bt({},e),{billingAddress:t.billingAddress?Object.assign({},t.billingAddress):null});case"SET_BILLING_ADDRESS_DROPDOWN_IS_EXPANDED":return Bt(Bt({},e),{addressIsExpanded:t.value});default:return e}},setting:function(e,t){switch(void 0===e&&(e=$t.setting),t.type){case"UPDATE_SETTING":return Bt(Bt({},e),t.payload);default:return e}}}),fr={ApplicationActions:er,OrderGroupActions:tr,ContactActions:ir,AddressFormActions:cr,MarketActions:dr,GeographicsActions:ur,PaymentActions:sr,ShipmentActions:nr,OrderAddressDropdownActions:rr,CreateContactFormActions:or,CreateOrderAddressFormAction:ar,AppSettingActions:hr},gr=Y(mr,$t,(process.env.NODE_ENV,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),yr=p((function(e){e.palette;return c({root:{position:"fixed",bottom:"10px",right:"10px",width:"40px",height:"40px"},feedbackIcon:{color:"white",verticalAlign:"middle",width:"20px"}})}))((function(t){return e.createElement("a",{title:"Feedback to Epi",href:"mailto:feedback@episerver.com?subject=Feedback for Order Management"},e.createElement(J,{color:"primary",className:t.classes.root},e.createElement(Z,{className:t.classes.feedbackIcon,color:"inherit"})))})),vr=u((function(e){return{isAuthenticated:e.application.isAuthenticated}}))((function(e){return e.isAuthenticated?t(r,null):t(te,{open:!0,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0},t(ne,{id:"alert-dialog-description"},t($,{container:!0,direction:"row"},t($,{item:!0,xs:12,sm:3},t(ee,{style:{fontSize:100}})),t($,{item:!0,xs:12,sm:9},t(ye,{variant:"h6",gutterBottom:!0},"Your session has expired. Please relogin.")))),t(re,null,t(se,{onClick:function(){window.location.reload()}},"Log me in")))})),Cr=z((function(e){var t=e.palette,r=e.spacing;return c({close:{width:4*r.unit,height:4*r.unit},action:{color:t.primary.light+" !important"}})}))(u((function(e,t){return{notificationMessage:e.application.notificationMessage,notificationMessageIsVisible:e.application.notificationMessageIsVisible,classes:t.classes}}))((function(e){var r="string"==typeof e.notificationMessage?t("span",null,e.notificationMessage):t("ul",null,Object.keys(e.notificationMessage).map((function(r,n){return t("li",{key:n},e.notificationMessage[r])}))),n=function(){e.dispatch(fr.ApplicationActions.hideNotification())};return t(ve,{anchorOrigin:{vertical:"top",horizontal:"left"},open:e.notificationMessageIsVisible,autoHideDuration:6e3,onClose:n,message:t("div",{id:"message-id"},r),action:[t(se,{key:"close",onClick:n,className:e.classes.action},"Close")]})}))),Sr=function(){return c({overlay:{position:"fixed",height:"100%",width:"100%",top:"0px",left:"0px",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1.2em",color:"#FFF",background:"rgba(0, 0, 0, 0.7)",zIndex:2147483647,transition:"opacity 500ms ease-in",opacity:1}})},Ir=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return Vt(r,t),r.prototype.render=function(){return this.props.isActive&&e.createElement("div",{className:this.props.classes.overlay},e.createElement(Ce,{size:60}))},r}(e.Component),br=z(Sr)(Ir),Ar=z(Sr)(u((function(e,t){return{isActive:e.application.isLoadingOverlayActive,classes:t.classes}}))(br)),Or=function(){this.initialize=function(e){Se.interceptors.response.use((function(e){return e}),(function(t){return t.message=t.response.data.MessageDetail||t.response.data||t.message,401===t.response.status&&(t.message="Unauthorized",e.dispatch(fr.ApplicationActions.setAuthorized(!1))),Promise.reject(t)}))}},wr="/",Tr="/customers",Dr="/customers/:id",Pr="/customers/:id/info",Gr="/customers/:id/edit",Nr="/customers/:id/addresses",Rr="/customers/:id/orders",Er="/orders",xr="/carts",Lr="/paymentplans",Mr="/orders/:id",Fr="/carts/:id",kr="/paymentplans/:id",_r="/orders/:id/returns/:formId",Vr="/createorder",Ur="/createPaymentPlan",Br=(null===(pr=document.querySelector("#root"))||void 0===pr?void 0:pr.getAttribute("data-epi-apiurl"))||"/api",Hr=function(){this.getOrderGroupRouting=function(e){switch(e){case"Order":return Er;case"PaymentPlan":return Lr;case"Cart":return xr;default:return""}},this.baseApiUrl=Br},Wr=function(e){return Bt(Bt({},e),{Created:new Date(e.Created),Modified:new Date(e.Modified)})},qr=function(e){function t(){var t=e.call(this)||this;return t.getOrders=function(e){return Wt(t,void 0,void 0,(function(){var t,r,n;return qt(this,(function(s){switch(s.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e.orderGroupType),r={startingIndex:e.startingIndex,numberOfRecords:e.numberOfRecords},e.searchText.length>0&&(r.searchValue=encodeURIComponent(e.searchText),r.searchField=e.searchType),[4,Se.get(t,{params:r})];case 1:return[2,{TotalOrderGroups:(n=s.sent()).data.TotalOrderGroups,Results:n.data.Results.map((function(e,t){return Wr(e)}))}]}}))}))},t.getReturns=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns",[4,Se.get(t)];case 1:return[2,{Totals:(r=n.sent()).data.Totals,Results:r.data.Results.map((function(e,t){return Wr(e)}))}]}}))}))},t.getReturn=function(e,r){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns/"+r,[4,Se.get(t)];case 1:return[2,n.sent().data]}}))}))},t.initPurchaseOrder=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n,s;return qt(this,(function(i){switch(i.label){case 0:return t=""+this.baseApiUrl+Er+"/initorder/"+e+"/"+r,[4,Se.post(t)];case 1:return n=i.sent(),(s=Wr(n.data)).IsDraft=!0,[2,s]}}))}))},t.initExchangeOrder=function(e){return Wt(t,void 0,void 0,(function(){var t,r,n;return qt(this,(function(s){switch(s.label){case 0:return t=""+this.baseApiUrl+Er+"/initexchange/"+e,[4,Se.post(t)];case 1:return r=s.sent(),(n=Wr(r.data)).IsDraft=!0,[2,n]}}))}))},t.createPurchaseOrder=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+Er,[4,Se.post(t,e)];case 1:return r=n.sent(),[2,Wr(r.data)]}}))}))},t.calculateOrder=function(e){return Wt(t,void 0,void 0,(function(){var t,r,n;return qt(this,(function(s){switch(s.label){case 0:return t=""+this.baseApiUrl+Er+"/calculate",[4,Se.post(t,e)];case 1:return r=s.sent(),(n=Wr(r.data)).IsDraft=!0,[2,n]}}))}))},t.createReturn=function(e,r){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns",[4,Se.post(t,r)];case 1:return[2,n.sent().data]}}))}))},t.cancelReturn=function(e,r){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns/"+r+"/cancel",[4,Se.post(t)];case 1:return[2,n.sent().data]}}))}))},t.acknowledgeReceiptItems=function(e,r){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns/"+r+"/acknowledgeReceiptItems",[4,Se.post(t)];case 1:return[2,n.sent()]}}))}))},t.getSingleOrderGroup=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n;return qt(this,(function(s){switch(s.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r,[4,Se.get(t)];case 1:return n=s.sent(),[2,Wr(n.data)]}}))}))},t.addCoupon=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r+"/forms/"+n+"/coupons",[4,Se.post(t,s)];case 1:return[2,i.sent()]}}))}))},t.removeCoupon=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r+"/forms/"+n+"/coupons",[4,Se.delete(t,{params:{couponCode:s.Code}})];case 1:return[2,i.sent()]}}))}))},t.deleteLineItem=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(s){switch(s.label){case 0:return t=""+this.baseApiUrl+this.getOrderGroupRouting(e)+"/"+r+"/lineitems/"+n,[4,Se.delete(t)];case 1:return[2,s.sent()]}}))}))},t.deleteReturnLineItem=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(s){switch(s.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns/"+r+"/lineitems/"+n,[4,Se.delete(t)];case 1:return[2,s.sent()]}}))}))},t.updateLineItem=function(e){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e.OrderGroupType)+"/"+e.OrderGroupId+"/lineitems/"+e.LineItemId,[4,Se.patch(t,e)];case 1:return[2,r.sent()]}}))}))},t.updateReturnLineItem=function(e,r,n,s,i){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(o){switch(o.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns/"+r+"/lineitems/"+n,[4,Se.patch(t,{returnQuantity:s,returnReason:i})];case 1:return[2,o.sent()]}}))}))},t.updateReturnForm=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(s){switch(s.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns/"+r,[4,Se.patch(t,n)];case 1:return[2,s.sent()]}}))}))},t.updateExchangeOrderId=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(s){switch(s.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/returns/"+r+"/"+n,[4,Se.patch(t)];case 1:return[2,s.sent()]}}))}))},t.addLineItemToOrderGroup=function(e,r,n,s,i){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(o){switch(o.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r+"/forms/"+n+"/shipments/"+s+"/lineitems",[4,Se.post(t,i)];case 1:return[2,o.sent()]}}))}))},t.initLineItem=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=""+this.baseApiUrl+Er+"/inititem?currencyCode="+e+"&marketId="+r+"&customerId="+n,[4,Se.post(t,s)];case 1:return[4,i.sent().data];case 2:return[2,i.sent()]}}))}))},t.getOrderStatuses=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=this.baseApiUrl+"/orderstatuses",[4,Se.get(e)];case 1:return[2,t.sent().data]}}))}))},t.updateOrderStatus=function(e,r){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+Er+"/"+e+"/status/"+r,[4,Se.put(t)];case 1:return[2,n.sent()]}}))}))},t.getReturnReasons=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=this.baseApiUrl+"/returnorders/returnreasons/",[4,Se.get(e)];case 1:return[2,t.sent().data]}}))}))},t.addShippingAddress=function(e,r,n,s,i){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(o){switch(o.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r+"/forms/"+n+"/shipments/"+s+"/shippingAddress",[4,Se.post(t,i)];case 1:return[2,o.sent()]}}))}))},t.updateShippingAddress=function(e,r,n,s,i){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(o){switch(o.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r+"/forms/"+n+"/shipments/"+s+"/shippingaddress",[4,Se.put(t,i)];case 1:return[2,o.sent()]}}))}))},t.updateShippingMethod=function(e,r,n,s,i){return Wt(t,void 0,void 0,(function(){var t,o;return qt(this,(function(a){switch(a.label){case 0:return t={shippingMethodId:i},o=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r+"/forms/"+n+"/shipments/"+s+"/shippingmethod",[4,Se.patch(o,t)];case 1:return[2,a.sent()]}}))}))},t.getPaymentModel=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+r+"/forms/"+n+"/payments/getmodel/"+s,[4,Se.get(t)];case 1:return[2,i.sent().data]}}))}))},t.addPayment=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(e)+"/"+n+"/forms/"+s+"/payments",[4,Se.post(t,r)];case 1:return[2,i.sent()]}}))}))},t.createRefund=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(s){switch(s.label){case 0:return t=this.baseApiUrl+"/orders/"+e+"/forms/"+r+"/payments/refund",[4,Se.post(t,n)];case 1:return[2,s.sent()]}}))}))},t.updateCurrencyForOrder=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t,s;return qt(this,(function(i){switch(i.label){case 0:return t=this.getOrderGroupRouting(e),s=this.baseApiUrl+"/"+t+"/"+r+"/currency/"+n,[4,Se.patch(s)];case 1:return[2,i.sent()]}}))}))},t.getPlacedPrice=function(e,r,n,s,i){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(o){switch(o.label){case 0:return t=this.baseApiUrl+"/entries/placedprice",[4,Se.post(t,{entryCode:e,quantity:r,marketId:n,currency:s,customerId:i})];case 1:return[2,o.sent()]}}))}))},t.getRefundInfo=function(e,r){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return[4,Se.get(this.baseApiUrl+"/orders/"+e+"/returns/"+r+"/getRefundInfo")];case 1:return[2,t.sent()]}}))}))},t.completeReturn=function(e,r){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return[4,Se.post(this.baseApiUrl+"/orders/"+e+"/returns/"+r+"/completeReturn")];case 1:return[2,t.sent()]}}))}))},t.initPaymentPlan=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n,s;return qt(this,(function(i){switch(i.label){case 0:return t=""+this.baseApiUrl+Lr+"/initPaymentPlan/"+e+"/"+r,[4,Se.post(t)];case 1:return n=i.sent(),(s=Wr(n.data)).IsDraft=!0,[2,s]}}))}))},t}return Vt(t,e),t}(Hr),jr=function(e){function t(){var t=e.call(this)||this;return t.getCustomerCart=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n,s;return qt(this,(function(i){switch(i.label){case 0:return t=""+this.baseApiUrl+Tr+"/"+e+xr+"/Default/"+r,[4,Se.get(t)];case 1:return n=i.sent(),s=Wr(n.data),[2,204===n.status?null:s]}}))}))},t.createOrRefreshCart=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t,s,i;return qt(this,(function(o){switch(o.label){case 0:return t=this.baseApiUrl+"/carts",[4,Se.put(t,null,{params:{marketId:r,contactId:e,cartName:n}})];case 1:return s=o.sent(),i=Wr(s.data),[2,201===s.status?i:null]}}))}))},t.deleteCart=function(e){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return t=this.baseApiUrl+"/carts/"+e,[4,Se.delete(t)];case 1:return[2,r.sent()]}}))}))},t.convertToPurchaseOrder=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+xr+"/"+e+"/ConvertToPurchaseOrder",[4,Se.post(t)];case 1:return r=n.sent(),[2,Wr(r.data)]}}))}))},t.convertToPaymentPlan=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+xr+"/"+e+"/ConvertToPaymentPlan",[4,Se.post(t)];case 1:return r=n.sent(),[2,Wr(r.data)]}}))}))},t.updateMarketForCart=function(e,r){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(n){switch(n.label){case 0:return t=""+this.baseApiUrl+xr+"/"+e+"/market/"+r,[4,Se.patch(t)];case 1:return[2,n.sent()]}}))}))},t}return Vt(t,e),t}(Hr),Yr=function(e){function t(){var t=e.call(this)||this;return t.getPurchaseOrders=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t,s;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/paymentplans/"+e+"/purchaseOrders",[4,Se.get(t,{params:{orderGroupId:e,startingIndex:r,numberOfRecords:n}})];case 1:return[2,{TotalOrderGroups:(s=i.sent()).data.TotalOrderGroups,Results:s.data.Results.map((function(e,t){return Wr(e)}))}]}}))}))},t.convertToPurchaseOrder=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=this.baseApiUrl+"/paymentplans/"+e+"/convertToPurchaseOrder",[4,Se.post(t)];case 1:return r=n.sent(),[2,Wr(r.data)]}}))}))},t.cancelPaymentPlan=function(e){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return t=this.baseApiUrl+"/paymentplans/"+e+"/cancel",[4,Se.post(t)];case 1:return[2,r.sent()]}}))}))},t.createPaymentPlan=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n;return qt(this,(function(s){switch(s.label){case 0:return t=this.baseApiUrl+"/paymentplans/"+e,[4,Se.post(t,r)];case 1:return n=s.sent(),[2,Wr(n.data)]}}))}))},t.updatePaymentPlanSetting=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n;return qt(this,(function(s){switch(s.label){case 0:return t=this.baseApiUrl+"/paymentplans/"+e,[4,Se.put(t,r)];case 1:return n=s.sent(),[2,Wr(n.data)]}}))}))},t}return Vt(t,e),t}(Hr),zr=function(e){this.firstName=e.FirstName||"",this.middleName=e.MiddleName||"",this.lastName=e.LastName||"",this.fullName=e.FullName||"",this.email=e.Email||"",this.customerGroup=e.CustomerGroup||""},Qr=function(e){function t(t){return e.call(this,t)||this}return Vt(t,e),t}(zr),Kr=function(e){function t(t){var r=e.call(this,t)||this;return r.id=t.Id,r}return Vt(t,e),t}(zr);!function(e){e[e.Name=128]="Name",e[e.FirstName=64]="FirstName",e[e.LastName=64]="LastName",e[e.Organization=64]="Organization",e[e.Line1=80]="Line1",e[e.Line2=80]="Line2",e[e.City=64]="City",e[e.State=64]="State",e[e.CountryCode=50]="CountryCode",e[e.CountryName=50]="CountryName",e[e.PostalCode=20]="PostalCode",e[e.RegionCode=50]="RegionCode",e[e.RegionName=64]="RegionName",e[e.DaytimePhoneNumber=32]="DaytimePhoneNumber",e[e.EveningPhoneNumber=32]="EveningPhoneNumber",e[e.Email=256]="Email"}(lr||(lr={}));var Xr=lr,Jr=function(t){var r=t.value.toString();return e.createElement(Ne,{key:t.refreshCounter||0,label:t.label,value:r,disabled:t.disabled,required:t.required,enhanced:!0,outlined:!0,onEnhancedChange:function(e,r){if(t.onChange){var n=r.getAttribute("data-value");"number"==typeof t.value?t.onChange(Number(n)):t.onChange(n)}},className:"epi-exposed-dropdown"+(t.fullWidth?" fullwidth":"")+(t.dense?" dense":"")},t.options.map((function(t){return e.createElement(Re,{key:t.value,value:t.value},t.label)})))},Zr=function(){function e(){}return e.Required="required",e.IsEmpty="isEmpty",e.IsNumber="isNumber",e.IsFloat="isFloat",e.IsPositive="isPositive",e.IsString="isString",e.IsEmail="isEmail",e.MaxStringLength="maxStringLength",e.MinStringLength="minStringLength",e.NotAllowPotentialXSSCharacters="notAllowPotentialXSSCharacters",e.IsURL="isURL",e.IsDate="isDate",e.IsDateTime="isDateTime",e.IsFloatRegex="matchRegexp:^[+-]?([0-9]+[.])?[0-9]+$",e.IsMoney="isMoney",e.IsInteger="isInteger",e.IsDecimal="isDecimal",e.isValidInteger=function(e){return!(isNaN(e)||e>2147483647||e<-2147483648)},e.isValidMoney=function(e){var t=new Le(e);return""===e||!(t.isNaN()||t.decimalPlaces()>4||t.isGreaterThan(new Le("922337203685477.5807"))||t.isLessThan(0))},e.isValidDecimal=function(e){var t=new Le(e);return""===e||!(t.isNaN()||t.decimalPlaces()>0||t.gt(new Le("9".repeat(18)))||t.lt(new Le("-"+"9".repeat(18))))},e.isValidUrl=function(e){return!e||/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(e)},e.setMaxStringLength=function(e){return"maxStringLength:"+e.toString()},e.setMinStringLength=function(e){return"minStringLength:"+e.toString()},e.getValidationMessage=function(t,r){switch(void 0===r&&(r=null),t){case e.Required:return"This field is required";case e.IsEmail:return"E-mail is not valid";case e.NotAllowPotentialXSSCharacters:return"Field must not contain any of the \n                    following characters: '<\">*%&:?";case e.MaxStringLength:return"Field exceeds maximum of "+r.toString()+" characters allowed";case e.MinStringLength:return"Field must be at least "+r.toString()+" character(s)";case e.IsNumber:return"Number is not valid";case e.IsURL:return"URL is not valid";case e.IsDate:return"Date is not valid";case e.IsDateTime:return"DateTime is not valid";case e.IsFloatRegex:return"Number is not valid";case e.IsMoney:return"Money is not valid";case e.IsInteger:return"Integer is not valid";case e.IsDecimal:return"Decimal is not valid";default:return"Not yet defined validation message"}},e.initCustomValidator=function(){Ee.addValidationRule(e.NotAllowPotentialXSSCharacters,(function(e){return!new RegExp(/[\<\>\*\%\&\:\\\?\'\"]/).test(e)})),Ee.addValidationRule(e.Required,(function(e){return null!=e&&void 0!==e&&(e instanceof Array?e.length>0:"string"!=typeof e||""!==e.trim())}))},e}();Zr.initCustomValidator();var $r=Ae({Name:Oe().trim().required(Zr.getValidationMessage(Zr.Required)).max(Xr.Name,Zr.getValidationMessage(Zr.MaxStringLength,Xr.Name)).test("NotAllowPotentialXSSCharacters","Field must not contain any of the following characters: ''<\">*%&:?'",(function(e){return!new RegExp(/[\<\>\*\%\&\:\\\?\'\"]/).test(e)})),FirstName:Oe().trim().max(Xr.FirstName,Zr.getValidationMessage(Zr.MaxStringLength,Xr.FirstName)).nullable(),LastName:Oe().trim().required(Zr.getValidationMessage(Zr.Required)).max(Xr.LastName,Zr.getValidationMessage(Zr.MaxStringLength,Xr.LastName)),Line1:Oe().trim().required(Zr.getValidationMessage(Zr.Required)).max(Xr.Line1,Zr.getValidationMessage(Zr.MaxStringLength,Xr.Line1)),Line2:Oe().trim().max(Xr.Line2,Zr.getValidationMessage(Zr.MaxStringLength,Xr.Line2)).nullable(),City:Oe().trim().required(Zr.getValidationMessage(Zr.Required)).max(Xr.City,Zr.getValidationMessage(Zr.MaxStringLength,Xr.City)),PostalCode:Oe().trim().max(Xr.PostalCode,Zr.getValidationMessage(Zr.MaxStringLength,Xr.PostalCode)).nullable(),CountryCode:Oe().trim().required(Zr.getValidationMessage(Zr.Required)),RegionCode:Oe().trim().max(Xr.RegionCode,Zr.getValidationMessage(Zr.MaxStringLength,Xr.RegionCode)).nullable(),DaytimePhoneNumber:Oe().trim().max(Xr.DaytimePhoneNumber,Zr.getValidationMessage(Zr.MaxStringLength,Xr.DaytimePhoneNumber)).nullable(),Email:Oe().trim().max(Xr.Email,Zr.getValidationMessage(Zr.MaxStringLength,Xr.Email)).email(Zr.getValidationMessage(Zr.IsEmail)).nullable()}),en=function(e){function r(t){var r=e.call(this,t)||this;return r.state={errors:{},countryOptions:[]},r.setCurrentAddress=function(e){r.props.dispatch(fr.ContactActions.setCurrentAddress(e)),r.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!0))},r.handleCountryChanged=function(e){var t=Bt({},r.props.address),n=r.props.availableCountries.find((function(t){return t.Code===e}));if(t.DaytimePhoneNumber=n.CallingCode+" ",t.CountryCode=e,t.CountryName=n.Name,r.setCurrentAddress(t),"USA"===e&&t.PostalCode){var s=be(t.PostalCode);s&&(t.RegionCode=Ie(s.state))}r.setCurrentAddress(t)},r.handleFormChanges=function(e){return Wt(r,void 0,void 0,(function(){var t,r,n;return qt(this,(function(s){return t=e.target.name,r=Object.assign({},this.props.address),n="checkbox"===e.target.type?e.target.checked:e.target.value,r[t]=n,this.setCurrentAddress(r),[2]}))}))},r.validateForm=function(){try{return $r.validateSync(r.props.address,{abortEarly:!1})}catch(t){var e={};return t.inner.map((function(t){e[t.path]=t.message})),r.setState({errors:e}),null}},r.state.countryOptions=r.props.availableCountries.map((function(e){return{label:e.Name,value:e.Code}})),r.props.mode===Jt.Add&&(r.props.address.FirstName=r.props.currentAddress.FirstName,r.props.address.LastName=r.props.currentAddress.LastName),r.props.validator.validate=r.validateForm,r}return Vt(r,e),r.prototype.render=function(){var e=this;return t(l,{container:!0,spacing:16},t(l,{item:!0,sm:12},t(h,{fullWidth:!0,variant:"outlined",name:"Name",label:"Address Name",value:this.props.address.Name||"",onChange:this.handleFormChanges,required:!0,error:!!this.state.errors.Name,helperText:this.state.errors.Name})),t(l,{item:!0,sm:12,md:6},t(h,{fullWidth:!0,variant:"outlined",name:"FirstName",label:"First Name",value:this.props.address.FirstName||"",onChange:this.handleFormChanges,error:!!this.state.errors.FirstName,helperText:this.state.errors.FirstName})),t(l,{item:!0,sm:12,md:6},t(h,{fullWidth:!0,variant:"outlined",name:"LastName",label:"Last Name",value:this.props.address.LastName||"",onChange:this.handleFormChanges,required:!0,error:!!this.state.errors.LastName,helperText:this.state.errors.LastName})),t(l,{item:!0,sm:12},t(h,{fullWidth:!0,variant:"outlined",name:"Line1",label:"Address Line 1",value:this.props.address.Line1||"",onChange:this.handleFormChanges,required:!0,error:!!this.state.errors.Line1,helperText:this.state.errors.Line1})),t(l,{item:!0,sm:12},t(h,{fullWidth:!0,variant:"outlined",name:"Line2",label:"Address Line 2",value:this.props.address.Line2||"",onChange:this.handleFormChanges,error:!!this.state.errors.Line2,helperText:this.state.errors.Line2})),t(l,{item:!0,sm:12,md:6},t(h,{fullWidth:!0,variant:"outlined",name:"City",label:"City",value:this.props.address.City||"",onChange:this.handleFormChanges,required:!0,error:!!this.state.errors.City,helperText:this.state.errors.City})),t(l,{item:!0,sm:12,md:6},t(h,{fullWidth:!0,variant:"outlined",name:"PostalCode",label:"ZIP / PostalCode",value:this.props.address.PostalCode||"",onChange:this.handleFormChanges,error:!!this.state.errors.PostalCode,helperText:this.state.errors.PostalCode})),t(l,{item:!0,sm:12,md:6},t(Jr,{fullWidth:!0,required:!0,label:"Country",value:this.props.address.CountryCode||"",options:this.state.countryOptions,onChange:function(t){return e.handleCountryChanged(t)}}),t(m,{variant:"caption",color:"error"},this.state.errors.CountryCode)),t(l,{item:!0,sm:12,md:6},t(h,{fullWidth:!0,variant:"outlined",name:"RegionCode",label:"State / Province / Region",value:this.props.address.RegionCode||"",onChange:this.handleFormChanges,error:!!this.state.errors.RegionCode,helperText:this.state.errors.RegionCode})),t(l,{item:!0,sm:12,md:6},t(h,{fullWidth:!0,variant:"outlined",name:"DaytimePhoneNumber",label:"Phone Number",value:this.props.address.DaytimePhoneNumber||"",onChange:this.handleFormChanges,error:!!this.state.errors.DaytimePhoneNumber,helperText:this.state.errors.DaytimePhoneNumber})),t(l,{item:!0,sm:12,md:6},t(h,{fullWidth:!0,variant:"outlined",name:"Email",label:"E-mail",value:this.props.address.Email||"",onChange:this.handleFormChanges,error:!!this.state.errors.Email,helperText:this.state.errors.Email})))},r}(n),tn=function(e){function t(){var t=e.call(this)||this;return t.get=function(e){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return t=this.baseApiUrl+"/customers/"+e,[4,Se.get(t)];case 1:return[2,r.sent().data]}}))}))},t.list=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=this.baseApiUrl+"/customers",r={filter:e},[4,Se.get(t,{params:r})];case 1:return[2,n.sent().data]}}))}))},t.getCustomerGroups=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=this.baseApiUrl+"/customergroups",[4,Se.get(e)];case 1:return[2,t.sent().data]}}))}))},t.updatePersonalInformation=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=this.baseApiUrl+"/customers/"+e.Id,r=new Kr(e),[4,Se.put(t,r)];case 1:return[2,n.sent().data]}}))}))},t.createContact=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return t=this.baseApiUrl+"/customers",r=new Qr(e),[4,Se.post(t,r)];case 1:return[2,n.sent().data]}}))}))},t.addContactAddress=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n;return qt(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=[Bt({},r)],[4,$r.validate(r)];case 1:return r=Bt.apply(void 0,t.concat([s.sent()])),[3,3];case 2:throw s.sent(),new Error("The address is invalid!");case 3:return n=this.baseApiUrl+"/customers/"+e+"/addresses",[4,Se.post(n,r)];case 4:return[2,s.sent()]}}))}))},t.updateContactAddress=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t,s;return qt(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=[Bt({},n)],[4,$r.validate(n)];case 1:return n=Bt.apply(void 0,t.concat([i.sent()])),[3,3];case 2:throw i.sent(),new Error("The address is invalid!");case 3:return s=this.baseApiUrl+"/customers/"+e+"/addresses/"+encodeURIComponent(r),[4,Se.put(s,n)];case 4:return[2,i.sent()]}}))}))},t.deleteContactAddress=function(e,r){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(n){switch(n.label){case 0:return t=this.baseApiUrl+"/customers/"+e+"/addresses/"+encodeURIComponent(r),[4,Se.delete(t)];case 1:return[2,n.sent()]}}))}))},t}return Vt(t,e),t}(Hr),rn=function(e){function t(){var t=e.call(this)||this;return t.getMarkets=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=this.baseApiUrl+"/markets",[4,Se.get(e)];case 1:return[2,t.sent().data]}}))}))},t}return Vt(t,e),t}(Hr),nn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.updateOrderGroupMetaFields=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(s){switch(s.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(r)+"/"+e+"/metaFields",[4,Se.patch(t,n)];case 1:return[2,s.sent().data]}}))}))},t.updateOrderShipmentMetaFields=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(r)+"/"+e+"/shipments/"+n+"/metaFields",[4,Se.patch(t,s)];case 1:return[2,i.sent().data]}}))}))},t.updateOrderLineItemMetaFields=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/"+this.getOrderGroupRouting(r)+"/"+e+"/lineitems/"+n+"/metaFields",[4,Se.patch(t,s)];case 1:return[2,i.sent().data]}}))}))},t}return Vt(t,e),t}(Hr),sn=function(e){function t(){var t=e.call(this)||this;return t.getPaymentMethods=function(e){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return t=this.baseApiUrl+"/paymentmethods/"+(e||""),[4,Se.get(t)];case 1:return[2,r.sent().data]}}))}))},t}return Vt(t,e),t}(Hr),on=function(e){function t(){var t=e.call(this)||this;return t.getShippingMethods=function(e,r){return Wt(t,void 0,void 0,(function(){var t,n;return qt(this,(function(s){switch(s.label){case 0:return t={marketId:e,countryCode:r},n=this.baseApiUrl+"/shippingMethods",[4,Se.get(n,{params:t})];case 1:return[2,s.sent().data]}}))}))},t.getShipmentStatuses=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=this.baseApiUrl+"/shipmentstatuses/",[4,Se.get(e)];case 1:return[2,t.sent().data]}}))}))},t.updateShipmentStatus=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){return t=""+this.baseApiUrl+Er+"/"+e+"/forms/"+r+"/shipments/"+n+"/shipmentstatus/"+s,[2,Se.patch(t)]}))}))},t.addToPickList=function(e,r,n){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(s){return t=""+this.baseApiUrl+Er+"/"+e+"/forms/"+r+"/shipments/"+n+"/addToPickList",[2,Se.post(t)]}))}))},t.updateShipmentTrackingNumber=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){return t=""+this.baseApiUrl+Er+"/"+e+"/forms/"+r+"/shipments/"+n+"/trackingNumber",[2,Se.patch(t,null,{params:{trackingNumber:s}})]}))}))},t}return Vt(t,e),t}(Hr),an=function(e){function t(){var t=e.call(this)||this;return t.search=function(e){return Wt(t,void 0,void 0,(function(){var t,r,n,s,i,o;return qt(this,(function(a){switch(a.label){case 0:return t=gr.getState().orderGroup.currentOrderGroup,r=t.MarketId,n=t.Customer.Id,s=t.Total.Currency,i=this.baseApiUrl+"/entries",o={keyword:e,marketId:r,customerId:n,currencyCode:s},[4,Se.get(i,{params:o})];case 1:return[2,a.sent().data]}}))}))},t.getEntryDetail=function(e){return Wt(t,void 0,void 0,(function(){var t,r,n;return qt(this,(function(s){switch(s.label){case 0:return t=gr.getState().orderGroup.currentOrderGroup,r=this.baseApiUrl+"/entries/"+e,n={marketId:t.MarketId,currencyCode:t.Total.Currency,customerId:t.Customer.Id},[4,Se.get(r,{params:n})];case 1:return[2,s.sent().data]}}))}))},t}return Vt(t,e),t}(Hr),un=function(e){function t(){var t=e.call(this)||this;return t.getCurrencies=function(e){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return t=this.baseApiUrl+"/currencies/"+e,[4,Se.get(t)];case 1:return[2,r.sent().data]}}))}))},t}return Vt(t,e),t}(Hr),dn=[];Object.keys(Me).forEach((function(e){var t=Me[e.toString()];dn.push({countryCode:e,name:t.name,phoneCode:t.phone})}));var cn=function(e){function t(){var t=e.call(this)||this;return t.getCountries=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=this.baseApiUrl+"/countries",[4,Se.get(e)];case 1:return[2,t.sent().data.map((function(e){return function(e){var t=dn.find((function(t){return t.name===e.Name}));return t?Bt(Bt({},e),{CallingCode:t.phoneCode?"+"+t.phoneCode:"",FlagSvgImage:require("flag-icon-css/flags/4x3/"+t.countryCode.toLowerCase()+".svg")}):e}(e)}))]}}))}))},t}return Vt(t,e),t}(Hr),pn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getOrdersByCustomerId=function(e,r,n,s){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(i){switch(i.label){case 0:return t=this.baseApiUrl+"/orderhistory?customerId="+e+"&startingIndex="+r+"&numberOfRecords="+n+"&returnTotalCount="+s,[4,Se.get(t)];case 1:return[2,i.sent().data]}}))}))},t}return Vt(t,e),t}(Hr),ln={Cart:new jr,OrderGroup:new qr,PaymentPlan:new Yr,Contact:new tn,MetaField:new nn,PaymentMethod:new sn,Shipment:new on,Catalog:new an,Market:new rn,Currency:new un,Geographics:new cn,OrderHistory:new pn},hn=function(e){var r=e.classes;return e.text?t("div",{className:r.optionalTypography},e.icon,t(We,{gutterBottom:!0},e.text)):null},mn={marginDefault:20,paddingDefault:20,addressBoxMinWidth:325,addressBoxMinHeight:256},fn={light:"#f8f8f8",hoveredList:"#ededed"},gn={paddingTop:4,paddingBottom:4},yn=z((function(e){e.palette;var t=e.spacing;e.breakpoints;return c({root:{minWidth:mn.addressBoxMinWidth,height:"100%"},header:{borderBottom:"solid 1px",borderBottomColor:fn.hoveredList},content:{padding:mn.paddingDefault},address:{marginTop:t.unit,marginBottom:2*t.unit},optionalTypography:{display:"flex"},optionalTypographyIcon:{marginRight:t.unit}})}))(u((function(e,t){return{address:t.address,classes:t.classes,isReadonly:t.isReadonly}}))((function(e){var r,n=e.classes,s=(r=e.address).IsPreferredBillingAddress&&r.IsPreferredShippingAddress?"Preferred Shipping & Billing Address":r.IsPreferredShippingAddress?"Preferred Shipping Address":r.IsPreferredBillingAddress?"Preferred Billing Address":void 0,i="";e.address.City&&(i+=e.address.City),e.address.RegionCode&&(i+=", "+e.address.RegionCode),e.address.PostalCode&&(i+=", "+e.address.PostalCode);return t(Ue,{className:n.root},t(Be,{className:n.header,title:s,titleTypographyProps:{variant:"body2"},action:!e.isReadonly&&t("div",null,t(ie,{"area-label":"Edit",onClick:function(){return function(t){e.dispatch(fr.ContactActions.setCurrentAddress(t)),e.dispatch(fr.AddressFormActions.initializeAddressForm(t)),e.dispatch(fr.ContactActions.setAddressDetailsViewMode(Jt.Edit))}(e.address)}},t(oe,null)),t(ie,{"aria-label":"Delete",onClick:function(){return function(t){e.dispatch(fr.ContactActions.setCurrentAddress(t)),e.dispatch(fr.ApplicationActions.setCurrentDialog(zt.DeleteAddress))}(e.address)}},t(ae,null)))}),t(He,{className:n.content},t(We,{variant:"body2",gutterBottom:!0},e.address.Name),t($,{container:!0,spacing:8},t($,{item:!0},t(hn,{text:e.address.FirstName,classes:n})),t($,{item:!0},t(hn,{text:e.address.LastName,classes:n}))),t("div",{className:n.address},t(We,{gutterBottom:!0},e.address.Line1),t(We,{gutterBottom:!0},e.address.Line2),t(hn,{text:i,classes:n}),t(We,{gutterBottom:!0},e.address.CountryName)),t(hn,{text:e.address.DaytimePhoneNumber,classes:n,icon:t(je,{fontSize:"small",className:n.optionalTypographyIcon})}),t(hn,{text:e.address.Email,classes:n,icon:t(qe,{fontSize:"small",className:n.optionalTypographyIcon})})))}))),vn=z((function(e){e.palette,e.spacing,e.breakpoints;return c({root:{height:"100%",minWidth:mn.addressBoxMinWidth},actionArea:{height:"100%"}})}))(u((function(e,t){return{classes:t.classes,customer:e.orderGroup.currentOrderGroup?e.orderGroup.currentOrderGroup.Customer:void 0}}))((function(e){var r=e.classes;return t(Ue,{className:r.root},t(ze,{className:r.actionArea,onClick:function(){var t,r={};e.customer&&(r.FirstName=e.customer.FirstName,r.LastName=e.customer.LastName),t=r,e.dispatch(fr.ContactActions.setCurrentAddress(t)),e.dispatch(fr.ContactActions.setAddressDetailsViewMode(Jt.Add))}},t($,{container:!0,direction:"column",alignItems:"center"},t($,{item:!0},t(Ye,{fontSize:"large"})),t($,{item:!0},t(We,{variant:"button"},"New Address")))))}))),Cn=function(e){return t(f,{open:e.open,onClose:e.onClose,style:{zIndex:1e4,margin:"0 auto"},maxWidth:e.large?"md":"sm",fullWidth:!0},t(g,null,e.title),t(y,{style:{paddingTop:"5px"}},e.children),t(v,null,t(se,{onClick:e.onClose},e.closeLabel),e.onOK&&t(se,{onClick:e.onOK},e.okLabel)))};Cn.defaultProps={okLabel:"OK",closeLabel:"Close"};var Sn=function(e){return t(Cn,{open:!0,title:e.title,onClose:e.onClose,closeLabel:e.closeButtonLabel,okLabel:e.confirmButtonLabel,onOK:e.onConfirm},e.children)},In=function(e){e.palette,e.spacing,e.breakpoints;return c({root:{},item:{minHeight:256}})},bn=z(In)((function(e){if(!e.address)return t(r,null);var n=e.address.DisplayName;return n||(n=e.address?[e.address.Line1,e.address.Line2,e.address.City,e.address.RegionCode,e.address.PostalCode,e.address.CountryName,e.address.CountryCode].filter((function(e){return e})).join(", "):""),t("div",null,t(We,{variant:"body2"},n))})),An=u((function(e,t){return{address:e.contact.currentAddress,contact:e.contact.currentContact}}))((function(e){var r=function(){e.dispatch(fr.ContactActions.setCurrentAddress(null)),e.dispatch(fr.ApplicationActions.setCurrentDialog(zt.None))};return null==e.address?null:t(Sn,{title:"Delete address?",closeButtonLabel:"Cancel",confirmButtonLabel:"Delete",onConfirm:function(){return Wt(void 0,void 0,void 0,(function(){var t,n;return qt(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,ln.Contact.deleteContactAddress(e.contact.Id,e.address.AddressId)];case 1:return s.sent(),[4,ln.Contact.get(e.contact.Id)];case 2:return t=s.sent(),e.dispatch(fr.ContactActions.setCurrentContact(t)),[3,4];case 3:return n=s.sent(),e.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,4];case 4:return r(),[2]}}))}))},onClose:r},t(bn,{address:e.address}))})),On=z((function(e){e.palette,e.spacing,e.breakpoints;return c({root:{},container:{display:"flex",flexWrap:"wrap"}})}))(u((function(e,t){return{mode:e.contact.addressDetailsViewMode,address:t.address,classes:t.classes,country:e.geographics.countries.find((function(t){return t.Code===e.contact.currentAddress.CountryCode})),availableCountries:e.geographics.countries,currentAddress:e.contact.currentAddress,validator:t.validator}}))(en)),wn=function(e){function r(t){var r=e.call(this,t)||this;return r.state={loaded:!1},r.validator={validate:function(){return null}},r.closeView=function(){r.props.dispatch(fr.ContactActions.setAddressDetailsViewMode(Jt.Hide)),r.props.dispatch(fr.AddressFormActions.clearAddressForm()),r.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!1))},r.setCurrentAddress=function(e){r.props.dispatch(fr.ContactActions.setCurrentAddress(e)),r.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!0))},r.handleFormChanges=function(e){var t=Object.assign({},r.props.address),n="checkbox"===e.target.type?e.target.checked:e.target.value;t[e.target.name]=n,r.setCurrentAddress(t)},r.saveChanges=function(){return Wt(r,void 0,void 0,(function(){var e,t,r,n,s;return qt(this,(function(i){switch(i.label){case 0:if(null==(e=this.validator.validate()))return[2];t=Bt(Bt({},this.props.address),e),i.label=1;case 1:return i.trys.push([1,9,,10]),this.props.mode!==Jt.Add?[3,3]:[4,ln.Contact.addContactAddress(this.props.currentContactId,t)];case 2:return i.sent(),[3,5];case 3:return[4,ln.Contact.updateContactAddress(this.props.currentContactId,t.AddressId.trim(),t)];case 4:i.sent(),i.label=5;case 5:return(r=this.props.orderGroup.currentOrderGroup)?[4,this.updateOrderGroup(r)]:[3,7];case 6:i.sent(),i.label=7;case 7:return[4,ln.Contact.get(this.props.currentContactId)];case 8:return n=i.sent(),this.props.dispatch(fr.ContactActions.setCurrentContact(n)),this.closeView(),[3,10];case 9:return s=i.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,10];case 10:return[2]}}))}))},r}return Vt(r,e),r.prototype.componentDidMount=function(){this.setState({loaded:!0})},r.prototype.updateOrderGroup=function(e){return Wt(this,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return e.IsDraft?[3,2]:[4,ln.OrderGroup.getSingleOrderGroup(e.Type,e.OrderGroupId)];case 1:return t=n.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(t)),[3,4];case 2:return[4,ln.OrderGroup.calculateOrder(e)];case 3:r=n.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(r)),n.label=4;case 4:return[2]}}))}))},r.prototype.render=function(){return t(Cn,{open:!0,title:this.props.mode===Jt.Edit?"Edit Address":"Add New Address",okLabel:"Save",onOK:this.saveChanges,closeLabel:"Cancel",onClose:this.closeView},this.state.loaded&&t(l,{container:!0,spacing:16},t(l,{item:!0,sm:12},t(On,{address:this.props.address,validator:this.validator})),t(l,{item:!0,sm:12},t(C,{control:t(ue,{name:"IsPreferredShippingAddress",checked:this.props.address.IsPreferredShippingAddress,onChange:this.handleFormChanges}),label:"Preferred Shipping Address"})),t(l,{item:!0,sm:12},t(C,{control:t(ue,{name:"IsPreferredBillingAddress",checked:this.props.address.IsPreferredBillingAddress,onChange:this.handleFormChanges}),label:"Preferred Billing Address"}))))},r}(n),Tn=z((function(e){e.spacing;return c({actions:{marginTop:15}})}))(u((function(e,t){return{mode:e.contact.addressDetailsViewMode,address:e.contact.currentAddress,classes:t.classes,currentContactId:e.contact.currentContact.Id,orderGroup:e.orderGroup}}))(wn)),Dn=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.initData()];case 1:return e.sent(),[2]}}))}))},r.prototype.shouldComponentUpdate=function(e,t){var r=this;return e.contactId!==this.props.contactId&&setTimeout((function(){r.initData()}),200),!0},r.prototype.initData=function(){return Wt(this,void 0,void 0,(function(){var e,t,r,n,s,i,o;return qt(this,(function(a){switch(a.label){case 0:this.props.dispatch(fr.ContactActions.setAddressDetailsViewMode(Jt.Hide)),this.props.dispatch(fr.AddressFormActions.clearAddressForm()),this.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!1)),a.label=1;case 1:return a.trys.push([1,7,,8]),e=new URLSearchParams(this.props.location.search),t=parseInt(e.get("orderId"),10),r=e.get("orderType"),this.props.orderGroup||NaN===t||!r?[3,3]:[4,ln.OrderGroup.getSingleOrderGroup(r,t)];case 2:n=a.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(n)),a.label=3;case 3:return[4,ln.Contact.get(this.props.contactId)];case 4:return s=a.sent(),this.props.dispatch(fr.ContactActions.setCurrentContact(s)),0!==this.props.availableCountries.length?[3,6]:[4,(new cn).getCountries()];case 5:i=a.sent(),this.props.dispatch(fr.GeographicsActions.setCountries(i)),a.label=6;case 6:return[3,8];case 7:return o=a.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(o.message)),[3,8];case 8:return[2]}}))}))},r.prototype.render=function(){var e=this,r=this.props.classes;return this.props.contact&&t("div",null,t($,{container:!0,spacing:24,className:r.root},this.props.contact.Addresses.map((function(n,s){return t($,{item:!0,key:s,className:r.item},t(yn,{address:n,isReadonly:e.props.isReadonly}))})),!this.props.isReadonly&&t($,{item:!0,className:r.item},t(vn,null))),this.props.addressDetailsViewMode!==Jt.Hide&&t(Tn,null),this.props.addressDeleteDialogIsVisible&&t(An,null))},r}(n),Pn=z(In)(u((function(e,t){return Bt({contact:e.contact.currentContact,addressDeleteDialogIsVisible:e.application.currentDialog===zt.DeleteAddress,addressDetailsViewMode:e.contact.addressDetailsViewMode,orderGroup:e.orderGroup.currentOrderGroup,availableCountries:e.geographics.countries},t)}))(Dn)),Gn=function(e){return t(Qe,Bt({direction:"left"},e))},Nn=z((function(e){var t=e.palette,r=(e.spacing,e.breakpoints,e.zIndex);return c({root:{},content:{marginTop:20},title:{flexGrow:1},appBar:{position:"relative",zIndex:r.drawer+1},appBarIcon:{color:t.common.white}})}))(u((function(e,t){return{title:t.title,children:t.children,showDialogActions:t.showDialogActions,classes:t.classes,closeView:t.closeView,menuAction:t.menuAction}}))((function(e){var r=e.classes,n=e.children;return t(te,{className:r.root,open:!0,fullScreen:!0,onClose:e.closeView,TransitionComponent:Gn},t(Xe,{className:r.appBar},t(Je,null,t(ie,{onClick:e.closeView,"aria-label":"Close"},t(de,{className:r.appBarIcon})),t(We,{variant:"h6",color:"inherit",className:r.title},e.title),e.menuAction&&t(Ke,{smUp:!0,implementation:"js"},t(ie,{onClick:e.menuAction},t(Ze,{className:r.appBarIcon}))))),t(ne,{className:r.content},n),e.showDialogActions&&t(re,null,t(se,{unelevated:!0,onClick:e.closeView},"Close")))}))),Rn=u((function(e,t){return{discardChanges:t.discardChanges}}))((function(e){return t(Sn,{title:"Leave page?",closeButtonLabel:"Cancel",confirmButtonLabel:"Leave",onConfirm:function(){e.discardChanges(),e.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!1))},onClose:function(){e.dispatch(fr.ApplicationActions.setCurrentDialog(zt.None)),e.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!0))}},t(We,{variant:"body1"},"You have unsaved changes. Do you want to leave the page without saving?"))}));function En(){return(En=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function xn(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}function Ln(e){return"/"===e.charAt(0)}function Mn(e,t){for(var r=t,n=r+1,s=e.length;n<s;r+=1,n+=1)e[r]=e[n];e.pop()}var Fn=function(e,t){void 0===t&&(t="");var r,n=e&&e.split("/")||[],s=t&&t.split("/")||[],i=e&&Ln(e),o=t&&Ln(t),a=i||o;if(e&&Ln(e)?s=n:n.length&&(s.pop(),s=s.concat(n)),!s.length)return"/";if(s.length){var u=s[s.length-1];r="."===u||".."===u||""===u}else r=!1;for(var d=0,c=s.length;0<=c;c--){var p=s[c];"."===p?Mn(s,c):".."===p?(Mn(s,c),d++):d&&(Mn(s,c),d--)}if(!a)for(;d--;d)s.unshift("..");!a||""===s[0]||s[0]&&Ln(s[0])||s.unshift("");var l=s.join("/");return r&&"/"!==l.substr(-1)&&(l+="/"),l};function kn(e){return"/"===e.charAt(0)}function _n(e,t){for(var r=t,n=r+1,s=e.length;n<s;r+=1,n+=1)e[r]=e[n];e.pop()}var Vn=function(e,t){void 0===t&&(t="");var r,n=e&&e.split("/")||[],s=t&&t.split("/")||[],i=e&&kn(e),o=t&&kn(t),a=i||o;if(e&&kn(e)?s=n:n.length&&(s.pop(),s=s.concat(n)),!s.length)return"/";if(s.length){var u=s[s.length-1];r="."===u||".."===u||""===u}else r=!1;for(var d=0,c=s.length;c>=0;c--){var p=s[c];"."===p?_n(s,c):".."===p?(_n(s,c),d++):d&&(_n(s,c),d--)}if(!a)for(;d--;d)s.unshift("..");!a||""===s[0]||s[0]&&kn(s[0])||s.unshift("");var l=s.join("/");return r&&"/"!==l.substr(-1)&&(l+="/"),l},Un=xn((function(e){"production"===process.env.NODE_ENV?e.exports=Fn:e.exports=Vn}));function Bn(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}var Hn=function e(t,r){if(t===r)return!0;if(null==t||null==r)return!1;if(Array.isArray(t))return Array.isArray(r)&&t.length===r.length&&t.every((function(t,n){return e(t,r[n])}));if("object"!=typeof t&&"object"!=typeof r)return!1;var n=Bn(t),s=Bn(r);return n!==t||s!==r?e(n,s):Object.keys(Object.assign({},t,r)).every((function(n){return e(t[n],r[n])}))};function Wn(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}var qn=function e(t,r){if(t===r)return!0;if(null==t||null==r)return!1;if(Array.isArray(t))return Array.isArray(r)&&t.length===r.length&&t.every((function(t,n){return e(t,r[n])}));if("object"==typeof t||"object"==typeof r){var n=Wn(t),s=Wn(r);return n!==t||s!==r?e(n,s):Object.keys(Object.assign({},t,r)).every((function(n){return e(t[n],r[n])}))}return!1},jn=(xn((function(e){"production"===process.env.NODE_ENV?e.exports=Hn:e.exports=qn})),"production"===process.env.NODE_ENV);function Yn(e,t){if(!jn){if(e)return;var r="Warning: "+t;"undefined"!=typeof console&&console.warn(r);try{throw Error(r)}catch(e){}}}var zn="production"===process.env.NODE_ENV;function Qn(e,t){if(!e){if(zn)throw new Error("Invariant failed");throw new Error("Invariant failed: "+(t||""))}}function Kn(e){return"/"===e.charAt(0)?e:"/"+e}function Xn(e){return"/"===e.charAt(0)?e.substr(1):e}function Jn(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}function Zn(e){var t=e.pathname,r=e.search,n=e.hash,s=t||"/";return r&&"?"!==r&&(s+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(s+="#"===n.charAt(0)?n:"#"+n),s}function $n(e,t,r,n){var s;"string"==typeof e?(s=function(e){var t=e||"/",r="",n="",s=t.indexOf("#");-1!==s&&(n=t.substr(s),t=t.substr(0,s));var i=t.indexOf("?");return-1!==i&&(r=t.substr(i),t=t.substr(0,i)),{pathname:t,search:"?"===r?"":r,hash:"#"===n?"":n}}(e)).state=t:(void 0===(s=En({},e)).pathname&&(s.pathname=""),s.search?"?"!==s.search.charAt(0)&&(s.search="?"+s.search):s.search="",s.hash?"#"!==s.hash.charAt(0)&&(s.hash="#"+s.hash):s.hash="",void 0!==t&&void 0===s.state&&(s.state=t));try{s.pathname=decodeURI(s.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+s.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return r&&(s.key=r),n?s.pathname?"/"!==s.pathname.charAt(0)&&(s.pathname=Un(s.pathname,n.pathname)):s.pathname=n.pathname:s.pathname||(s.pathname="/"),s}var es=!("undefined"==typeof window||!window.document||!window.document.createElement);function ts(e,t){t(window.confirm(e))}var rs={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+Xn(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:Xn,decodePath:Kn},slash:{encodePath:Kn,decodePath:Kn}};function ns(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function ss(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function is(e){window.location.replace(ns(window.location.href)+"#"+e)}var os,as=function(e){void 0===e&&(e={}),es||("production"!==process.env.NODE_ENV?Qn(!1,"Hash history needs a DOM"):Qn(!1));var t=window.history,r=-1===window.navigator.userAgent.indexOf("Firefox"),n=e,s=n.getUserConfirmation,i=void 0===s?ts:s,o=n.hashType,a=void 0===o?"slash":o,u=e.basename?function(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}(Kn(e.basename)):"",d=rs[a],c=d.encodePath,p=d.decodePath;function l(){var e=p(ss());return"production"!==process.env.NODE_ENV&&Yn(!u||Jn(e,u),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+e+'" to begin with "'+u+'".'),u&&(e=function(e,t){return Jn(e,t)?e.substr(t.length):e}(e,u)),$n(e)}var h,m,f=(h=null,m=[],{setPrompt:function(e){return"production"!==process.env.NODE_ENV&&Yn(null==h,"A history supports only one prompt at a time"),h=e,function(){h===e&&(h=null)}},confirmTransitionTo:function(e,t,r,n){if(null!=h){var s="function"==typeof h?h(e,t):h;"string"==typeof s?"function"==typeof r?r(s,n):("production"!==process.env.NODE_ENV&&Yn(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),n(!0)):n(!1!==s)}else n(!0)},appendListener:function(e){var t=!0;function r(){t&&e.apply(void 0,arguments)}return m.push(r),function(){t=!1,m=m.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];m.forEach((function(e){return e.apply(void 0,t)}))}});function g(e){En(P,e),P.length=t.length,f.notifyListeners(P.location,P.action)}var y=!1,v=null;function C(){var e,t,r=ss(),n=c(r);if(r!==n)is(n);else{var s=l(),o=P.location;if(!y&&(t=s,(e=o).pathname===t.pathname&&e.search===t.search&&e.hash===t.hash))return;if(v===Zn(s))return;v=null,function(e){if(y)y=!1,g();else{var t="POP";f.confirmTransitionTo(e,t,i,(function(r){r?g({action:t,location:e}):function(e){var t=P.location,r=A.lastIndexOf(Zn(t));-1===r&&(r=0);var n=A.lastIndexOf(Zn(e));-1===n&&(n=0);var s=r-n;s&&(y=!0,O(s))}(e)}))}}(s)}}var S=ss(),I=c(S);S!==I&&is(I);var b=l(),A=[Zn(b)];function O(e){"production"!==process.env.NODE_ENV&&Yn(r,"Hash history go(n) causes a full page reload in this browser"),t.go(e)}var w=0;function T(e){1===(w+=e)&&1===e?window.addEventListener("hashchange",C):0===w&&window.removeEventListener("hashchange",C)}var D=!1,P={length:t.length,action:"POP",location:b,createHref:function(e){var t=document.querySelector("base"),r="";return t&&t.getAttribute("href")&&(r=ns(window.location.href)),r+"#"+c(u+Zn(e))},push:function(e,t){"production"!==process.env.NODE_ENV&&Yn(void 0===t,"Hash history cannot push state; it is ignored");var r="PUSH",n=$n(e,void 0,void 0,P.location);f.confirmTransitionTo(n,r,i,(function(e){if(e){var t=Zn(n),s=c(u+t);if(ss()!==s){v=t,function(e){window.location.hash=e}(s);var i=A.lastIndexOf(Zn(P.location)),o=A.slice(0,i+1);o.push(t),A=o,g({action:r,location:n})}else"production"!==process.env.NODE_ENV&&Yn(!1,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack"),g()}}))},replace:function(e,t){"production"!==process.env.NODE_ENV&&Yn(void 0===t,"Hash history cannot replace state; it is ignored");var r="REPLACE",n=$n(e,void 0,void 0,P.location);f.confirmTransitionTo(n,r,i,(function(e){if(e){var t=Zn(n),s=c(u+t);ss()!==s&&(v=t,is(s));var i=A.indexOf(Zn(P.location));-1!==i&&(A[i]=t),g({action:r,location:n})}}))},go:O,goBack:function(){O(-1)},goForward:function(){O(1)},block:function(e){void 0===e&&(e=!1);var t=f.setPrompt(e);return D||(T(1),D=!0),function(){return D&&(D=!1,T(-1)),t()}},listen:function(e){var t=f.appendListener(e);return T(1),function(){T(-1),t()}}};return P}(),us=function(e,t){var r=JSON.parse(sessionStorage.getItem("previousHistory")||"{}");t||(t=as.location.pathname+as.location.search),r[e]=t,sessionStorage.setItem("previousHistory",JSON.stringify(r))},ds=function(e){return JSON.parse(sessionStorage.getItem("previousHistory")||"{}")[e]},cs=function(){return""+as.location.pathname+as.location.search};as.listen((function(e,t){})),function(e){e[e.FullName=64]="FullName",e[e.FirstName=64]="FirstName",e[e.LastName=64]="LastName",e[e.MiddleName=64]="MiddleName",e[e.Email=254]="Email"}(os||(os={}));var ps=os,ls=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return[4,ln.Contact.getCustomerGroups()];case 1:return e=t.sent(),this.props.dispatch(fr.ContactActions.setCustomerGroups(e)),[2]}}))}))},r.prototype.render=function(){var e=this;return t(l,{container:!0,spacing:16},t(l,{item:!0,xs:12},t(l,{container:!0,alignItems:"center"},t(l,{item:!0,xs:12,sm:3},t(m,null,"Full Name *")),t(l,{item:!0,xs:12,sm:9},t(xe,{fullWidth:!0,name:"FullName",placeholder:"Contact's full name",value:this.props.contact.FullName||"",onChange:this.props.updateInputValue,validators:[Zr.Required,Zr.setMaxStringLength(ps.FullName)],errorMessages:[Zr.getValidationMessage(Zr.Required),Zr.getValidationMessage(Zr.MaxStringLength,ps.FullName)],withRequiredValidator:!0})))),t(l,{item:!0,xs:12},t(l,{container:!0,alignItems:"center"},t(l,{item:!0,xs:12,sm:3},t(m,null,"First Name *")),t(l,{item:!0,xs:12,sm:9},t(xe,{fullWidth:!0,name:"FirstName",placeholder:"Contact's first name",value:this.props.contact.FirstName||"",onChange:this.props.updateInputValue,validators:[Zr.Required,Zr.setMaxStringLength(ps.FirstName)],errorMessages:[Zr.getValidationMessage(Zr.Required),Zr.getValidationMessage(Zr.MaxStringLength,ps.FirstName)],withRequiredValidator:!0})))),t(l,{item:!0,xs:12},t(l,{container:!0,alignItems:"center"},t(l,{item:!0,xs:12,sm:3},t(m,null,"Middle Name")),t(l,{item:!0,xs:12,sm:9},t(xe,{fullWidth:!0,placeholder:"Contact's middle name",id:"middle-name",value:this.props.contact.MiddleName||"",name:"MiddleName",onChange:this.props.updateInputValue,validators:[Zr.setMaxStringLength(ps.MiddleName)],errorMessages:[Zr.getValidationMessage(Zr.MaxStringLength,ps.MiddleName)]})))),t(l,{item:!0,xs:12},t(l,{container:!0,alignItems:"center"},t(l,{item:!0,xs:12,sm:3},t(m,null,"Last Name *")),t(l,{item:!0,xs:12,sm:9},t(xe,{fullWidth:!0,name:"LastName",placeholder:"Contact's last name",value:this.props.contact.LastName||"",onChange:this.props.updateInputValue,validators:[Zr.Required,Zr.setMaxStringLength(ps.LastName)],errorMessages:[Zr.getValidationMessage(Zr.Required),Zr.getValidationMessage(Zr.MaxStringLength,ps.LastName)],withRequiredValidator:!0})))),t(l,{item:!0,xs:12},t(l,{container:!0,alignItems:"center"},t(l,{item:!0,xs:12,sm:3},t(m,null,"E-mail *")),t(l,{item:!0,xs:12,sm:9},t(xe,{fullWidth:!0,name:"Email",placeholder:"E-mail address",value:this.props.contact.Email||"",onChange:this.props.updateInputValue,validators:[Zr.Required,Zr.IsEmail,Zr.setMaxStringLength(ps.Email)],errorMessages:[Zr.getValidationMessage(Zr.Required),Zr.getValidationMessage(Zr.IsEmail),Zr.getValidationMessage(Zr.MaxStringLength,ps.Email)],withRequiredValidator:!0})))),t(l,{item:!0,xs:12},t(l,{container:!0,alignItems:"center"},t(l,{item:!0,xs:12,sm:3},t(m,null,"Customer Group")),t(l,{item:!0,xs:12,sm:9},t(S,{fullWidth:!0,displayEmpty:!0,id:"customerGroup",placeholder:"Customer group",value:this.props.contact.CustomerGroup||"",name:"CustomerGroup",onChange:this.props.updateInputValue},Object.keys(this.props.customerGroups).map((function(r,n){return t(I,{key:r,value:e.props.customerGroups[r].Id},e.props.customerGroups[r].Id)})),t(I,{value:""},"None"))))))},r}(n),hs=function(e){var t=e.palette;e.spacing,e.breakpoints;return c({root:{marginBottom:mn.marginDefault},header:Bt(Bt({},gn),{height:48,background:t.primary.main}),title:{color:t.common.white}})},ms=z(hs)(u((function(e,t){return{contact:t.contact,contactApi:new tn,customerGroups:e.contact.customerGroups,updateInputValue:t.updateInputValue,classes:t.classes}}))(ls)),fs=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.savePersonalInformation=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ln.Contact.updatePersonalInformation(this.props.contact)];case 1:return t.sent(),as.replace("./info"),[3,3];case 2:return e=t.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(e.message)),[3,3];case 3:return[2]}}))}))},t.updateInputValue=function(e){return Wt(t,void 0,void 0,(function(){var t;return qt(this,(function(r){return(t=Object.assign({},this.props.contact))[e.target.name]=String(e.target.value),this.props.dispatch(fr.ContactActions.setCurrentContact(t)),[2]}))}))},t}return Vt(r,e),r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.getData(this.props.contactId)];case 1:return e.sent(),[2]}}))}))},r.prototype.componentDidMount=function(){var e=!this.currentForm||this.currentForm.isFormValid(!1);this.props.dispatch(fr.ApplicationActions.setIsCurrentFormValid(e))},r.prototype.componentDidUpdate=function(e){this.currentForm&&this.currentForm.isFormValid()!==e.isCurrentFormValid&&this.props.dispatch(fr.ApplicationActions.setIsCurrentFormValid(this.currentForm.isFormValid()))},r.prototype.shouldComponentUpdate=function(e,t){return e.contactId!==this.props.contactId&&this.getData(e.contactId),!0},r.prototype.getData=function(e){return Wt(this,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return[4,ln.Contact.get(e)];case 1:return t=r.sent(),this.props.dispatch(fr.ContactActions.setCurrentContact(t)),[2]}}))}))},r.prototype.render=function(){var e=this;return t(b,{className:this.props.classes.root},t(A,{className:this.props.classes.header,title:"Edit Personal Information",titleTypographyProps:{className:this.props.classes.title,variant:"subheading"}}),t(O,null,t(Ee,{ref:function(t){return e.currentForm=t},onSubmit:this.savePersonalInformation},t(ms,{saveChanges:this.savePersonalInformation,contact:this.props.contact,updateInputValue:this.updateInputValue}),t(l,{item:!0,xs:12},t(l,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",spacing:24},t(l,{item:!0},t(Fe,{to:"./info",replace:!0,style:{textDecoration:"none"}},t(se,null,"Cancel"))),t(l,{item:!0},t(se,{onClick:this.savePersonalInformation,unelevated:!0,disabled:!this.props.isCurrentFormValid},"Save")))))))},r}(n),gs=z(hs)(u((function(e,t){return Bt({contact:e.contact.currentContact||{},currentCart:e.orderGroup.currentOrderGroup,listedCarts:e.orderGroup.listedOrderGroups,isCurrentFormValid:e.application.isCurrentFormValid},t)}))(fs)),ys=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.render=function(){return t(gs,Bt({},this.props))},r}(n),vs=[{id:"OrderNumber",numeric:!1,label:"No.",minWidth:"100px"},{id:"Created",numeric:!1,label:"Created Date",minWidth:"100px"},{id:"LineItems",numeric:!1,label:"Products",minWidth:"100px"},{id:"Total",numeric:!0,label:"Total Amount",minWidth:"100px"},{id:"OrderStatus",numeric:!1,label:"Order Status",minWidth:"100px"}],Cs=[10,20,50],Ss=function(e){function r(t){var r=e.call(this,t)||this;return r.query=new URLSearchParams(as.location.search),r.state={page:r.getPageParam(),rowsPerPage:r.getRowsPerPageParam(),totalRecords:0,orderList:[]},r.getData=function(){return Wt(r,void 0,void 0,(function(){var e,t,r,n=this;return qt(this,(function(s){switch(s.label){case 0:return e=0===this.state.totalRecords,t=this.state.page*this.state.rowsPerPage,[4,ln.OrderHistory.getOrdersByCustomerId(this.props.customerId,t,this.state.rowsPerPage,e)];case 1:return r=s.sent(),e&&r.TotalRecords<=this.state.page*this.state.rowsPerPage?(this.setState({page:0},(function(){return Wt(n,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return e.sent(),[2]}}))}))})),[2]):(as.replace({pathname:as.location.pathname,search:"?"+new URLSearchParams({page:(this.state.page+1).toString(),rowsPerPage:this.state.rowsPerPage.toString()}).toString()}),setTimeout((function(){n.setState({orderList:r.Results}),e&&n.setState({totalRecords:r.TotalRecords})}),200),[2])}}))}))},r.handleChangePage=function(e,t){null!==e&&r.setState({page:t},(function(){r.getData()}))},r.handleChangeRowsPerPage=function(e){null!==e&&r.setState({page:0,rowsPerPage:e.target.value},(function(){r.getData()}))},r.getItemDescriptions=function(e){var t="",r=1;if(e&&e.length>0){for(t=e[0].DisplayName;t.length<120&&r<e.length;)t+=", "+e[r].DisplayName,r++;if(r<e.length){var n=e.length-r;t+=" ... and "+n+" more "+(n>1?"products":"product")}}return t},r.state.page<0&&(r.state.page=0),r}return Vt(r,e),r.prototype.getPageParam=function(){var e=parseInt(this.query.get("page"),10)-1||0;return e<0&&(e=0),e},r.prototype.getRowsPerPageParam=function(){var e=parseInt(this.query.get("rowsPerPage"),10)||10;return Cs.indexOf(e)>=0?e:10},r.prototype.shouldComponentUpdate=function(e,t){var r=this;this.query=new URLSearchParams(as.location.search);var n=this.getPageParam(),s=this.getRowsPerPageParam();return this.state.page===n&&this.state.rowsPerPage===s||this.setState({page:n,rowsPerPage:s},(function(){return Wt(r,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return e.sent(),[2]}}))}))})),!0},r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return e.sent(),[2]}}))}))},r.prototype.render=function(){var e=this,r=this.props.classes;return t("div",{className:r.root},t(it,{className:r.paper},t("div",{className:r.tableWrapper},t($e,{className:r.table},t(rt,null,t(st,null,vs.map((function(e){return t(tt,{className:r.headerLable,key:e.id,align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",style:{minWidth:e.minWidth}},e.label)})))),t(et,null,this.state.orderList.map((function(n,s){return t(st,{hover:!0,key:s},t(tt,null,t(Fe,{className:r.link,to:Er+"/"+n.OrderGroupId},n.OrderNumber)),t(tt,null,ot(n.Created).format("LLL")),t(tt,null," ",e.getItemDescriptions(n.LineItems)),t(tt,{align:"right"},n.Total.Amount.toFixed(n.Total.Fractions)+" "+n.Total.Currency),t(tt,null,n.OrderStatus))}))))),t(nt,{rowsPerPageOptions:Cs,component:"div",count:this.state.totalRecords,rowsPerPage:this.state.rowsPerPage,page:this.state.page,backIconButtonProps:{"aria-label":"previous page"},nextIconButtonProps:{"aria-label":"next page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage})))},r}(n),Is=z((function(e){return Q({tableWrapper:{overflowX:"auto"},link:{textDecoration:"none",color:e.palette.primary.main+" !important"},headerLable:{fontWeight:"bold"}})}))(Ss);function bs(e){return t(Is,Bt({},e))}var As,Os=function(e){return t($,{item:!0,xs:12,style:{minHeight:50}},t($,{container:!0},t($,{item:!0,xs:12,sm:3},t(We,{variant:"body1"},e.label,":")),t($,{item:!0,xs:12,sm:9},t(We,{variant:"body1"},e.value))))},ws=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.classes=t.props.classes,t}return Vt(r,e),r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.getData(this.props.contactId)];case 1:return e.sent(),[2]}}))}))},r.prototype.shouldComponentUpdate=function(e,t){return e.contactId!==this.props.contactId&&this.getData(e.contactId),!0},r.prototype.getData=function(e){return Wt(this,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return[4,ln.Contact.get(e)];case 1:return t=r.sent(),this.props.dispatch(fr.ContactActions.setCurrentContact(t)),[2]}}))}))},r.prototype.openContactPersonalInformationEditView=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){try{this.props.dispatch(fr.ContactActions.showPersonalInformationEditView())}catch(e){this.props.dispatch(fr.ApplicationActions.showNotification(e.message))}return[2]}))}))},r.prototype.render=function(){return this.props.contact&&t(Ue,{className:this.classes.root},t(Be,{className:this.classes.header,action:!this.props.isReadonly&&t(Fe,{to:"./edit",className:this.classes.action,replace:!0},t(at,{title:"Edit the contact's personal information"},t(ie,null,t(oe,{className:this.classes.icon})))),title:"Personal Information",titleTypographyProps:{className:this.classes.title,variant:"subheading"}}),t(He,null,t($,{container:!0,direction:"column",spacing:8},t(Os,{label:"Full Name",value:this.props.contact.FullName}),t(Os,{label:"First Name",value:this.props.contact.FirstName}),t(Os,{label:"Middle Name",value:this.props.contact.MiddleName}),t(Os,{label:"Last Name",value:this.props.contact.LastName}),t(Os,{label:"E-mail",value:this.props.contact.Email}),t(Os,{label:"Customer Group",value:this.props.contact.CustomerGroup?this.props.contact.CustomerGroup:"None"}))))},r}(n),Ts=z((function(e){var t=e.palette;e.spacing,e.breakpoints;return c({root:{marginBottom:mn.marginDefault},header:Bt(Bt({},gn),{height:48,background:t.primary.main}),title:{color:t.common.white},action:{display:"block",marginTop:"8px"},icon:{fill:t.common.white}})}))(u((function(e,t){return{contactId:t.contactId,contact:e.contact.currentContact,isReadonly:t.isReadonly,classes:t.classes}}))(ws)),Ds=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.render=function(){return t(Ts,Bt({},this.props))},r}(n),Ps=function(e){function r(t){var r=e.call(this,t)||this;r.state={discardDialogOpen:!1},r.classes=r.props.classes,r.addressListLink="/customers/"+r.props.currentContactId+"/addresses",r.personalInfoLink="/customers/"+r.props.currentContactId+"/info",r.PeronalInfoEditLink="/customers/"+r.props.currentContactId+"/edit",r.addressSearchQuery="",r.customerInfoLink="/customers/"+r.props.currentContactId+"/info",r.customerAddressLink="/customers/"+r.props.currentContactId+"/addresses",r.customerOrderLink="/customers/"+r.props.currentContactId+"/orders",r.unListenHistory=as.listen((function(e,t){r.forceUpdate()}));var n=new URLSearchParams(r.props.location.search);return null!==n.get("orderType")&&null!==n.get("orderId")&&(r.addressSearchQuery="?orderType="+n.get("orderType")+"&orderId="+n.get("orderId")),r}return Vt(r,e),r.prototype.componentWillUnmount=function(){this.unListenHistory()},r.prototype.discardChanges=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:this.props.dispatch(fr.ApplicationActions.setCurrentDialog(zt.None)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ln.Contact.get(this.props.currentContactId)];case 2:return e=r.sent(),this.props.dispatch(fr.ContactActions.setCurrentContact(e)),this.props.dispatch(fr.AddressFormActions.clearAddressForm()),this.props.drawerNextMenu!==Zt.None?this.displayMainContent(this.props.drawerNextMenu):this.props.dispatch(fr.ContactActions.setDrawerSelectedMenu(Zt.None)),[3,4];case 3:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,4];case 4:return[2]}}))}))},r.prototype.displayMainContent=function(e){e===Zt.PersonalInformation?this.props.dispatch(fr.ContactActions.showContactProfile()):e===Zt.AddressBook&&this.props.dispatch(fr.ContactActions.showAddressBook())},r.prototype.closeProfileOverview=function(){this.leavePage()},r.prototype.leavePage=function(){this.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!1));var e=ds(Dr);void 0!==e?as.push(e):as.push("/")},r.prototype.getMenuListItem=function(){var e=this;return t(w,null,t(Fe,{to:this.personalInfoLink,className:this.classes.menuItem+" "+(as.location.pathname===this.personalInfoLink||as.location.pathname===this.PeronalInfoEditLink?this.classes.menuItemActive:""),replace:!0},t(I,{button:!0,key:"Personal Information"},t(T,{classes:{primary:this.classes.primary},primary:"Personal Information"}))),t(Fe,{to:this.addressListLink+this.addressSearchQuery,className:this.classes.menuItem+" "+(as.location.pathname===this.addressListLink?this.classes.menuItemActive:""),replace:!0},t(I,{button:!0,key:"Address Book"},t(T,{classes:{primary:this.classes.primary},primary:"Address Book"}))),t(Fe,{to:this.customerOrderLink,className:this.classes.menuItem+" "+(as.location.pathname===this.customerOrderLink?this.classes.menuItemActive:""),replace:!0},t(I,{button:!0,key:"Orders"},t(T,{classes:{primary:this.classes.primary},primary:"Orders"}))),this.props.extraPages&&this.props.extraPages.map((function(r,n){var s="/customers/"+e.props.currentContactId+"/"+r.getLink({CustomerId:e.props.currentContactId});return t(Fe,{key:n,to:s,className:e.classes.menuItem+" "+(as.location.pathname===s?e.classes.menuItemActive:""),replace:!0},t(I,null,t(T,{classes:{primary:e.classes.primary},primary:r.title})))})))},r.prototype.render=function(){var e,r=this;return t(Nn,{title:"Contact Details",showDialogActions:this.props.showDialogActions,closeView:function(){return r.closeProfileOverview()}},t(Ke,{smUp:!0,implementation:"js"},t(D,{className:this.classes.drawer,variant:"temporary",classes:{paper:this.classes.drawerPaper},open:this.props.drawerIsExpanded,anchor:"right",onClose:function(){return r.props.dispatch(fr.ContactActions.setDrawerIsExpanded(!1))}},t("div",{className:this.classes.toolbar}),this.getMenuListItem())),t(Ke,{xsDown:!0,implementation:"js"},t(D,{className:this.classes.drawer,variant:"permanent",classes:{paper:this.classes.drawerPaper},open:!0,anchor:"left"},t("div",{className:this.classes.toolbar}),this.getMenuListItem())),t("main",{className:this.classes.content},t("div",{className:this.classes.childContent},t(ke,{location:as.location},t(_e,{exact:!0,path:Pr,render:function(e){return t(Ds,{contactId:e.match.params.id})}}),t(_e,{exact:!0,path:Gr,render:function(e){return t(ys,{contactId:e.match.params.id})}}),t(_e,{path:Nr,render:function(e){return t(Pn,Bt({contactId:e.match.params.id},e))}}),t(_e,{exact:!0,path:Rr,render:function(e){return t(bs,{customerId:e.match.params.id})}}),this.props.extraPages&&(null===(e=this.props.extraPages)||void 0===e?void 0:e.map((function(e){return t(_e,{path:"/customers/"+r.props.currentContactId+e.path,exact:e.exact,render:function(t){return e.render({CustomerId:r.props.currentContactId})}})})))),this.props.discardChangesDialogIsVisible&&t(Rn,{discardChanges:this.discardChanges}))),this.state.discardDialogOpen&&t(Sn,{title:"Leave page?",closeButtonLabel:"Cancel",confirmButtonLabel:"Leave",onConfirm:function(){return r.leavePage()},onClose:function(){return r.setState({discardDialogOpen:!1})}},t(m,{variant:"body1"},"You have unsaved changes. Do you want to leave the page without saving?")))},r}(n),Gs=z((function(e){var t,r,n=e.palette,s=e.spacing,i=e.zIndex,o=e.mixins,a=e.breakpoints;return c({root:{display:"flex"},appBar:{zIndex:i.drawer+1},drawer:{width:240,flexShrink:0},drawerPaper:{width:240,background:fn.light},content:(t={flexGrow:1,padding:3*s.unit},t[a.down("xs")]={padding:0},t),childContent:(r={marginLeft:240},r[a.down("xs")]={marginLeft:0},r),toolbar:o.toolbar,menuItem:{display:"block",borderLeftWidth:5,borderLeftStyle:"solid",borderLeftColor:fn.light,textDecoration:"none"},menuItemActive:{backgroundColor:n.common.white,borderLeftColor:n.primary.main},selected:{},primary:{}})}))(u((function(e,t){var r,n,s=e.setting.pageConfig.contactDetail;return Bt({isCurrentFormDirty:e.application.isCurrentFormDirty,showDialogActions:!e.contact.personalInformationEditViewIsVisible&&e.contact.addressDetailsViewMode===Jt.Hide,currentContactId:t.customerId,drawerSelectedMenu:e.contact.drawerSelectedMenu,drawerNextMenu:e.contact.drawerNextMenu,drawerIsExpanded:e.contact.drawerIsExpanded,discardChangesDialogIsVisible:e.application.currentDialog===zt.DiscardChanges,extraPages:null===(n=null===(r=s)||void 0===r?void 0:r.config)||void 0===n?void 0:n.extraPages},t)}))(Ps)),Ns=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.render=function(){return t(Gs,Bt({},this.props))},r}(n),Rs=function(e){var r=e.amount;return t(We,Bt({variant:"body1",component:"span"},e),r.Amount.toFixed(r.Fractions)+" "+r.Currency)};!function(e){e[e.DateTime=4]="DateTime",e[e.Decimal=5]="Decimal",e[e.Float=6]="Float",e[e.Int=8]="Int",e[e.Money=9]="Money",e[e.Integer=26]="Integer",e[e.Boolean=27]="Boolean",e[e.Date=28]="Date",e[e.Email=29]="Email",e[e.URL=30]="URL",e[e.ShortString=31]="ShortString",e[e.LongString=32]="LongString",e[e.LongHtmlString=33]="LongHtmlString",e[e.DictionarySingleValue=34]="DictionarySingleValue",e[e.DictionaryMultiValue=35]="DictionaryMultiValue",e[e.EnumSingleValue=36]="EnumSingleValue",e[e.EnumMultiValue=37]="EnumMultiValue",e[e.StringDictionary=38]="StringDictionary",e[e.File=39]="File",e[e.ImageFile=40]="ImageFile"}(As||(As={}));var Es=As;Ee.addValidationRule(Zr.IsURL,Zr.isValidUrl),Ee.addValidationRule(Zr.IsInteger,Zr.isValidInteger),Ee.addValidationRule(Zr.IsMoney,Zr.isValidMoney);var xs,Ls=function(e){function r(t){var r=e.call(this,t)||this;r.state={value:null===r.props.property.Value?"":r.props.property.Value},r.validators=[],r.errorMessages=[],r.inputRef=s(),r.isMultiLine=!1,r.maxRows=4,r.onChangeHandler=function(e){r.setState({value:e.currentTarget.value})},r.onBlurHandler=function(e){if(!0===r.inputRef.current.isValid()){if(!(r.state.value&&""!==r.state.value||r.props.property.Value&&""!==r.props.property.Value))return;if(r.state.value!==r.props.property.Value){var t=Object.assign({},r.props.property);t.Value=r.state.value,r.props.onPropertyChanged(t)}}};var n=r.props.property.DataType;if(r.props.property.AllowNulls||r.addValidation(Zr.Required),n===Es.Integer||n===Es.Int)r.addValidation(Zr.IsInteger);else if(n===Es.Float)r.addValidation(Zr.IsFloatRegex);else if(n===Es.Decimal){var i=parseInt(r.props.property.Attributes.mdpprecision,10),o=parseInt(r.props.property.Attributes.mdpscale,10),a="Decimal"+i+","+o;Ee.addValidationRule(a,(function(e){var t=new Le(e);return""===e||!(t.isNaN()||t.decimalPlaces()>o||t.precision()>i)})),r.validators.push(a),r.errorMessages.push("Value is not valid decimal("+i+","+o+")")}else n===Es.Money?r.addValidation(Zr.IsMoney):n===Es.Email?r.addValidation(Zr.IsEmail):n===Es.URL?r.addValidation(Zr.IsURL):[Es.LongHtmlString,Es.LongString].indexOf(n)>=0&&(r.isMultiLine=!0);return r}return Vt(r,e),r.prototype.shouldComponentUpdate=function(e,t){return e.property.Value!==this.props.property.Value&&e.property.Value!==t.value&&(t.value=null===e.property.Value?"":e.property.Value),!0},r.prototype.addValidation=function(e){this.validators.push(e),this.errorMessages.push(Zr.getValidationMessage(e))},r.prototype.render=function(){return t(xe,{ref:this.inputRef,multiline:this.isMultiLine,rowsMax:this.maxRows,className:this.isMultiLine?"textarea-input-control":"",variant:"outlined",fullWidth:!0,name:this.props.property.Name,label:this.props.property.FriendlyName+(!0===this.props.property.AllowNulls?"":" *"),value:this.state.value,onChange:this.onChangeHandler,onBlur:this.onBlurHandler,validators:this.validators,errorMessages:this.errorMessages,withRequiredValidator:!0,disabled:this.props.isReadonly})},r}(n),Ms=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={value:null===t.props.property.Value?null:ot(t.props.property.Value)},t.onChangeHandler=function(e){var r=null!==t.props.property.Value?ot(t.props.property.Value).toISOString():null,n=e?e.toISOString():null;if(t.props.property.DataType===Es.Date&&(r&&(r=ot(r).startOf("day").toISOString()),n&&(n=ot(n).startOf("day").toISOString())),n!==r){var s=Bt({},t.props.property);s.Value=n,t.props.onPropertyChanged(s)}t.setState({value:e})},t}return Vt(r,e),r.prototype.shouldComponentUpdate=function(e,t){return e.property.Value!==this.props.property.Value&&e.property.Value!==t.value&&(t.value=null===e.property.Value?null:ot(e.property.Value)),!0},r.prototype.render=function(){var e=this;return t("div",null,t("div",{className:"picker"},this.props.property.DataType===Es.Date&&t(H,{fullWidth:!0,variant:"outlined",keyboard:!1,clearable:this.props.property.AllowNulls&&null!==this.state.value,label:this.props.property.FriendlyName,format:"DD MMM YYYY",required:!this.props.property.AllowNulls,disableOpenOnEnter:!0,animateYearScrolling:!0,disabled:this.props.isReadonly,value:this.state.value,onChange:function(t){return e.onChangeHandler(t)}}),this.props.property.DataType===Es.DateTime&&t(W,{fullWidth:!0,variant:"outlined",keyboard:!1,clearable:this.props.property.AllowNulls&&null!==this.state.value,label:this.props.property.FriendlyName,format:"DD MMM YYYY hh:mm",required:!this.props.property.AllowNulls,disableOpenOnEnter:!0,animateYearScrolling:!0,disabled:this.props.isReadonly,value:this.state.value,onChange:function(t){return e.onChangeHandler(t)}})))},r}(n),Fs=function(e){return t("tr",{className:"mdc-data-table__row"+(e.isRowSelected?" mdc-data-table__row--selected":"")},e.selectableRows&&t("td",{className:"mdc-data-table__cell mdc-data-table__cell--checkbox"},t(ue,{checked:e.isRowSelected,onChange:function(t){e.setRowSelected(e.rowIndex,!e.isRowSelected)}})),e.columns.map((function(r,n){if(r.hidden)return null;var s=r.selector?e.rowData[r.selector]:"";return r.render&&(s=r.render(e.rowData,e.rowIndex)),t("td",{className:"mdc-data-table__cell"+(r.hide?" hide-"+r.hide:"")+(r.right?" align-right":""),key:n,onClick:function(){e.onRowClicked()},onDoubleClick:function(){e.onRowDoubleClicked()}},t("div",{style:{whiteSpace:"pre-wrap"}},s))})))},ks=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.render=function(){var e=this;return t("tr",{className:"mdc-data-table__header-row"},this.props.selectableRows&&t("th",{className:"mdc-data-table__header-cell mdc-data-table__header-cell--checkbox",role:"columnheader",scope:"col",style:{width:"60px"}},t(ue,{checked:this.props.isSelectedAll,indeterminate:this.props.indeterminate,onChange:function(t){e.props.setHeaderRowChecked(!e.props.isSelectedAll)}})),this.props.columns.map((function(e,r){if(e.hidden)return null;var n={};return e.width&&(n.width=e.width+"px"),e.minWidth&&(n.minWidth=e.minWidth+"px"),e.maxWidth&&(n.maxWidth=e.maxWidth+"px"),t("th",{className:"mdc-data-table__header-cell epi-table__header-cell"+(e.hide?" hide-"+e.hide:"")+(e.right?" align-right":""),role:"columnheader",scope:"col",key:r,style:n},t("div",{className:"epi-table__header-title"},t("span",{className:"header-title"},e.name)))})))},r}(n),_s=function(){return t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},t("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),t("path",{d:"M0 0h24v24H0z",fill:"none"}))},Vs=function(e){return t("div",{className:"epi-table__toolbar"},t("div",null,e.contextActions&&e.selectedCount>0?t("div",{className:"action-buttons"},e.contextActions.map((function(e,r){return t(se,{outlined:!0,key:r,onClick:function(){e.clickHandler&&e.clickHandler()}},e.title)}))):t("div",null,e.buttons&&e.buttons.map((function(e,r){return t(se,{key:r,outlined:!0,onClick:function(){e.clickHandler()}},e.title)})))),e.searchInput&&t("div",null,t("div",{className:"search-input"},t("div",{className:"search-icon"},t(_s,null)),t(P,{placeholder:e.searchInput.placeholder}))))},Us=function(e){function r(t){var r=e.call(this,t)||this;return r.foundation=new mt,r.rowElements=[],r.isSelectedAll=!1,r.isSelectedRows=new Array,r.selectedCount=0,r.tableInstance={getSelectedRows:function(){var e=new Array;return r.isSelectedRows.forEach((function(t,n){!0===t&&r.data[n]&&e.push(r.data[n])})),e},setRowSelected:function(e,t){r.isSelectedRows[e]!==t&&(!0===t?(r.selectedCount++,r.selectedCount===r.data.length&&(r.isSelectedAll=!0)):(r.selectedCount--,!0===r.isSelectedAll&&(r.isSelectedAll=!1))),r.isSelectedRows[e]=t,r.props.selectableRowsPreSelectedField&&(r.data[e][r.props.selectableRowsPreSelectedField]=t),r.props.onRowSelected&&r.props.onRowSelected(e,t),r.forceUpdate()},setHeaderRowChecked:function(e){r.isSelectedAll=e;for(var t=0;t<r.data.length;t++)r.isSelectedRows[t]=e;r.selectedCount=e?r.data.length:0,r.props.selectableRowsPreSelectedField&&r.data.forEach((function(t){t[r.props.selectableRowsPreSelectedField]=e})),r.props.onHeaderRowSelected&&r.props.onHeaderRowSelected(e),r.forceUpdate()},addRow:function(e){r.data.push(e),r.initDataTable(),r.forceUpdate()},removeRow:function(e){r.data.splice(e,1),r.isSelectedRows.splice(e,1),r.initDataTable(),r.forceUpdate()},getData:function(){return r.data},refresh:function(){r.forceUpdate()}},r.defaultSettings={columns:[],data:[]},r.dataTableElement=s(),r.data=r.props.data,r.initDataTable(),r}return Vt(r,e),r.prototype.componentDidMount=function(){this.instance=new ht(this.dataTableElement.current,new mt(this.adapter)),this.props.tableInstance&&Object.assign(this.props.tableInstance,this.tableInstance)},r.prototype.componentWillReceiveProps=function(e){this.data=e.data},Object.defineProperty(r.prototype,"adapter",{get:function(){return{}},enumerable:!0,configurable:!0}),r.prototype.initDataTable=function(){var e=this;this.props.selectableRowsPreSelectedField&&(this.selectedCount=0,this.data.map((function(t,r){!0===t[e.props.selectableRowsPreSelectedField]&&(e.selectedCount++,e.isSelectedRows[r]=!0)})))},r.prototype.render=function(){var e=this,r=this.props.contextActions&&this.props.toolbar;return t("div",{ref:this.dataTableElement},t("div",{className:"mdc-data-table epi-table"},r&&t(Vs,Bt({},this.props.toolbar,{contextActions:this.props.contextActions,selectedCount:this.selectedCount})),t("table",{className:"mdc-data-table__table"},t("thead",null,t(ks,{columns:this.props.columns,selectableRows:this.props.selectableRows,isSelectedAll:this.isSelectedAll,indeterminate:this.selectedCount>0&&!this.isSelectedAll,setHeaderRowChecked:function(t){return e.tableInstance.setHeaderRowChecked(t)}})),t("tbody",{className:"mdc-data-table__content"},this.data.map((function(r,n){return t(Fs,{key:n,rowData:r,rowIndex:n,columns:e.props.columns,isRowSelected:!!e.isSelectedRows[n],selectableRows:e.props.selectableRows,setRowSelected:function(t,r){return e.tableInstance.setRowSelected(t,r)},onRowClicked:function(){e.props.onRowClicked&&e.props.onRowClicked(r,n)},onRowDoubleClicked:function(){e.props.onRowDoubleClicked&&e.props.onRowDoubleClicked(r,n)}})}))))))},r}(n),Bs=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={editingRowIndex:-1,currentEditingRowValue:""},n.onValueCellChange=function(e){n.setState({currentEditingRowValue:e.currentTarget.value})},n.renderValueCell=function(e,r){return e?t(xe,{name:"valueInput",variant:"outlined",defaultValue:r,value:n.state.currentEditingRowValue,onChange:n.onValueCellChange,validators:[Zr.Required],errorMessages:[Zr.getValidationMessage(Zr.Required)],withRequiredValidator:!0}):r},n.renderActionsCell=function(e,s,i,o){return e?t(r,null,t(at,{title:"Save"},t(ut,{onClick:function(){return n.saveItem(i)}},t(pt,null))),t(at,{title:"Cancel"},t(ut,{onClick:n.cancelEditing},t(lt,null)))):-1===n.state.editingRowIndex&&t(r,null,t(at,{title:"Edit item"},t(ut,{onClick:function(){return n.editRow(s,o)}},t(dt,null))),t(at,{title:"Delete item"},t(ut,{onClick:function(){return n.deleteRow(i)}},t(ct,null))))},n.saveItem=function(e){if(n.state.currentEditingRowValue){var t=Object.assign({},n.props.itemsObject);t[e]=n.state.currentEditingRowValue,n.props.onItemsUpdated(t),n.cancelEditing()}},n.cancelEditing=function(){n.setState({editingRowIndex:-1})},n.editRow=function(e,t){n.setState({editingRowIndex:e,currentEditingRowValue:t})},n.deleteRow=function(e){var t=Object.assign({},n.props.itemsObject);delete t[e],n.props.onItemsUpdated(t)},n}return Vt(n,e),n.prototype.render=function(){var e=this,r=Object.keys(this.props.itemsObject),n=[{name:"Key",width:300,render:function(e){return e.key}},{name:"Value",render:function(t,r){var n=e.state.editingRowIndex===r;return e.renderValueCell(n,e.props.itemsObject[t.key])}}];this.props.isReadonly||n.push({name:"Options",width:150,right:!0,render:function(t,r){var n=e.state.editingRowIndex===r;return e.renderActionsCell(n,r,t.key,t.value)}});var s=r.map((function(t){return{key:t,value:e.props.itemsObject[t]}}));return t(Us,{data:s,columns:n})},n}(n),Hs=function(e){function r(t){var r=e.call(this,t)||this;return r.validators=[],r.errorMessages=[],r.state={isDetailsDialogOpen:!1,itemsObject:Object.assign({},r.props.property.Value),inputKey:"",inputValue:"",loaded:!1},r.openDetailsDialog=function(){r.setState({isDetailsDialogOpen:!0}),setTimeout((function(){r.setState({loaded:!0})}),100)},r.closeDetailsDialog=function(){r.setState({isDetailsDialogOpen:!1})},r.updateItemsObject=function(e){r.setState({itemsObject:e})},r.addItem=function(e){var t=r.state.inputKey.toLowerCase().trim(),n=r.state.inputValue;if(!r.state.itemsObject[t]){var s=Object.assign({},r.state.itemsObject);s[t]=n,r.setState({itemsObject:s})}},r.onInputKeyChange=function(e){r.setState({inputKey:e.currentTarget.value})},r.onInputValueChange=function(e){r.setState({inputValue:e.currentTarget.value})},r.saveProperty=function(){var e=Object.assign({},r.props.property);e.Value=r.state.itemsObject,r.props.onPropertyChanged(e),r.closeDetailsDialog()},r.handleClosingDetailsDialog=function(){var e=Object.assign({},r.props.property.Value);r.setState({itemsObject:e}),r.closeDetailsDialog()},r.validators.push(Zr.Required),r.errorMessages.push(Zr.getValidationMessage(Zr.Required)),r}return Vt(r,e),r.prototype.shouldComponentUpdate=function(e,t){return e.property.Value!==this.props.property.Value&&e.property.Value!==t.itemsObject&&(t.itemsObject=Object.assign({},e.property.Value),t.inputKey="",t.inputValue=""),!0},r.prototype.render=function(){var e=this.props.isReadonly;return t("div",null,t(m,null,this.props.property.FriendlyName,this.props.property.AllowNulls?"":" *"),t(se,{outlined:!0,onClick:this.openDetailsDialog},"View Details"),t(Cn,{title:"Dictionary Items",open:this.state.isDetailsDialogOpen,okLabel:"Save",onOK:this.saveProperty,closeLabel:"Close",onClose:this.handleClosingDetailsDialog,large:!0},t(l,{container:!0,spacing:16},!e&&t(l,{item:!0,xs:12},this.state.loaded&&t(Ee,{onSubmit:this.addItem},t(l,{container:!0,spacing:24,alignItems:"center"},t(l,{item:!0,xs:12,sm:4},t(xe,{fullWidth:!0,variant:"outlined",label:"Key",name:"inputKey",value:this.state.inputKey,onChange:this.onInputKeyChange,validators:this.validators,errorMessages:this.errorMessages,withRequiredValidator:!0})),t(l,{item:!0,xs:12,sm:4},t(xe,{fullWidth:!0,variant:"outlined",label:"Value",name:"inputValue",value:this.state.inputValue,onChange:this.onInputValueChange,validators:this.validators,errorMessages:this.errorMessages,withRequiredValidator:!0})),t(l,{item:!0,xs:12,sm:4},t(se,{unelevated:!0,type:"submit"},"Add item"))))),t(l,{item:!0,xs:12},t(Bs,{isReadonly:e,itemsObject:this.state.itemsObject,onItemsUpdated:this.updateItemsObject})))))},r}(n),Ws=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedIds:t.props.property.Value||[]},t.handleChange=function(e){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){return this.props.property.DataType===Es.DictionaryMultiValue||this.props.property.DataType===Es.EnumMultiValue?this.setState({selectedIds:e.target.value}):this.setState({selectedIds:[e.target.value]}),[2]}))}))},t.isSelectedItemsChanged=function(e,t){var r=!1;if(e.length!==t.length)r=!0;else for(var n=0,s=e;n<s.length;n++){var i=s[n];if(-1===t.indexOf(i)){r=!0;break}}return r},t.onSelectBlurHandler=function(e){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){return this.isSelectedItemsChanged(this.props.property.Value||[],this.state.selectedIds)&&((e=Object.assign({},this.props.property)).Value=this.state.selectedIds,this.props.onPropertyChanged(e)),[2]}))}))},t}return Vt(r,e),r.prototype.shouldComponentUpdate=function(e,t){return e.property.Value!==this.props.property.Value&&e.property.Value!==t.selectedIds&&(t.selectedIds=e.property.Value||[]),!0},r.prototype.render=function(){var e=this;return t(G,{fullWidth:!0,variant:"outlined"},t(N,null,this.props.property.FriendlyName),t(S,{input:t(R,{labelWidth:150}),multiple:this.props.property.DataType===Es.DictionaryMultiValue||this.props.property.DataType===Es.EnumMultiValue,value:this.state.selectedIds,onChange:this.handleChange,onBlur:this.onSelectBlurHandler},this.props.property.DictionaryItems.map((function(r){return t(I,{disabled:e.props.isReadonly,key:r.Id,value:r.Id},r.Value)}))))},r}(n),qs=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={value:!0===t.props.property.Value?"true":!1===t.props.property.Value?"false":void 0},t.onChangeHandler=function(e){t.setState({value:e.currentTarget.value});var r=Object.assign({},t.props.property);r.Value="true"===e.currentTarget.value||"false"!==e.currentTarget.value&&null,t.props.onPropertyChanged(r)},t}return Vt(r,e),r.prototype.shouldComponentUpdate=function(e,t){return e.property.Value!==this.props.property.Value&&e.property.Value!==t.value&&(t.value=!0===e.property.Value?"true":!1===e.property.Value?"false":void 0),!0},r.prototype.render=function(){return t("div",null,t(yt,{style:{fontSize:"0.75rem"},component:"label"},this.props.property.FriendlyName),t(ft,{value:this.state.value,onChange:this.onChangeHandler,row:!0},t(gt,{style:{marginLeft:"0px",marginRight:"0px"},value:"true",control:t(vt,{color:"primary"}),label:"True",labelPlacement:"start",disabled:this.props.isReadonly}),t(gt,{value:"false",control:t(vt,{color:"primary"}),label:"False",labelPlacement:"start",disabled:this.props.isReadonly})))},r}(n),js=function(e){function r(r){var n=e.call(this,r)||this;return n.renderInput=function(e){var r={property:e,isReadonly:n.props.isReadonly,onPropertyChanged:n.props.onPropertyChanged};return[Es.Decimal,Es.Float,Es.Int,Es.Money,Es.Integer,Es.Email,Es.URL,Es.ShortString,Es.LongString,Es.LongHtmlString].indexOf(e.DataType)>=0?t(Ls,Bt({},r)):[Es.Date,Es.DateTime].indexOf(e.DataType)>=0?t(Ms,Bt({},r)):e.DataType===Es.DictionaryMultiValue||e.DataType===Es.EnumMultiValue||e.DataType===Es.DictionarySingleValue||e.DataType===Es.EnumSingleValue?t(Ws,Bt({},r)):e.DataType===Es.Boolean?t(qs,Bt({},r)):e.DataType===Es.StringDictionary?t(Hs,Bt({},r)):t(l,null,t(m,null,e.FriendlyName),t(m,null,e.Value))},n}return Vt(r,e),r.prototype.render=function(){return this.renderInput(this.props.property)},r}(n),Ys=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isExpanded:!t.props.isCollapsible,hasShowAll:!0,propertiesBody:s()},t.togglePanelHandler=function(e){return Wt(t,void 0,void 0,(function(){return qt(this,(function(e){return this.setState({isExpanded:!this.state.isExpanded}),[2]}))}))},t}return Vt(r,e),r.prototype.updateLayout=function(){this.state.propertiesBody.current&&(this.state.propertiesBody.current.clientHeight<140?this.setState({hasShowAll:!1}):this.setState({hasShowAll:!0}))},r.prototype.componentDidMount=function(){this.updateLayout(),window.addEventListener("resize",this.updateLayout.bind(this))},r.prototype.render=function(){var e=this;return t(Ee,{instantValidate:!0,onSubmit:function(){return null}},t(b,null,t(E,{in:this.state.isExpanded,collapsedHeight:"180px"},t("div",{ref:this.state.propertiesBody},t(O,null,t(l,{container:!0,className:this.props.classes.expandableContainer},this.props.properties.map((function(r){return t(l,{key:r.Id,item:!0,xs:12,sm:6,lg:4,className:e.props.classes.expandableItem},t(js,{property:r,isReadonly:e.props.isReadonly||!r.IsEditable,onPropertyChanged:e.props.onPropertyChanged}))})))))),this.props.isCollapsible&&this.state.hasShowAll&&t(x,null,t(se,{outlined:!0,className:this.props.classes.toggleButton,onClick:this.togglePanelHandler},"Show ",this.state.isExpanded?"Less":"All"))))},r}(n),zs=p((function(e){e.palette,e.spacing,e.breakpoints;return c({expandableContainer:{overflowY:"hidden",paddingTop:"8px"},expandableItem:{marginBottom:10,padding:"0 20px 20px 0px"},toggleButton:{margin:"0 auto",width:"100%",maxWidth:"250px"}})}))(u((function(e,t){return{isReadonly:void 0!==t.isReadonly&&t.isReadonly,isCollapsible:void 0===t.isCollapsible||t.isCollapsible,properties:t.properties,onPropertyChanged:t.onPropertyChanged,classes:t.classes}}))(Ys)),Qs=function(e){return e?e.replace(/([A-Z])/g," $1").trim():""},Ks=0,Xs=z((function(e){return c({root:{flexGrow:1},selectContainer:{display:"inline"},currency:{height:30}})}))(u((function(e,t){return{currencies:e.orderGroup.currencies,selectedCurrency:e.orderGroup.currentOrderGroup.Currency,classes:t.classes,updateInputValue:t.updateInputValue}}))((function(e){var n=e.currencies.map((function(e){return{label:e.Code,value:e.Code}}));return e.currencies.length>0?t(Jr,{label:"Currency","refresh-counter":Ks++,value:e.selectedCurrency,options:n,onChange:function(t){e.updateInputValue(t)}}):t(r,null)}))),Js=u((function(e,t){var r=e.orderGroup.currentOrderGroup;return{orderGroupType:r.Type,orderGroupId:r.OrderGroupId,newOrderCurrency:t.newOrderCurrency,close:t.onClose}}))((function(e){return t(Sn,{title:"Update Currency",closeButtonLabel:"Cancel",confirmButtonLabel:"Update",onConfirm:function(){return Wt(void 0,void 0,void 0,(function(){var t,r,n,s;return qt(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=e.orderGroupId,r=e.orderGroupType,[4,ln.OrderGroup.updateCurrencyForOrder(r,t,e.newOrderCurrency)];case 1:return 200!==i.sent().status?[3,3]:[4,ln.OrderGroup.getSingleOrderGroup(r,t)];case 2:n=i.sent(),e.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(n)),n.ValidationMessages.length>0&&e.dispatch(fr.ApplicationActions.showNotification(n.ValidationMessages)),i.label=3;case 3:return[3,5];case 4:return s=i.sent(),e.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,5];case 5:return e.close(!0),[2]}}))}))},onClose:function(){return e.close(!1)}},t(m,{variant:"body1"},t("div",null,t("b",null,"Are you sure you want to change the currency?")),"Changing currency could affect shipping and payment methods, prices or searched items."))})),Zs=u((function(e,t){return{orderGroupId:e.orderGroup.currentOrderGroup.OrderGroupId,newOrderMarket:t.newOrderMarket,close:t.onClose}}))((function(e){return t(Sn,{title:"Update Market",closeButtonLabel:"Cancel",confirmButtonLabel:"Update",onConfirm:function(){return Wt(void 0,void 0,void 0,(function(){var t,r,n;return qt(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),[4,ln.Cart.updateMarketForCart(e.orderGroupId,e.newOrderMarket)];case 1:return 200!==s.sent().status?[3,4]:[4,ln.OrderGroup.getSingleOrderGroup("Cart",e.orderGroupId)];case 2:return t=s.sent(),e.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(t)),t.ValidationMessages.length>0&&e.dispatch(fr.ApplicationActions.showNotification(t.ValidationMessages)),[4,ln.Currency.getCurrencies(e.newOrderMarket)];case 3:r=s.sent(),e.dispatch(fr.OrderGroupActions.setCurrencies(r)),s.label=4;case 4:return[3,6];case 5:return n=s.sent(),e.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,6];case 6:return e.close(!0),[2]}}))}))},onClose:function(){return e.close(!1)}},t(m,{variant:"body1"},t("div",null,t("b",null,"Are you sure you want to change the market?")),"Changing market could affect shipping and payment methods, prices and items that can be added to the cart."))})),$s=z((function(e){return c({})}))(u((function(e,t){return{markets:e.market.markets,selectedMarket:t.selectedMarket,classes:t.classes,updateInputValue:t.updateInputValue}}))((function(e){var r=e.markets,n=e.selectedMarket,s=r.map((function(e){return{label:e.Name,value:e.Id}}));return t(Jr,{label:"Choose Market",fullWidth:!0,options:s,value:n,onChange:function(t){return e.updateInputValue(t)}})}))),ei=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={selectedCurrency:"",isUpdateCurrencyDialogOpen:!1,selectedMarket:"",isUpdateMarketDialogOpen:!1},t.customerEditLink="/customers/"+t.props.orderGroup.Customer.Id+"/info?orderType="+t.props.orderGroup.Type+"&orderId="+t.props.orderGroup.OrderGroupId,t.customPropertyChangedHandler=function(e){return Wt(t,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,ln.MetaField.updateOrderGroupMetaFields(this.props.orderGroup.OrderGroupId,this.props.orderGroup.Type,e)];case 1:return n.sent(),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 2:return t=n.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(t)),[3,4];case 3:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,4];case 4:return[2]}}))}))},t.updateMarketForCart=function(e){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){return e===this.props.orderGroup.MarketId||this.setState({selectedMarket:e,isUpdateMarketDialogOpen:!0}),[2]}))}))},t.updateCurrencyForOrder=function(e){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){return e===this.props.orderGroup.Currency||this.setState({selectedCurrency:e,isUpdateCurrencyDialogOpen:!0}),[2]}))}))},t.closeOrderMarketUpdateDialogHandler=function(e){t.setState({isUpdateMarketDialogOpen:!1}),e||t.setState({selectedMarket:t.props.orderGroup.MarketId})},t.closeOrderCurrencyUpdateDialogHandler=function(e){t.setState({isUpdateCurrencyDialogOpen:!1}),e||t.setState({selectedCurrency:t.props.orderGroup.Currency})},t}return Vt(r,e),r.prototype.render=function(){return t($,{container:!0,direction:"column",spacing:16},!this.props.createMode&&t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Order Number"),t(m,{className:this.props.classes.itemData},this.props.orderGroup.OrderNumber?this.props.orderGroup.OrderNumber:this.props.orderGroup.OrderGroupId)),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Created Date"),t(m,{className:this.props.classes.itemData},ot(this.props.orderGroup.Created).format("LLL"))),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Status"),t(m,{className:this.props.classes.itemData},Qs(this.props.orderGroup.OrderStatus))),t($,{item:!0},t(L,null)),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Items"),t(Rs,{amount:this.props.orderGroup.ItemsTotal,className:this.props.classes.itemData})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Line Item Discounts"),t(Rs,{amount:this.props.orderGroup.LineItemDiscounts,className:this.props.classes.itemData})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Order Level Discounts"),t(Rs,{amount:this.props.orderGroup.OrderLevelDiscounts,className:this.props.classes.itemData})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Discount Total"),t(Rs,{amount:this.props.orderGroup.DiscountsTotal,className:this.props.classes.itemData})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Taxes Total"),t(Rs,{amount:this.props.orderGroup.TaxTotal,className:this.props.classes.itemData})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},this.props.orderGroup.PricesIncludeTax?"Total excluding shipping (includes tax)":"Total excluding shipping and tax"),t(Rs,{amount:this.props.orderGroup.TotalExcludingShippingAndTax,className:this.props.classes.itemData})),t($,{item:!0},t(L,null)),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Shipping Cost"),t(Rs,{amount:this.props.orderGroup.ShippingTotal,className:this.props.classes.itemData})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Shipping Discounts"),t(Rs,{amount:this.props.orderGroup.ShippingDiscount,className:this.props.classes.itemData})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Handling Total"),t(Rs,{amount:this.props.orderGroup.HandlingTotal,className:this.props.classes.itemData})),t($,{item:!0},t(L,null)),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Order Total"),t(Rs,{amount:this.props.orderGroup.Total,className:this.props.classes.itemData})),t($,{item:!0},t(L,null)),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Market"),!0===this.props.createMode&&"PaymentPlan"===this.props.orderGroup.Type?t("span",{className:this.props.classes.itemData},t($s,{selectedMarket:this.props.orderGroup.MarketId,updateInputValue:this.updateMarketForCart})):t(m,{className:this.props.classes.itemData},this.props.orderGroup.MarketName),this.state.isUpdateMarketDialogOpen&&t(Zs,{newOrderMarket:this.state.selectedMarket,onClose:this.closeOrderMarketUpdateDialogHandler})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel},"Currency"),this.props.isReadonly?t(m,{className:this.props.classes.itemData},this.props.orderGroup.Currency):t("span",{className:this.props.classes.itemData},t(Xs,{updateInputValue:this.updateCurrencyForOrder})),this.state.isUpdateCurrencyDialogOpen&&t(Js,{newOrderCurrency:this.state.selectedCurrency,onClose:this.closeOrderCurrencyUpdateDialogHandler})),!this.props.createMode&&this.props.orderGroup.Properties&&this.props.orderGroup.Properties.length>0&&t($,{item:!0},t(m,{variant:"subtitle1"},"Custom Properties"),t(zs,{properties:this.props.orderGroup.Properties,onPropertyChanged:this.customPropertyChangedHandler,isReadonly:this.props.isReadonly,isCollapsible:!1})))},r}(n),ti=p((function(){return c({itemLabel:{width:"200px",display:"inline-block",fontSize:14},itemData:{display:"inline-block",fontSize:14}})}))(u()(ei)),ri=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isUpdateMarketDialogOpen:!1,isUpdateCurrencyDialogOpen:!1,selectedMarket:"",selectedCurrency:""},t.updateMarketForCart=function(e){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){return e===this.props.orderGroup.MarketId||this.setState({selectedMarket:e,isUpdateMarketDialogOpen:!0}),[2]}))}))},t.updateCurrencyForOrder=function(e){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){return e===this.props.orderGroup.Currency||this.setState({selectedCurrency:e,isUpdateCurrencyDialogOpen:!0}),[2]}))}))},t.closeOrderMarketUpdateDialogHandler=function(e){t.setState({isUpdateMarketDialogOpen:!1}),e||t.setState({selectedMarket:t.props.orderGroup.MarketId})},t.closeOrderCurrencyUpdateDialogHandler=function(e){t.setState({isUpdateCurrencyDialogOpen:!1}),e||t.setState({selectedCurrency:t.props.orderGroup.Currency})},t}return Vt(r,e),r.prototype.render=function(){return t($,{container:!0,direction:"column",spacing:16},t($,{item:!0},t(m,{className:this.props.classes.itemLabel,variant:"caption"},"Cart Number"),t(m,{className:this.props.classes.itemData,variant:"caption"},this.props.orderGroup.OrderGroupId)),t($,{item:!0},t(m,{className:this.props.classes.itemLabel,variant:"caption"},"Created Date"),t(m,{className:this.props.classes.itemData,variant:"caption"},ot(this.props.orderGroup.Created).format("LLL"))),t($,{item:!0},t(m,{className:this.props.classes.itemLabel,variant:"caption"},"Order Level Discounts"),t(Rs,{className:this.props.classes.itemData,amount:this.props.orderGroup.OrderLevelDiscounts,align:"left",variant:"caption"})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel,variant:"caption"},"Cart Total"),t(Rs,{className:this.props.classes.itemData,amount:this.props.orderGroup.Total,align:"left",variant:"caption"})),t($,{item:!0},t(L,null)),t($,{item:!0},t(m,{className:this.props.classes.itemLabel,variant:"caption"},"Market"),t("span",{className:this.props.classes.itemData},t($s,{selectedMarket:this.props.orderGroup.MarketId,updateInputValue:this.updateMarketForCart})),this.state.isUpdateMarketDialogOpen&&t(Zs,{newOrderMarket:this.state.selectedMarket,onClose:this.closeOrderMarketUpdateDialogHandler})),t($,{item:!0},t(m,{className:this.props.classes.itemLabel,variant:"caption"},"Currency"),t("span",{className:this.props.classes.itemData},t(Xs,{updateInputValue:this.updateCurrencyForOrder})),this.state.isUpdateCurrencyDialogOpen&&t(Js,{newOrderCurrency:this.state.selectedCurrency,onClose:this.closeOrderCurrencyUpdateDialogHandler})))},r}(n),ni=p((function(e){e.spacing;return c({itemLabel:{width:"200px",display:"inline-block",fontSize:14},itemData:{display:"inline-block",fontSize:14}})}))(ri),si=function(e){var r="/customers/"+e.orderGroup.Customer.Id+"/info?orderType="+e.orderGroup.Type+"&orderId="+e.orderGroup.OrderGroupId;return t($,{container:!0,direction:"column"},t($,{item:!0},t($,{container:!0,alignItems:"center"},t($,{item:!0},t(m,{variant:"h6"},"Customer Information")),null!=e.orderGroup.Customer.Email&&t($,{item:!0},t(at,{title:"Edit Customer Information"},t(Fe,{to:r,onClick:function(){us(Dr)}},t(ie,null,t(oe,{style:{width:"16px"}}))))))),t($,{item:!0},t(b,null,t(O,null,t($,{container:!0,spacing:24},t($,{item:!0},t(m,{variant:"subtitle1"},"Customer: ",e.orderGroup.Customer.FullName)),t($,{item:!0},t(m,{variant:"subtitle1"},"Email Address: ",e.orderGroup.Customer.Email)))))))};!function(e){e.OnHold="OnHold",e.PartiallyShipped="PartiallyShipped",e.InProgress="InProgress",e.Completed="Completed",e.Cancelled="Cancelled",e.AwaitingExchange="AwaitingExchange"}(xs||(xs={}));var ii,oi=xs,ai=[{label:"None",value:"None"},{label:"Days",value:"Days"},{label:"Weeks",value:"Weeks"},{label:"Months",value:"Months"},{label:"Years",value:"Years"},{label:"Custom1",value:"Custom1"},{label:"Custom2",value:"Custom2"}],ui=Ae().shape({CycleMode:Oe().required(Zr.getValidationMessage(Zr.Required)),CycleLength:we().required(Zr.getValidationMessage(Zr.Required)).integer(Zr.getValidationMessage(Zr.IsInteger)).min(0),MaxCyclesCount:we().required(Zr.getValidationMessage(Zr.Required)).integer(Zr.getValidationMessage(Zr.IsInteger)).min(0),CompletedCyclesCount:we().required(Zr.getValidationMessage(Zr.Required)).integer(Zr.getValidationMessage(Zr.IsInteger)).min(0),StartDate:Te().nullable(),EndDate:Te().nullable().when("StartDate",(function(e,t){return e?t.min(e,"The End Date must greater than or equal to the Start Date."):t})),LastTransactionDate:Te().nullable(),IsActive:De()}),di=function(e){function n(t){var r=e.call(this,t)||this;r.datetimeFormat="MMM DD, YYYY hh:mm A",r.initPaymentPlanSetting=function(){var e={CycleMode:"None",StartDate:null,EndDate:null,LastTransactionDate:null,IsActive:!1};return r.props.createMode?Object.assign(e,r.props.paymentPlanSetting):e={CycleMode:null==r.props.paymentPlan.CycleMode?"None":r.props.paymentPlan.CycleMode,CycleLength:r.props.paymentPlan.CycleLength,MaxCyclesCount:r.props.paymentPlan.MaxCyclesCount,CompletedCyclesCount:r.props.paymentPlan.CompletedCyclesCount,StartDate:r.props.paymentPlan.StartDate,EndDate:r.props.paymentPlan.EndDate,LastTransactionDate:r.props.paymentPlan.LastTransactionDate,IsActive:null!=r.props.paymentPlan.IsActive&&r.props.paymentPlan.IsActive},r.props.dispatch(fr.OrderGroupActions.setPaymentPlanSetting(e)),e},r.isEditable=function(){return r.props.paymentPlan.OrderStatus!==oi.Cancelled&&!r.props.createMode},r.isValid=function(){return r.validatePaymentPlanSetting(r.state.paymentPlanSetting,!0)},r.validatePaymentPlanSetting=function(e,t){var n={};try{return ui.validateSync(e,{abortEarly:!1}),r.setState({errors:n}),!0}catch(s){return s.inner.map((function(r){(!t||null!==e[r.path]&&void 0!==e[r.path])&&(n[r.path]=r.message)})),r.setState({errors:n}),!1}},r.updatePaymentPlanSetting=function(e,t){return Wt(r,void 0,void 0,(function(){var r;return qt(this,(function(n){switch(n.label){case 0:return(r=Bt({},this.state.paymentPlanSetting))[e]=t,[4,this.validatePaymentPlanSetting(r,!0)];case 1:return n.sent(),this.setState({paymentPlanSetting:r}),this.props.dispatch(fr.OrderGroupActions.setPaymentPlanSetting(r)),[2]}}))}))},r.saveChange=function(){return Wt(r,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return this.validatePaymentPlanSetting(this.state.paymentPlanSetting)?[4,ln.PaymentPlan.updatePaymentPlanSetting(this.props.paymentPlan.OrderGroupId,this.state.paymentPlanSetting)]:[3,2];case 1:e.sent(),this.setState({editMode:!1}),e.label=2;case 2:return[2]}}))}))},r.cancelEdit=function(){r.setState({editMode:!1,errors:{},paymentPlanSetting:r.initPaymentPlanSetting()})},r.props.validator&&(r.props.validator.validate=r.isValid);var n=r.initPaymentPlanSetting();return r.state={paymentPlanSetting:n,errors:{},editMode:r.props.editMode},r}return Vt(n,e),n.prototype.render=function(){var e=this;return t(r,null,t($,{container:!0,direction:"column",className:this.props.classes.pageItem,spacing:16},t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"Last Transaction Date"),t("div",{className:this.props.classes.itemData},t(W,{fullWidth:!0,clearable:!0,variant:"outlined",disabled:!this.state.editMode,format:this.datetimeFormat,value:null==this.state.paymentPlanSetting.LastTransactionDate?null:ot(this.state.paymentPlanSetting.LastTransactionDate),onChange:function(t){return e.updatePaymentPlanSetting("LastTransactionDate",null==t?null:t.toDate())}}),t(m,{variant:"caption"},"The date of last transaction"),t(m,{variant:"caption",color:"error"},this.state.errors.LastTransactionDate))),t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"Completed Cycles*"),t("div",{className:this.props.classes.itemData},t(h,{fullWidth:!0,variant:"outlined",disabled:!this.state.editMode,required:!0,type:"number",className:this.props.classes.itemData,value:this.state.paymentPlanSetting.CompletedCyclesCount,onChange:function(t){var r=Number(t.target.value);isNaN(r)||e.updatePaymentPlanSetting("CompletedCyclesCount",r)}}),t(m,{variant:"caption"},"Number of completed cycles"),t(m,{variant:"caption",color:"error"},this.state.errors.CompletedCyclesCount))),t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"Cycle Length*"),t("div",{className:this.props.classes.itemData},t(h,{fullWidth:!0,variant:"outlined",disabled:!this.state.editMode,required:!0,type:"number",value:this.state.paymentPlanSetting.CycleLength,onChange:function(t){var r=Number(t.target.value);isNaN(r)||e.updatePaymentPlanSetting("CycleLength",r)}}),t(m,{variant:"caption"},"Cycle length in units of cycle mode"),t(m,{variant:"caption",color:"error"},this.state.errors.CycleLength))),t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"Plan Cycle"),t("div",{className:this.props.classes.itemData},t(Jr,{fullWidth:!0,disabled:!this.state.editMode,value:this.state.paymentPlanSetting.CycleMode,options:ai,onChange:function(t){return e.updatePaymentPlanSetting("CycleMode",t)}}),t(m,{variant:"caption"},"Cycles mode is used to define period of recurring payments. Can be day, week, month or custom"))),t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"Max Cycles*"),t("div",{className:this.props.classes.itemData},t(h,{fullWidth:!0,variant:"outlined",disabled:!this.state.editMode,required:!0,type:"number",value:this.state.paymentPlanSetting.MaxCyclesCount,onChange:function(t){var r=Number(t.target.value);isNaN(r)||e.updatePaymentPlanSetting("MaxCyclesCount",r)}}),t(m,{variant:"caption"},"Number of maximum cycles to process"),t(m,{variant:"caption",color:"error"},this.state.errors.MaxCyclesCount))),t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"Start Date"),t("div",{className:this.props.classes.itemData},t(W,{clearable:!0,fullWidth:!0,variant:"outlined",format:this.datetimeFormat,disabled:!this.state.editMode,value:null==this.state.paymentPlanSetting.StartDate?null:ot(this.state.paymentPlanSetting.StartDate),onChange:function(t){return e.updatePaymentPlanSetting("StartDate",null==t?null:t.toDate())},className:this.props.classes.itemData}),t(m,{variant:"caption"},"Plan start date"),t(m,{variant:"caption",color:"error"},this.state.errors.StartDate))),t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"End Date"),t("div",{className:this.props.classes.itemData},t(W,{clearable:!0,fullWidth:!0,variant:"outlined",format:this.datetimeFormat,disabled:!this.state.editMode,value:null==this.state.paymentPlanSetting.EndDate?null:ot(this.state.paymentPlanSetting.EndDate),onChange:function(t){return e.updatePaymentPlanSetting("EndDate",null==t?null:t.toDate())}}),t(m,{variant:"caption"},"Plan end date"),t(m,{variant:"caption",color:"error"},this.state.errors.EndDate))),t($,{item:!0,className:this.props.classes.rowData},t(m,{className:this.props.classes.itemLabel},"Is Active"),t(ue,{disabled:!this.state.editMode,checked:this.state.paymentPlanSetting.IsActive,onChange:function(t){return e.updatePaymentPlanSetting("IsActive",t.target.checked)}}))),this.isEditable()&&t($,{container:!0,spacing:8},!this.state.editMode&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.setState({editMode:!0})}},"Edit")),this.state.editMode&&t($,{item:!0},t(se,{outlined:!0,onClick:this.cancelEdit},"Cancel")),this.state.editMode&&t($,{item:!0},t(se,{outlined:!0,onClick:this.saveChange},"Save"))))},n}(n),ci=p((function(e){var t=e.spacing;return c({pageItem:{padding:1*t.unit},rowData:{width:"100%",cellPadding:1*t.unit,display:"flex",alignItems:"flex-start"},itemLabel:{padding:1*t.unit,width:"200px",display:"inline-block",fontSize:14},itemData:{width:"400px",display:"inline-block",fontSize:14}})}))(u((function(e,t){return{paymentPlan:t.paymentPlan,editMode:t.editMode,createMode:t.createMode,validator:t.validator,paymentPlanSetting:e.orderGroup.paymentPlanSetting,classes:t.classes}}))(di)),pi=z((function(e){e.palette,e.spacing,e.breakpoints;return c({})}))(u((function(e,t){var r=e.orderGroup.currentOrderGroup;return{lineItemDeleteConfirmationIsVisible:e.application.lineItemDeleteConfirmationIsVisible,currentLineItemId:e.orderGroup.currentLineItemId,currentOrderGroupId:r.OrderGroupId,orderGroupType:r.Type,listedOrderGroups:e.orderGroup.listedOrderGroups,classes:t.classes}}))((function(e){var r=function(){e.dispatch(fr.ApplicationActions.closeDeleteLineItemConfirmationView())};return t("div",null,t(te,{open:e.lineItemDeleteConfirmationIsVisible,maxWidth:"sm",fullWidth:!0,onClose:r},t(Ct,null,"Remove line item"),t(ne,null,t(St,null,"This will remove the line item from the cart. This operation cannot be undone."),t(re,null,t(se,{onClick:r},"Cancel"),t(se,{unelevated:!0,onClick:function(){return Wt(void 0,void 0,void 0,(function(){var t,n,s;return qt(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,ln.OrderGroup.deleteLineItem(e.orderGroupType,e.currentOrderGroupId,e.currentLineItemId)];case 1:return(t=i.sent())&&t.data&&Array.isArray(t.data)&&t.data.length>0&&e.dispatch(fr.ApplicationActions.showNotification(t.data)),[4,ln.OrderGroup.getSingleOrderGroup(e.orderGroupType,e.currentOrderGroupId)];case 2:return n=i.sent(),e.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(n)),r(),[3,4];case 3:return s=i.sent(),e.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,4];case 4:return[2]}}))}))}},"Remove")))))})));function li(e){return!!e&&(e.OrderStatus===oi.Cancelled||e.OrderStatus===oi.Completed||e.OrderStatus===oi.OnHold)}function hi(e){var t=!1;if(e&&Array.isArray(e.Forms)&&e.Forms.length>0){var r=e.Forms[0];if(Array.isArray(r.Shipments)&&r.Shipments.length>0)for(var n=0;n<r.Shipments.length;n++)if(Array.isArray(r.Shipments[n].LineItems)&&r.Shipments[n].LineItems.length>0){t=!0;break}}return t}function mi(e){if(!(e&&Array.isArray(e.Forms)&&e.Forms.length>0))return!1;var t=e.Forms[0];if(!(Array.isArray(t.Shipments)&&t.Shipments.length>0))return!1;var r=t.Shipments[0];return!!(Array.isArray(r.LineItems)&&r.LineItems.length>0)&&(!!r.ShippingAddress&&!(!r.ShippingMethodId||"00000000-0000-0000-0000-000000000000"===r.ShippingMethodId))}!function(e){e.OrderNumber="OrderNumber",e.CustomerName="CustomerName",e.Email="Email"}(ii||(ii={}));var fi,gi=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={orderDialog:{isOpen:!1,title:"",message:"",closeButtonLabel:"",confirmButtonLabel:"",onConfirm:function(){return null}}},t.goToOriginalOrder=function(){return Wt(t,void 0,void 0,(function(){return qt(this,(function(e){return as.push(Er+"/"+this.props.orderGroup.ParentOrderId),[2]}))}))},t}return Vt(r,e),r.prototype.updateOrderStatus=function(e){return Wt(this,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,ln.OrderGroup.updateOrderStatus(this.props.orderGroup.OrderGroupId,e)];case 1:return n.sent(),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 2:return t=n.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(t)),[3,4];case 3:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,4];case 4:return this.closeOrderDialog(),[2]}}))}))},r.prototype.closeOrderDialog=function(){this.setState({orderDialog:{isOpen:!1}})},r.prototype.showCancelConfirmDialog=function(){var e=this;this.setState({orderDialog:{isOpen:!0,title:"Cancel Order",message:"Are you sure you want to cancel this order?",closeButtonLabel:"Close",confirmButtonLabel:"Cancel Order",onConfirm:function(){return e.updateOrderStatus(oi.Cancelled)}}})},r.prototype.canShowHoldButton=function(){return this.props.orderGroup.OrderStatus===oi.InProgress||this.props.orderGroup.OrderStatus===oi.PartiallyShipped},r.prototype.canShowCancelButton=function(){return this.props.orderGroup.OrderStatus===oi.InProgress},r.prototype.canShowReleaseHoldButton=function(){return this.props.orderGroup.OrderStatus===oi.OnHold},r.prototype.render=function(){var e=this;return t("div",null,t($,{container:!0,justify:"flex-end",spacing:8},this.props.orderGroup.IsExchangeOrder&&t($,{item:!0},t(se,{outlined:!0,onClick:this.goToOriginalOrder},"Go to original order")),this.canShowHoldButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.updateOrderStatus(oi.OnHold)}},"Hold")),this.canShowReleaseHoldButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.updateOrderStatus(oi.InProgress)}},"Release OnHold")),this.canShowCancelButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.showCancelConfirmDialog()}},"Cancel Order"))),this.state.orderDialog.isOpen&&t(Sn,{title:this.state.orderDialog.title,closeButtonLabel:this.state.orderDialog.closeButtonLabel,confirmButtonLabel:this.state.orderDialog.confirmButtonLabel,onConfirm:this.state.orderDialog.onConfirm,onClose:function(){return e.setState({orderDialog:{isOpen:!1}})}},t(m,{variant:"body1"},this.state.orderDialog.message)))},r}(n),yi=u((function(e){return{orderGroup:e.orderGroup.currentOrderGroup}}))(gi),vi=function(){return t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},t("path",{d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}))},Ci=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.dropdownMenuAnchor=s(),t.dropdownOpen=!1,t.openActionDropdown=function(){t.dropdownOpen=!0,t.forceUpdate()},t.handleClose=function(){t.dropdownOpen=!1,t.forceUpdate()},t}return Vt(r,e),r.prototype.render=function(){var e=this;return t("div",{className:"action-dropdown__container"},t("div",{className:"action-dropdown__anchor-icon mdc-ripple-surface",onClick:function(t){window.document.getElementsByTagName("body")[0].click(),t.stopPropagation(),e.openActionDropdown()},ref:this.dropdownMenuAnchor,"data-mdc-ripple-is-unbounded":!0},t(vi,null)),t(ce,{anchorElement:this.dropdownMenuAnchor.current,anchorCorner:1,open:this.dropdownOpen,onClose:function(){return e.handleClose()},className:"epi-table-action-dropdown"},t(pe,null,this.props.actions.map((function(r,n){return t(le,{style:{cursor:"pointer"},key:n,onClick:function(t){t.stopPropagation(),e.handleClose(),r.clickHandler&&r.clickHandler(e.props.rowData,e.props.rowIndex)}},r.title)})))))},r}(n);!function(e){e.Complete="Complete",e.Canceled="Canceled",e.AwaitingStockReturn="AwaitingStockReturn",e.AwaitingCompletion="AwaitingCompletion"}(fi||(fi={}));var Si,Ii=fi,bi=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.state={isLoadingResource:!0,returnForms:[],confirmDialog:{isOpen:!1,title:"",message:"",closeButtonLabel:"",confirmButtonLabel:"",onConfirm:function(){return null}},contextActionItems:Array()},r.tableInstance={},r.columns=[{name:"RETURN NO.",selector:"RMANumber"},{name:"CREATED DATE",selector:"Created",render:function(e){return ot(e.Created).format("LLL")}},{name:"CREATED BY",selector:"Customer",render:function(e){return e.Customer.FullName}},{name:"STATUS",selector:"Status",render:function(e){return e.Status.Name}},{name:"RETURN TOTAL",selector:"Total",right:!0,render:function(e){return t(Rs,{amount:e.Total})}},{name:"",width:10,render:function(e,n){var s=[];return s.push({title:r.isReturnEditable(e)?"Edit":"View",clickHandler:function(t){r.goToDetail(e)}}),e.Status.Code!==Ii.AwaitingStockReturn&&e.Status.Code!==Ii.AwaitingCompletion||s.push({title:"Cancel",clickHandler:function(t){r.showCancelConfirmDialog(e.FormId)}}),e.Status.Code===Ii.AwaitingStockReturn&&s.push({title:"Acknowledge Receipt Items",clickHandler:function(t){r.showAcknowledgeReceiptItemsConfirmDialog(e.FormId)}}),t(Ci,{actions:s,rowData:e,rowIndex:n})}}],r}return Vt(r,e),r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.loadReturns()];case 1:return e.sent(),[2]}}))}))},r.prototype.loadReturns=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:this.setState({isLoadingResource:!0}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ln.OrderGroup.getReturns(this.props.orderGroupId)];case 2:return e=r.sent(),this.setState({returnForms:e.Results}),[3,4];case 3:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,4];case 4:return this.setState({isLoadingResource:!1}),[2]}}))}))},r.prototype.goToDetail=function(e){as.push(Er+"/"+this.props.orderGroupId+"/returns/"+e.FormId)},r.prototype.closeDialog=function(){this.setState({confirmDialog:{isOpen:!1}})},r.prototype.cancelReturn=function(e){return Wt(this,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,ln.OrderGroup.cancelReturn(this.props.orderGroupId,e)];case 1:return r.sent(),[4,this.loadReturns()];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,4];case 4:return this.closeDialog(),[2]}}))}))},r.prototype.showCancelConfirmDialog=function(e){var t=this;this.setState({confirmDialog:{isOpen:!0,title:"Cancel Return",message:"Are you sure you want to cancel this return?",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:function(){return t.cancelReturn(e)}}})},r.prototype.updateAcknowledgeReceiptItems=function(e){return Wt(this,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,ln.OrderGroup.acknowledgeReceiptItems(this.props.orderGroupId,e)];case 1:return r.sent(),[4,this.loadReturns()];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,4];case 4:return this.closeDialog(),[2]}}))}))},r.prototype.showAcknowledgeReceiptItemsConfirmDialog=function(e){var t=this;this.setState({confirmDialog:{isOpen:!0,title:"Acknowledge Receipt Items",message:"Are you sure you want to acknowledge receipt items?",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:function(){return t.updateAcknowledgeReceiptItems(e)}}})},r.prototype.isReturnEditable=function(e){return e.Status.Code===Ii.AwaitingStockReturn},r.prototype.showConfirmReturnBatch=function(e){var t=this;this.setState({confirmDialog:{isOpen:!0,title:"Cancel Return(s)",message:"Are you sure you want to cancel return(s)?",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:function(){return Wt(t,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return[4,this.cancelReturnBatch(e)];case 1:return t.sent(),[2]}}))}))}}})},r.prototype.cancelReturnBatch=function(e){return Wt(this,void 0,void 0,(function(){var t,r,n,s;return qt(this,(function(i){switch(i.label){case 0:i.trys.push([0,6,,7]),t=0,r=e,i.label=1;case 1:return t<r.length?(n=r[t],[4,ln.OrderGroup.cancelReturn(this.props.orderGroupId,n.FormId)]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[4,this.loadReturns()];case 5:return i.sent(),[3,7];case 6:return s=i.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,7];case 7:return this.closeDialog(),[2]}}))}))},r.prototype.updateBatchAcknowledgeReceiptItems=function(e){return Wt(this,void 0,void 0,(function(){var t,r,n,s;return qt(this,(function(i){switch(i.label){case 0:i.trys.push([0,6,,7]),t=0,r=e,i.label=1;case 1:return t<r.length?(n=r[t],[4,ln.OrderGroup.acknowledgeReceiptItems(this.props.orderGroupId,n.FormId)]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[4,this.loadReturns()];case 5:return i.sent(),[3,7];case 6:return s=i.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,7];case 7:return this.closeDialog(),[2]}}))}))},r.prototype.showBatchAcknowledgeReceiptItemsConfirmDialog=function(e){var t=this;this.setState({confirmDialog:{isOpen:!0,title:"Acknowledge Receipt Items",message:"Are you sure you want to acknowledge receipt items?",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:function(){return t.updateBatchAcknowledgeReceiptItems(e)}}})},r.prototype.onRowSelected=function(){var e=this,t=[],r=!0,n=!0,s=this.tableInstance.getSelectedRows();0===s.length&&(r=!1,n=!1),s.filter((function(e){return e.Status.Code!==Ii.AwaitingStockReturn&&e.Status.Code!==Ii.AwaitingCompletion})).length>0&&(r=!1),s.filter((function(e){return e.Status.Code!==Ii.AwaitingStockReturn})).length>0&&(n=!1),r&&t.push({title:"Cancel Return(s)",clickHandler:function(){e.showConfirmReturnBatch(s)}}),n&&t.push({title:"Acknowledge Receipt Items",clickHandler:function(){e.showBatchAcknowledgeReceiptItemsConfirmDialog(s)}}),this.setState({contextActionItems:t})},r.prototype.render=function(){var e=this;return t("div",null,!this.state.isLoadingResource&&t(Us,{columns:this.columns,selectableRows:!0,onRowSelected:function(){return e.onRowSelected()},onHeaderRowSelected:function(){return e.onRowSelected()},contextActions:this.state.contextActionItems,data:this.state.returnForms,toolbar:{},tableInstance:this.tableInstance}),t(Cn,{open:this.state.confirmDialog.isOpen,title:this.state.confirmDialog.title,closeLabel:this.state.confirmDialog.closeButtonLabel,okLabel:this.state.confirmDialog.confirmButtonLabel,onOK:this.state.confirmDialog.onConfirm,onClose:function(){return e.closeDialog()}},t(We,{variant:"body1"},this.state.confirmDialog.message)))},r}(n),Ai=u((function(e,t){return Bt({},t)}))(bi),Oi=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.state={listedOrderGroups:Array()},r.columns=[{name:"No.",render:function(e){return t(We,null,"Order"===e.Type?e.OrderNumber:"# "+e.OrderGroupId)}},{name:"Created Date",render:function(e){return t(We,null,e.Created&&ot(e.Created).format("LLL"))}},{name:"Amount",right:!0,render:function(e){return t(Rs,{amount:e.Total})}},{name:"Status",render:function(e){return t(We,null,Qs(e.OrderStatus))}},{width:50,render:function(e,n){return t(Ci,{actions:[{title:"View",clickHandler:function(t){r.goToDetail(e.OrderGroupId)}}],rowData:e,rowIndex:n})}}],r}return Vt(r,e),r.prototype.componentDidMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){return this.loadOrderGroups(),[2]}))}))},r.prototype.loadOrderGroups=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return e=this.props.paymentPlan.OrderGroupId,[4,ln.PaymentPlan.getPurchaseOrders(e,0,500)];case 1:return t=r.sent(),this.setState({listedOrderGroups:t.Results}),[2]}}))}))},r.prototype.goToDetail=function(e){as.push(Er+"/"+e+"?returnUrl="+cs())},r.prototype.render=function(){return t("div",null,t(We,{variant:"h6"},"Orders History"),t("br",null),t(Us,{columns:this.columns,data:this.state.listedOrderGroups}))},r}(n);!function(e){e.AwaitingInventory="AwaitingInventory",e.Cancelled="Cancelled",e.InventoryAssigned="InventoryAssigned",e.OnHold="OnHold",e.Packing="Packing",e.Released="Released",e.Shipped="Shipped"}(Si||(Si={}));var wi,Ti=Si,Di=function(e){function r(t){var r=e.call(this,t)||this;r.state={updateCustomerAddress:!1,loaded:!1,existCustomerAddress:!1,addToAddressBook:!1,customerAddressId:""},r.validator={validate:function(){return null}},r.setCurrentAddress=function(e){r.props.dispatch(fr.ContactActions.setCurrentAddress(e)),r.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!0))},r.handleFormChanges=function(e){var t=Object.assign({},r.props.address),n="checkbox"===e.target.type?e.target.checked:e.target.value;t[e.target.name]=n,r.setCurrentAddress(t)},r.saveChanges=function(){return Wt(r,void 0,void 0,(function(){var e,t,r,n,s,i,o,a,u,d=this;return qt(this,(function(c){switch(c.label){case 0:if(null==(e=this.validator.validate()))return[2];t=Bt(Bt({},this.props.address),e),c.label=1;case 1:return c.trys.push([1,20,,21]),(r=this.props.orderGroup).IsDraft?(r.Forms[0].Shipments[0].ShippingAddress=Bt({},t),[4,ln.OrderGroup.calculateOrder(r)]):[3,9];case 2:return n=c.sent(),i=n.Forms[0].Shipments[0].ShippingAddress,this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(n)),this.props.editMode?this.state.updateCustomerAddress?[4,this.updateContactAddress()]:[3,4]:[3,5];case 3:c.sent(),c.label=4;case 4:return this.props.onAddressChanged(i),[3,8];case 5:return this.state.addToAddressBook?[4,this.addContactAddress()]:[3,7];case 6:c.sent(),c.label=7;case 7:this.props.onAddressCreated(i),c.label=8;case 8:return[3,19];case 9:return this.props.editMode?this.state.updateCustomerAddress?[4,this.updateContactAddress()]:[3,11]:[3,14];case 10:c.sent(),c.label=11;case 11:return[4,ln.OrderGroup.updateShippingAddress(r.Type,r.OrderGroupId,r.Forms[0].OrderFormId,this.props.shipment.ShipmentId,t)];case 12:return c.sent(),[4,ln.OrderGroup.getSingleOrderGroup(r.Type,r.OrderGroupId)];case 13:return o=c.sent(),s=o.Forms[0].Shipments.findIndex((function(e){return e.ShipmentId===d.props.shipment.ShipmentId})),i=o.Forms[0].Shipments[s].ShippingAddress,this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(o)),this.props.onAddressChanged(i),[3,19];case 14:return this.state.addToAddressBook?[4,this.addContactAddress()]:[3,16];case 15:c.sent(),c.label=16;case 16:return[4,ln.OrderGroup.addShippingAddress(r.Type,r.OrderGroupId,r.Forms[0].OrderFormId,this.props.shipment.ShipmentId,t)];case 17:return c.sent(),[4,ln.OrderGroup.getSingleOrderGroup(r.Type,r.OrderGroupId)];case 18:o=c.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(o)),(a=o.Forms[0].Shipments.find((function(e){return d.props.shipment.ShipmentId===e.ShipmentId})))&&this.props.onAddressCreated(a.ShippingAddress),c.label=19;case 19:return this.props.onClose(),[3,21];case 20:return u=c.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(u.message)),[3,21];case 21:return[2]}}))}))},r.updateContactAddress=function(){return Wt(r,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=Bt({},this.props.address),this.state.customerAddressId&&(e.AddressId=this.state.customerAddressId),[4,ln.Contact.updateContactAddress(this.props.orderGroup.Customer.Id,e.AddressId,e)];case 1:return t.sent(),[2]}}))}))},r.addContactAddress=function(){return Wt(r,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,ln.Contact.addContactAddress(this.props.orderGroup.Customer.Id,this.props.address)];case 1:return e.sent(),[2]}}))}))};var n=r.props.orderGroup.Customer.Addresses.find((function(e){return e.Name+e.DisplayName===r.props.address.Name+r.props.address.DisplayName}));return n&&(r.state.customerAddressId=n.AddressId,r.state.existCustomerAddress=!0,r.state.updateCustomerAddress=!0),r}return Vt(r,e),r.prototype.componentDidMount=function(){this.setState({loaded:!0})},r.prototype.render=function(){var e=this;return t(Cn,{open:!0,title:this.props.editMode?"Edit Address":"Add New Address",okLabel:"Save",onOK:this.saveChanges,closeLabel:"Cancel",onClose:this.props.onClose},this.state.loaded&&t(l,{container:!0,spacing:16},t(l,{item:!0,sm:12},t(On,{address:this.props.address,validator:this.validator})),!this.props.orderGroup.Customer.IsAnonymous&&t(l,{item:!0,sm:12},this.props.editMode&&this.state.existCustomerAddress&&t(C,{control:t(ue,{name:"UpdateCustomerAddress",checked:this.state.updateCustomerAddress,onChange:function(t){e.setState({updateCustomerAddress:t.target.checked})}}),label:"Also update customer's address"}),!this.props.editMode&&t(C,{control:t(ue,{name:"AddToAddressBook",checked:this.state.addToAddressBook,onChange:function(t){e.setState({addToAddressBook:t.target.checked})}}),label:"Add to customer's address book"}))))},r}(n),Pi=u((function(e,t){return{address:e.contact.currentAddress,orderGroup:e.orderGroup.currentOrderGroup,editMode:t.editMode,shipment:t.shipment,onClose:t.onClose,onAddressChanged:t.onAddressChanged,onAddressCreated:t.onAddressCreated}}))(Di),Gi=function(e){function r(t){var r,n=e.call(this,t)||this;return n.shipmentForm={},n.shippingMethodRefreshCount=0,n.loadShippingMethods=function(e){return Wt(n,void 0,Promise,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return[4,ln.Shipment.getShippingMethods(this.props.orderGroup.MarketId,e)];case 1:return t=r.sent(),this.setState({shippingMethods:t}),[2,t]}}))}))},n.customPropertyChangedHandler=function(e){return Wt(n,void 0,void 0,(function(){var t;return qt(this,(function(r){return(t=this.state.properties.findIndex((function(t){return t.Name===e.Name})))>=0&&(this.state.properties[t]=Bt({},e),this.setState({properties:jt(this.state.properties)}),this.forceUpdate()),[2]}))}))},n.handleAddressChange=function(e){return Wt(n,void 0,void 0,(function(){var t,r,n=this;return qt(this,(function(s){switch(s.label){case 0:return this.setState({addressId:e}),(t=this.props.orderGroup.OrderAddresses.find((function(t){return t.AddressId===e})))?[4,this.loadShippingMethods(t.CountryCode)]:(this.props.dispatch(fr.ApplicationActions.showNotification("AddressData not found")),[2]);case 1:return(r=s.sent()).length>0&&void 0===r.find((function(e){return e.ShippingMethodId===n.state.shippingMethodId}))&&this.setState({shippingMethodId:r[0].ShippingMethodId}),0===r.length&&this.setState({shippingMethodId:""}),[2]}}))}))},n.openEditAddressDialog=function(){var e=n.props.orderGroup.OrderAddresses.find((function(e){return e.AddressId===n.state.addressId}));e&&(n.props.dispatch(fr.ContactActions.setCurrentAddress(e)),n.setState({isShowAddressForm:!0,orderAddressEditMode:!0}))},n.openAddAddressDialog=function(){n.props.dispatch(fr.ContactActions.setCurrentAddress({})),n.setState({isShowAddressForm:!0,orderAddressEditMode:!1})},n.onAddressChanged=function(e){return Wt(n,void 0,void 0,(function(){return qt(this,(function(t){return this.props.orderGroup.IsDraft&&this.setState({shipment:Bt(Bt({},this.state.shipment),{ShippingAddress:e})}),this.setState({addressId:e.AddressId}),[2]}))}))},n.onAddressCreated=function(e){return Wt(n,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return this.props.orderGroup.IsDraft&&this.setState({shipment:Bt(Bt({},this.state.shipment),{ShippingAddress:e})}),[4,this.handleAddressChange(e.AddressId)];case 1:return t.sent(),[2]}}))}))},n.state={shippingAddressDropdownIsExpanded:!1,shippingAddressFormVisible:!1,shippingMethodId:n.props.shipment.ShippingMethodId,addressId:(null===(r=n.props.shipment.ShippingAddress)||void 0===r?void 0:r.AddressId)||"",trackingNumber:n.props.shipment.ShipmentTrackingNumber,loaded:!1,errorMessage:"",shipment:JSON.parse(JSON.stringify(n.props.shipment)),selectedAddress:t.shipment.ShippingAddress,properties:jt(t.shipment.Properties),shippingMethods:[],isShowAddressForm:!1,orderAddressEditMode:!0},n}return Vt(r,e),r.prototype.componentWillReceiveProps=function(e){var t,r,n,s;return Wt(this,void 0,void 0,(function(){return qt(this,(function(i){return(null===(t=e.shipment.ShippingAddress)||void 0===t?void 0:t.AddressId)===(null===(r=this.props.shipment.ShippingAddress)||void 0===r?void 0:r.AddressId)&&(null===(n=e.shipment.ShippingAddress)||void 0===n?void 0:n.AddressId)!==this.state.addressId&&this.setState({addressId:(null===(s=e.shipment.ShippingAddress)||void 0===s?void 0:s.AddressId)||""}),[2]}))}))},r.prototype.componentDidMount=function(){var e;return Wt(this,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return this.setState({loaded:!0}),[4,this.loadShippingMethods(null===(e=this.state.selectedAddress)||void 0===e?void 0:e.CountryCode)];case 1:return t.sent(),[2]}}))}))},r.prototype.updateShipmentTrackingNumber=function(e){return Wt(this,void 0,void 0,(function(){var t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ln.Shipment.updateShipmentTrackingNumber(this.props.orderGroup.OrderGroupId,this.props.orderFormId,this.props.shipment.ShipmentId,e)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,3];case 3:return[2]}}))}))},r.prototype.setDropdownIsExpanded=function(){this.setState({shippingAddressDropdownIsExpanded:!this.state.shippingAddressDropdownIsExpanded})},r.prototype.changeShippingMethodHandler=function(e){this.setState({shippingMethodId:e})},r.prototype.changeTrackingNumber=function(e){this.setState({trackingNumber:e})},r.prototype.validateForm=function(){var e="";return this.state.shippingMethodId&&"00000000-0000-0000-0000-000000000000"!==this.state.shippingMethodId||(e="Shipping Method is required."),this.state.addressId||(e="Shipping Address is required."),this.setState({errorMessage:e}),e},r.prototype.updateShipmentProperties=function(){return Wt(this,void 0,void 0,(function(){var e,t,r;return qt(this,(function(n){switch(n.label){case 0:if(this.props.orderGroup.IsDraft)return this.setState({shipment:Bt(Bt({},this.state.shipment),{Properties:this.state.properties})}),[2];e=0,n.label=1;case 1:if(!(e<this.props.shipment.Properties.length))return[3,6];if(t=this.props.shipment.Properties[e],this.state.properties[e].Value===t.Value)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,ln.MetaField.updateOrderShipmentMetaFields(this.props.orderGroup.OrderGroupId,this.props.orderGroup.Type,this.props.shipment.ShipmentId,this.state.properties[e])];case 3:return n.sent(),[3,5];case 4:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},r.prototype.saveForm=function(){var e;return Wt(this,void 0,void 0,(function(){var t,r,n,s,i,o=this;return qt(this,(function(a){switch(a.label){case 0:return this.shipmentForm.isFormValid()?""!==this.validateForm()?[2]:[4,this.updateShipmentProperties()]:[2];case 1:return a.sent(),this.state.addressId===(null===(e=this.props.shipment.ShippingAddress)||void 0===e?void 0:e.AddressId)?[3,5]:(t=this.props.orderGroup.OrderAddresses.find((function(e){return e.AddressId===o.state.addressId})))?this.props.orderGroup.IsDraft?(this.setState({shipment:Bt(Bt({},this.state.shipment),{ShippingAddress:t})}),[3,5]):[3,2]:(this.props.dispatch(fr.ApplicationActions.showNotification("AddressData not found")),[2]);case 2:return a.trys.push([2,4,,5]),[4,ln.OrderGroup.updateShippingAddress(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId,this.props.orderFormId,this.props.shipment.ShipmentId,t)];case 3:return a.sent(),[3,5];case 4:return r=a.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,5];case 5:return this.props.shipment.ShippingMethodId===this.state.shippingMethodId?[3,9]:this.props.orderGroup.IsDraft?(this.setState({shipment:Bt(Bt({},this.state.shipment),{ShippingMethodId:this.state.shippingMethodId})}),[3,9]):[3,6];case 6:return a.trys.push([6,8,,9]),[4,ln.OrderGroup.updateShippingMethod(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId,this.props.orderFormId,this.props.shipment.ShipmentId,this.state.shippingMethodId)];case 7:return a.sent(),[3,9];case 8:return n=a.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,9];case 9:return this.props.orderGroup.IsDraft?((s=JSON.parse(JSON.stringify(this.props.orderGroup))).Forms[0].Shipments[0]=this.state.shipment,[4,ln.OrderGroup.calculateOrder(s)]):[3,11];case 10:return s=a.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(s)),[3,15];case 11:return this.state.trackingNumber===this.props.shipment.ShipmentTrackingNumber?[3,13]:[4,this.updateShipmentTrackingNumber(this.state.trackingNumber)];case 12:a.sent(),a.label=13;case 13:return[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 14:i=a.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(i)),a.label=15;case 15:return this.props.onClose(),[2]}}))}))},r.prototype.isEditable=function(){var e=this.props.shipment.OrderShipmentStatus.Name;return[Ti.AwaitingInventory,Ti.InventoryAssigned,Ti.Released,Ti.Packing].indexOf(e)>=0},r.prototype.render=function(){var e,r,n=this,s={title:this.isEditable()?"Edit Shipment":"View Shipment",open:!0,onClose:function(){n.props.onClose()}};this.isEditable()&&(s.onOK=function(){return Wt(n,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.saveForm()];case 1:return e.sent(),[2]}}))}))},s.okLabel="Save");var i=this.props.orderGroup.OrderAddresses.map((function(e,t){return{label:e.DisplayName,value:e.AddressId}})),o=this.state.shippingMethods.map((function(e){return{label:e.DisplayName,value:e.ShippingMethodId}})),a=null===(e=this.props.extendUI)||void 0===e?void 0:e.topPlaceHolder,u=null===(r=this.props.extendUI)||void 0===r?void 0:r.bottomPlaceHolder;return t(Cn,Bt({},s),this.state.loaded&&t("div",null,a&&t(a,null),t(Ee,{instantValidate:!0,onSubmit:function(){return null},ref:function(e){return n.shipmentForm=e}},t(l,{container:!0,spacing:16,direction:"row"},t(l,{item:!0,sm:12},t("span",{style:{color:"red"}},this.state.errorMessage)),t(l,{item:!0,sm:12},t(Jr,{label:"Choose Shipping Address *",fullWidth:!0,value:this.state.addressId,onChange:function(e){return n.handleAddressChange(e)},disabled:!this.isEditable(),options:i}),this.isEditable()&&t(l,{container:!0,spacing:16,justify:"flex-end"},t(l,{item:!0},t(m,{variant:"subtitle1",color:"primary",onClick:this.openAddAddressDialog,style:{cursor:"pointer",fontSize:"13px"}},"Add Address")),this.state.addressId&&t(l,{item:!0},t(m,{variant:"subtitle1",color:"primary",onClick:this.openEditAddressDialog,style:{cursor:"pointer",fontSize:"13px"}},"Edit Address")))),t(l,{item:!0,sm:12},t(Jr,{fullWidth:!0,key:this.shippingMethodRefreshCount++,disabled:!this.isEditable(),label:"Choose Shipping Method *",value:this.state.shippingMethodId,onChange:function(e){return n.changeShippingMethodHandler(e)},options:o})),t(l,{item:!0,sm:12},"Order"===this.props.orderGroup.Type&&t(h,{label:"Tracking number",variant:"outlined",value:this.state.trackingNumber,fullWidth:!0,onChange:function(e){return n.changeTrackingNumber(e.currentTarget.value)},disabled:this.props.shipment.OrderShipmentStatus.Name!==Ti.Packing})),this.props.properties&&this.props.properties.map((function(e,r){return t(l,{item:!0,sm:12,key:r},t(js,{key:r,property:e,isReadonly:!e.IsEditable,onPropertyChanged:n.customPropertyChangedHandler}))})))),u&&t(u,null)),this.state.isShowAddressForm&&t(Pi,{onClose:function(){return n.setState({isShowAddressForm:!1})},editMode:this.state.orderAddressEditMode,shipment:this.state.shipment,onAddressChanged:this.onAddressChanged,onAddressCreated:this.onAddressCreated}))},r}(n),Ni=u((function(e,t){var r,n,s=t.shipment,i=e.orderGroup.currentOrderGroup;return{shipment:s,orderFormId:i.Forms[e.orderGroup.selectedFormIndex].OrderFormId,orderGroup:i,createOrderAddressFormIsVisible:e.createOrderAddressForm.isVisible,properties:s.Properties,shipmentStatusUpdateDialogVisible:e.application.currentDialog===zt.UpdateShipmentStatus,customerAddresses:jt(i.Customer.Addresses),onClose:t.onClose,extendUI:null===(n=null===(r=e.setting.general)||void 0===r?void 0:r.editShipmentDialog)||void 0===n?void 0:n.extendUI}}))(Gi),Ri=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.state={shipmentDialogOpen:!1,currentShipmentIndex:0,shipmentDialog:{isOpen:!1,title:"",message:"",closeButtonLabel:"",confirmButtonLabel:"",onConfirm:function(){return null}}},r.columns=[{name:"No",right:!0,render:function(e,t){return t+1}},{name:"Recipient Name",render:function(e){var t="";return e.ShippingAddress&&(t=[e.ShippingAddress.FirstName,e.ShippingAddress.LastName].filter((function(e){return e})).join(" ")),t}},{name:"Shipping Address",render:function(e){return e.ShippingAddress?e.ShippingAddress.DisplayName:null}},{name:"Shipping Method",render:function(e){return r.getShippingMethodName(e.ShippingMethodId)}},{name:"Tracking No",selector:"ShipmentTrackingNumber"},{name:"Shipment Status",render:function(e){return Qs(e.OrderShipmentStatus.Name)}},{name:"Shipping Cost",right:!0,render:function(e){return e.ShippingCost.Amount.toFixed(e.ShippingCost.Fractions)}},{name:"Shipping Tax",right:!0,render:function(e){return e.ShippingTax.Amount.toFixed(e.ShippingTax.Fractions)}},{name:"Total (Incl tax)",right:!0,render:function(e){return e.ShipmentTotal.Amount.toFixed(e.ShipmentTotal.Fractions)+" "+e.ShipmentTotal.Currency}},{name:"",width:50,hideOnColumnsSelection:!0,render:function(e,n){var s=[{title:r.isEditableShipment(e)?"Edit":"View",clickHandler:function(e){r.openEditShipmentDialog(n)}}];return r.props.orderGroup.IsDraft||"Order"!==r.props.orderGroup.Type||(r.canReleaseShipment(e)&&s.push({title:"Release",clickHandler:function(e){r.showReleaseShipmentConfirmDialog(e.ShipmentId)}}),r.canShowAddToPickListButton(e)&&s.push({title:"Add to Picklist",clickHandler:function(e){r.showAddToPickListConfirmDialog(e.ShipmentId)}}),r.canShowCompleteButton(e)&&s.push({title:"Complete",clickHandler:function(e){r.showCompleteShipmentConfirmDialog(e.ShipmentId)}}),!r.props.orderGroup.IsDraft&&r.canShowCancelButton(e)&&s.push({title:"Cancel",clickHandler:function(e){r.showCancelShipmentConfirmDialog(e.ShipmentId)}})),t(Ci,{actions:s,rowData:e,rowIndex:n})}}],r}return Vt(r,e),r.prototype.canReleaseShipment=function(e){return!(this.props.orderGroup.OrderStatus===oi.AwaitingExchange||!e.ShippingAddress||"00000000-0000-0000-0000-000000000000"===e.ShippingMethodId)&&this.canShowReleaseButton(e)},r.prototype.canShowReleaseButton=function(e){return e.OrderShipmentStatus.Name===Ti.AwaitingInventory||e.OrderShipmentStatus.Name===Ti.InventoryAssigned},r.prototype.canShowCompleteButton=function(e){return this.props.orderGroup.OrderStatus!==oi.AwaitingExchange&&e.OrderShipmentStatus.Name===Ti.Packing},r.prototype.canShowCancelButton=function(e){return this.props.orderGroup.OrderStatus!==oi.AwaitingExchange&&e.OrderShipmentStatus.Name!==Ti.Shipped&&e.OrderShipmentStatus.Name!==Ti.OnHold&&e.OrderShipmentStatus.Name!==Ti.Cancelled},r.prototype.canShowAddToPickListButton=function(e){return e.OrderShipmentStatus.Name===Ti.Released},r.prototype.showCancelShipmentConfirmDialog=function(e){var t=this;this.setState({shipmentDialog:{isOpen:!0,title:"Cancel Shipment",message:"Are you sure you want to cancel this shipment?",closeButtonLabel:"Close",confirmButtonLabel:"Cancel Shipment",onConfirm:function(){return t.updateShipmentStatus(e,Ti.Cancelled)}}})},r.prototype.showReleaseShipmentConfirmDialog=function(e){var t=this;this.setState({shipmentDialog:{isOpen:!0,title:"Release Shipment",message:"Are you sure you want to release this shipment?",closeButtonLabel:"Close",confirmButtonLabel:"Release Shipment",onConfirm:function(){return t.updateShipmentStatus(e,Ti.Released)}}})},r.prototype.showAddToPickListConfirmDialog=function(e){var t=this;this.setState({shipmentDialog:{isOpen:!0,title:"Add to PickList",message:"Are you sure you want to add this shipment to a new picklist?",closeButtonLabel:"Close",confirmButtonLabel:"Add to PickList",onConfirm:function(){return t.addShipmentToPickList(e)}}})},r.prototype.closeShipmentDialog=function(){this.setState({shipmentDialog:{isOpen:!1}})},r.prototype.addShipmentToPickList=function(e){return Wt(this,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:this.closeShipmentDialog(),this.props.dispatch(fr.ApplicationActions.setLoadingOverlayState(!0)),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,ln.Shipment.addToPickList(this.props.orderGroup.OrderGroupId,this.props.orderFormId,e)];case 2:return n.sent(),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 3:return t=n.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(t)),this.props.dispatch(fr.ApplicationActions.setLoadingOverlayState(!1)),[3,5];case 4:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.setLoadingOverlayState(!1)),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,5];case 5:return[2]}}))}))},r.prototype.showCompleteShipmentConfirmDialog=function(e){var t=this;this.setState({shipmentDialog:{isOpen:!0,title:"Complete Shipment",message:"Are you sure you want to complete this shipment?",closeButtonLabel:"Close",confirmButtonLabel:"Complete Shipment",onConfirm:function(){return t.updateShipmentStatus(e,Ti.Shipped)}}})},r.prototype.updateShipmentStatus=function(e,t){return Wt(this,void 0,void 0,(function(){var r,n;return qt(this,(function(s){switch(s.label){case 0:this.closeShipmentDialog(),this.props.dispatch(fr.ApplicationActions.setLoadingOverlayState(!0)),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,ln.Shipment.updateShipmentStatus(this.props.orderGroup.OrderGroupId,this.props.orderFormId,e,t)];case 2:return s.sent(),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 3:return r=s.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(r)),this.props.dispatch(fr.ApplicationActions.setLoadingOverlayState(!1)),[3,5];case 4:return n=s.sent(),this.props.dispatch(fr.ApplicationActions.setLoadingOverlayState(!1)),this.props.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,5];case 5:return[2]}}))}))},r.prototype.openEditShipmentDialog=function(e){this.setState({shipmentDialogOpen:!0,currentShipmentIndex:e})},r.prototype.isEditableShipment=function(e){var t=e.OrderShipmentStatus.Name;return!(t===Ti.Cancelled||t===Ti.OnHold||t===Ti.Shipped)},r.prototype.getShippingMethodName=function(e){var t;return null===(t=this.props.shippingMethods.filter((function(t){return t.ShippingMethodId===e}))[0])||void 0===t?void 0:t.DisplayName},r.prototype.render=function(){var e=this;return t("div",null,t(m,{variant:"h6"},"Shipments"),t("br",null),t(Us,{columns:this.columns,data:this.props.shipments}),this.state.shipmentDialogOpen&&t(Ni,{shipment:this.props.shipments[this.state.currentShipmentIndex],isShipmentReadonly:this.isEditableShipment(this.props.shipments[this.state.currentShipmentIndex]),onClose:function(){e.setState({shipmentDialogOpen:!1})}}),this.state.shipmentDialog.isOpen&&t(Sn,{title:this.state.shipmentDialog.title,closeButtonLabel:this.state.shipmentDialog.closeButtonLabel,confirmButtonLabel:this.state.shipmentDialog.confirmButtonLabel,onConfirm:this.state.shipmentDialog.onConfirm,onClose:function(){e.setState({shipmentDialog:{isOpen:!1}})}},t(m,{variant:"body1"},this.state.shipmentDialog.message)))},r}(n),Ei=z((function(e){e.palette;var t,r=e.spacing,n=e.breakpoints;return c({root:{},paper:(t={padding:2*r.unit,marginBottom:2*r.unit},t[n.down("xs")]={padding:10},t)})}))(u((function(e,t){var r=e.orderGroup.currentOrderGroup,n=r.Forms[e.orderGroup.selectedFormIndex];return{shipments:t.shipments,orderGroup:r,shippingMethods:e.shipment.shippingMethods,orderFormId:n.OrderFormId,classes:t.classes}}))(Ri)),xi=z((function(e){e.palette,e.spacing,e.breakpoints;return c({root:{"&-inline":{display:"inline-block"}}})}))((function(e){var r=e.classes;return t("div",{className:r.root+" "+(e.renderInline?r.root+"-inline":"")},t(We,{variant:"body1",color:"textSecondary"},e.message))})),Li=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={AddToAddressBook:!0},t.validator={validate:function(){return null}},t.handleCheckboxChange=function(e){t.setState({AddToAddressBook:e.target.checked})},t.saveChanges=function(){return Wt(t,void 0,void 0,(function(){var e,t,r,n,s;return qt(this,(function(i){switch(i.label){case 0:if(null==(e=this.validator.validate()))return[2];t=Bt(Bt({},this.props.address),e),i.label=1;case 1:return i.trys.push([1,8,,9]),this.state.AddToAddressBook?[4,this.props.addContactAddress(this.props.currentContactId,t)]:[3,5];case 2:return i.sent(),[4,this.props.getContact(this.props.currentContactId)];case 3:return r=i.sent(),this.props.dispatch(fr.ContactActions.setCurrentContact(r)),[4,ln.OrderGroup.getSingleOrderGroup(this.props.currentOrderGroup.Type,this.props.currentOrderGroup.OrderGroupId)];case 4:(n=i.sent()).Customer=r,this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(n)),i.label=5;case 5:return this.props.processOnAddressCreation?[4,this.props.processOnAddressCreation(t,this.props.addressType)]:[3,7];case 6:i.sent(),i.label=7;case 7:return this.props.addressType===Kt.BillingAddress&&this.props.dispatch(fr.PaymentActions.setBillingAddress(t)),this.closeDialog(),[3,9];case 8:return s=i.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,9];case 9:return[2]}}))}))},t.closeView=function(){t.props.dispatch(fr.CreateOrderAddressFormAction.hideCreateOrderAddressForm()),t.props.dispatch(fr.AddressFormActions.clearAddressForm()),t.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!1))},t}return Vt(r,e),r.prototype.closeDialog=function(){this.closeView(),this.props.onClose()},r.prototype.render=function(){var e=this;return t(f,{open:!0,"aria-describedby":"alert-dialog-description",className:this.props.classes.root,fullWidth:!0},t(Ct,null,"Add New Address"),t(ne,{id:"alert-dialog-description"},t(On,{address:this.props.address,validator:this.validator}),"Order"===this.props.currentOrderGroup.Type&&t(C,{control:t(ue,{name:"AddToAddressBook",checked:this.state.AddToAddressBook,onChange:this.handleCheckboxChange}),label:"Add to customer's address book"})),t(re,null,t(se,{onClick:function(){return e.closeDialog()}},"Cancel"),t(se,{unelevated:!0,type:"submit",onClick:this.saveChanges},"Add as ",this.props.addressType)))},r}(n),Mi=z((function(e){e.palette,e.spacing,e.breakpoints;return c({root:{}})}))(u((function(e,t){var r=e.orderGroup.currentOrderGroup;return{addContactAddress:ln.Contact.addContactAddress,address:e.contact.currentAddress,currentContactId:e.contact.currentContact.Id,currentOrderGroup:r,addressType:e.createOrderAddressForm.addressType,classes:t.classes,getContact:ln.Contact.get,onClose:t.onClose,processOnAddressCreation:t.processOnAddressCreation}}))(Li)),Fi=function(e){function r(t){var r=e.call(this,t)||this;r.state={updateCustomerAddress:!1,loaded:!1,existCustomerAddress:!1,addToAddressBook:!1,customerAddressId:""},r.validator={validate:function(){return null}},r.setCurrentAddress=function(e){r.props.dispatch(fr.ContactActions.setCurrentAddress(e)),r.props.dispatch(fr.ApplicationActions.setIsCurrentFormDirty(!0))},r.handleFormChanges=function(e){var t=Object.assign({},r.props.address),n="checkbox"===e.target.type?e.target.checked:e.target.value;t[e.target.name]=n,r.setCurrentAddress(t)},r.saveChanges=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:if(null==this.validator.validate())return[2];r.label=1;case 1:return r.trys.push([1,10,,11]),this.props.editMode?this.state.updateCustomerAddress?[4,this.updateContactAddress()]:[3,3]:[3,5];case 2:r.sent(),r.label=3;case 3:return[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 4:return e=r.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(e)),this.props.onAddressChanged(Bt({},this.props.address)),[3,9];case 5:return this.state.addToAddressBook?[4,this.addContactAddress()]:[3,7];case 6:r.sent(),r.label=7;case 7:return[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 8:e=r.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(e)),this.props.onAddressCreated(this.props.address),r.label=9;case 9:return this.props.onClose(),[3,11];case 10:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,11];case 11:return[2]}}))}))},r.updateContactAddress=function(){return Wt(r,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return e=Bt({},this.props.address),this.state.customerAddressId&&(e.AddressId=this.state.customerAddressId),[4,ln.Contact.updateContactAddress(this.props.orderGroup.Customer.Id,e.AddressId,e)];case 1:return t.sent(),[2]}}))}))},r.addContactAddress=function(){return Wt(r,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,ln.Contact.addContactAddress(this.props.orderGroup.Customer.Id,this.props.address)];case 1:return e.sent(),[2]}}))}))};var n=r.props.orderGroup.Customer.Addresses.find((function(e){return e.Name+e.DisplayName===r.props.address.Name+r.props.address.DisplayName}));return n&&(r.state.customerAddressId=n.AddressId,r.state.existCustomerAddress=!0,r.state.updateCustomerAddress=!0),r}return Vt(r,e),r.prototype.componentDidMount=function(){this.setState({loaded:!0})},r.prototype.render=function(){var e=this;return t(Cn,{open:!0,title:this.props.editMode?"Edit Address":"Add New Address",okLabel:"Save",onOK:this.saveChanges,closeLabel:"Cancel",onClose:this.props.onClose},this.state.loaded&&t(l,{container:!0,spacing:16},t(l,{item:!0,sm:12},t(On,{address:this.props.address,validator:this.validator})),!this.props.orderGroup.Customer.IsAnonymous&&t(l,{item:!0,sm:12},this.props.editMode&&this.state.existCustomerAddress&&t(C,{control:t(ue,{name:"UpdateCustomerAddress",checked:this.state.updateCustomerAddress,onChange:function(t){e.setState({updateCustomerAddress:t.target.checked})}}),label:"Also update customer's address"}),!this.props.editMode&&t(C,{control:t(ue,{name:"AddToAddressBook",checked:this.state.addToAddressBook,onChange:function(t){e.setState({addToAddressBook:t.target.checked})}}),label:"Add to customer's address book"}))))},r}(n),ki=u((function(e,t){return{address:e.contact.currentAddress,orderGroup:e.orderGroup.currentOrderGroup,editMode:t.editMode,onClose:t.onClose,onAddressChanged:t.onAddressChanged,onAddressCreated:t.onAddressCreated}}))(Fi),_i=function(e){function r(t){var r=e.call(this,t)||this;return r.state={paymentInProcess:!1,paymentAddressFormVisible:!1,billingAddressId:"",paymentMethodId:"",selectedPayment:{},billingAddress:{},loaded:!1,errors:{BillingAddressId:"",PaymentMethodId:"",TransactionAmount:""},isShowAddressForm:!1,billingAddressEditMode:!0},r.validationSchema=Ae({BillingAddressId:Oe().required("Billing Address is required."),PaymentMethodId:Oe().required("Payment Method is required."),TransactionAmount:we().required("Transaction Amount is required.").min(0).lessThan(Number.MAX_SAFE_INTEGER,"This value is out of range.")}),r.validateForm=function(){return Wt(r,void 0,void 0,(function(){var e,t,r;return qt(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.validationSchema.validate({BillingAddressId:this.state.billingAddressId,TransactionAmount:Number(null===(r=this.state.selectedPayment.Amount)||void 0===r?void 0:r.Amount)||void 0,PaymentMethodId:this.state.paymentMethodId},{abortEarly:!1})];case 1:return n.sent(),[2,!0];case 2:return e=n.sent(),t={},e.inner.map((function(e){t[e.path]=e.message})),this.setState({errors:t}),[2,!1];case 3:return[2]}}))}))},r.addPayment=function(){return Wt(r,void 0,void 0,(function(){var e,t,r,n,s=this;return qt(this,(function(i){switch(i.label){case 0:return[4,this.validateForm()];case 1:if(!i.sent())return[2];if(this.setState({paymentInProcess:!0}),(e=this.props.orderGroup.OrderAddresses.find((function(e){return e.AddressId===s.state.billingAddressId})))||(e=this.state.billingAddress),!this.state.billingAddress)return[3,7];this.state.selectedPayment.BillingAddress=e,i.label=2;case 2:return i.trys.push([2,5,,6]),[4,ln.OrderGroup.addPayment(this.props.orderGroup.Type,this.state.selectedPayment,this.props.orderGroup.OrderGroupId,this.props.orderForm.OrderFormId)];case 3:return t=i.sent(),this.props.orderForm.Payments.push(t.data),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 4:return r=i.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(r)),this.props.onClose(),[3,6];case 5:return n=i.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,6];case 6:return[3,8];case 7:this.props.dispatch(fr.ApplicationActions.showNotification("You need to choose a billing address.")),i.label=8;case 8:return this.setState({paymentInProcess:!1}),[2]}}))}))},r.changeTransactionAmountHandler=function(e){return Wt(r,void 0,void 0,(function(){return qt(this,(function(t){return this.updatePayment(this.state.selectedPayment,"Amount",{Currency:this.state.selectedPayment.Amount.Currency,Amount:e}),[2]}))}))},r.customPropertyChangedHandler=function(e){return Wt(r,void 0,void 0,(function(){var t,r;return qt(this,(function(n){for(t=this.state.selectedPayment.Properties,r=0;r<t.length;r++)if(t[r].Id===e.Id){t[r]=e;break}return this.updatePayment(this.state.selectedPayment,"Properties",t),[2]}))}))},r.billingAddressChange=function(e){r.setState({billingAddressId:e})},r.openEditAddressDialog=function(){var e=r.props.orderGroup.OrderAddresses.find((function(e){return e.AddressId===r.state.billingAddressId}));e||(e=r.state.billingAddress),e&&(r.props.dispatch(fr.ContactActions.setCurrentAddress(e)),r.setState({isShowAddressForm:!0,billingAddressEditMode:!0,billingAddress:e}))},r.openAddAddressDialog=function(){r.props.dispatch(fr.ContactActions.setCurrentAddress({})),r.setState({isShowAddressForm:!0,billingAddressEditMode:!1})},r.updateBillingAddress=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return e.DisplayName=[e.Line1,e.Line2,e.City,e.PostalCode,e.CountryName].filter((function(e){return e})).join(", "),void 0===(t=this.props.orderGroup.OrderAddresses.find((function(t){return t.DisplayName===e.DisplayName})))&&(e.AddressId=this.props.orderForm.OrderFormId.toString()),t&&!e.AddressId&&(e.AddressId=t.AddressId),this.setState({billingAddressId:e.AddressId,billingAddress:e}),[2]}))}))},r.setDefaultBillingAddress(),r.setDefaultPaymentMethod(),r}return Vt(r,e),r.prototype.componentDidMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){return this.setState({loaded:!0}),[2]}))}))},r.prototype.setDefaultPaymentMethod=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return this.props.paymentMethods.length>=1&&(e=this.props.paymentMethods.find((function(e){return!0===e.IsDefault}))),void 0===e?[3,2]:[4,ln.OrderGroup.getPaymentModel(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId,this.props.orderForm.OrderFormId,e.PaymentMethodId)];case 1:t=r.sent(),this.setState({paymentMethodId:e.PaymentMethodId,selectedPayment:t}),r.label=2;case 2:return[2]}}))}))},r.prototype.setDefaultBillingAddress=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){return null!==(e=this.props.orderGroup.OrderAddresses)&&(t=void 0,e.length>=1&&(t=e.find((function(e){return!0===e.IsPreferredBillingAddress}))),void 0!==t&&this.setState({billingAddress:t})),[2]}))}))},r.prototype.updatePayment=function(e,t,r){var n=Object.assign({},e);n[t]=r,this.setState({selectedPayment:n})},r.prototype.changePaymentMethod=function(e){return Wt(this,void 0,void 0,(function(){var t,r=this;return qt(this,(function(n){switch(n.label){case 0:return[4,ln.OrderGroup.getPaymentModel(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId,this.props.orderForm.OrderFormId,e)];case 1:return t=n.sent(),this.setState({paymentMethodId:e,selectedPayment:t},(function(){var e=r.getRemainTransactionAmount();r.changeTransactionAmountHandler(e)})),[2]}}))}))},r.prototype.getRemainTransactionAmount=function(){return(this.props.orderGroup.Total.Amount-(this.props.orderForm.AuthorizedPaymentTotal.Amount+this.props.orderForm.CapturedPaymentTotal.Amount)).toFixed(this.props.orderGroup.Total.Fractions)},r.prototype.render=function(){var e=this,r=this.props.paymentMethods.map((function(e){return{label:e.Name+" "+e.LanguageId,value:e.PaymentMethodId}})),n=jt(this.props.orderGroup.OrderAddresses);this.state.billingAddress.AddressId&&void 0===n.find((function(t){return t.DisplayName===e.state.billingAddress.DisplayName}))&&(n=jt([this.state.billingAddress],this.props.orderGroup.OrderAddresses));var s=n.map((function(e){return{label:e.DisplayName,value:e.AddressId}}));return t(Cn,{open:!0,title:"Add Payment",onClose:this.props.onClose,okLabel:"Save",closeLabel:"Cancel",onOK:this.addPayment},this.state.paymentAddressFormVisible&&t(Mi,{onClose:function(){e.setState({paymentAddressFormVisible:!1})}}),this.state.loaded&&t(l,{container:!0,spacing:16},t(l,{item:!0,xs:12},t(l,{container:!0,spacing:16},t(l,{item:!0,xs:12},t(Jr,{label:"Billing Address",fullWidth:!0,options:s,value:this.state.billingAddressId,onChange:function(t){return e.billingAddressChange(t)}}),t(m,{variant:"caption",color:"error"},this.state.errors.BillingAddressId),t(l,{container:!0,spacing:16,justify:"flex-end"},t(l,{item:!0},t(m,{variant:"subtitle1",color:"primary",onClick:this.openAddAddressDialog,style:{cursor:"pointer",fontSize:"13px"}},"Add Address")),this.state.billingAddressId&&t(l,{item:!0},t(m,{variant:"subtitle1",color:"primary",onClick:this.openEditAddressDialog,style:{cursor:"pointer",fontSize:"13px"}},"Edit Address")))),t(l,{item:!0,xs:12},t(Jr,{label:"Payment Method",fullWidth:!0,options:r,value:this.state.paymentMethodId,onChange:function(t){return e.changePaymentMethod(t)}}),t(m,{variant:"caption",color:"error"},this.state.errors.PaymentMethodId)),this.state.paymentMethodId&&t(l,{item:!0,xs:12},t(h,{id:"transactionAmount",name:"TransactionAmount",type:"number",label:"Transaction Amount",fullWidth:!0,variant:"outlined",defaultValue:this.getRemainTransactionAmount(),onChange:function(t){return e.changeTransactionAmountHandler(t.target.value)},error:!!this.state.errors.TransactionAmount,helperText:this.state.errors.TransactionAmount,inputProps:{step:.1,min:0}})))),this.state.paymentMethodId&&this.state.selectedPayment.Properties&&this.state.selectedPayment.Properties.length>0&&t(l,{item:!0,xs:12},t(zs,{isCollapsible:!1,properties:this.state.selectedPayment.Properties,onPropertyChanged:this.customPropertyChangedHandler}))),this.state.isShowAddressForm&&t(ki,{onClose:function(){return e.setState({isShowAddressForm:!1})},editMode:this.state.billingAddressEditMode,onAddressChanged:this.updateBillingAddress,onAddressCreated:this.updateBillingAddress}))},r}(n),Vi=u((function(e,t){var r=e.orderGroup.currentOrderGroup;return{paymentMethods:e.payment.paymentMethods,orderGroup:r,orderForm:r.Forms[e.orderGroup.selectedFormIndex],onClose:t.onClose}}))(_i),Ui=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.state={isAddPaymentFormVisible:!1},r.columns=[{name:"Payment Method",render:function(e){return t(We,null,e.PaymentMethodName)}},{name:"Billing Address",render:function(e){return t(bn,{address:e.BillingAddress})}},{name:"Status",render:function(e){return t(We,null,Qs(e.Status))}},{name:"Transaction Amount",render:function(e){return t(Rs,{amount:e.Amount,variant:"body2"})}},{name:"Transaction Type",render:function(e){return t(We,null,Qs(e.TransactionType))}},{name:"Transaction ID",render:function(e){return t(We,null,Qs(e.TransactionID))}},{name:"Provider Transaction ID",render:function(e){return t(We,null,Qs(e.ProviderTransactionID))}}],r}return Vt(r,e),r.prototype.render=function(){var e=this;return t(l,{container:!0,direction:"column",spacing:16},t(l,{item:!0},t(We,{variant:"h6"},"Transactions")),t(l,{item:!0},t(It,null)),!this.state.isAddPaymentFormVisible&&this.props.canAcceptPayment&&t(l,{item:!0},t(se,{unelevated:!0,onClick:function(){return e.setState({isAddPaymentFormVisible:!0})}},"Add Payment")),t(l,{item:!0},this.props.payments.length>0?t(Us,{columns:this.columns,data:this.props.payments}):t(xi,{message:"No payments found."})),this.state.isAddPaymentFormVisible&&t(Vi,{onClose:function(){e.setState({isAddPaymentFormVisible:!1})}}))},r}(n),Bi=function(e){var t=e.orderGroup.currentOrderGroup,r=!1;if("Cart"!==t.Type){var n=t.Forms[e.orderGroup.selectedFormIndex],s=n.AuthorizedPaymentTotal.Amount+n.CapturedPaymentTotal.Amount<t.Total.Amount;r=(t.OrderStatus===oi.InProgress||t.OrderStatus===oi.PartiallyShipped)&&s}return r},Hi=u((function(e,t){return{payments:t.payments,canAcceptPayment:Bi(e)}}))(Ui),Wi=function(e,t,r,n){return Wt(void 0,void 0,void 0,(function(){var s,i;return qt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,ln.OrderGroup.getSingleOrderGroup(e,t)];case 1:return s=o.sent(),r(s),[3,3];case 2:return i=o.sent(),n(i.message),[3,3];case 3:return[2]}}))}))},qi=function(e,t,r,n,s,i){return Wt(void 0,void 0,void 0,(function(){var o,a,u;return qt(this,(function(d){switch(d.label){case 0:o={Code:n,Applied:!1},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,ln.OrderGroup.addCoupon(e,t,r,o)];case 2:return a=d.sent(),Wi(e,t,s,i),a.data.Applied||i('The coupon code "'+n+'" will not be subject to any discount.'),a.data.HasValidationIssues&&i("The coupon was applied with errors. \n "+a.data.ValidationMessages),[3,4];case 3:return u=d.sent(),i(u.message),[3,4];case 4:return[2]}}))}))},ji=z((function(e){e.palette;var t=e.spacing,r=e.transitions;e.breakpoints;return c({root:{marginBottom:mn.marginDefault,padding:mn.paddingDefault},chip:{marginRight:t.unit,maxWidth:250,"& span":{textOverflow:"ellipsis",display:"inline",overflow:"hidden"}},chipAvatar:{background:"rgba(0,0,0,0)"},couponTextField:{"& fieldset":{top:-3,"& legend":{width:0,position:"absolute"}}},couponTextFieldFocus:{width:25,textOverflow:"ellipsis",transition:r.create("width",{easing:r.easing.easeInOut,duration:r.duration.standard}),transitionDelay:"0.5s","&:focus, &:hover":{width:150,transition:r.create("width",{easing:r.easing.easeInOut,duration:r.duration.standard})}},couponTextFieldInput:{paddingRight:0}})}))(u((function(e,t){return{coupons:e.orderGroup.currentOrderGroup.Forms[e.orderGroup.selectedFormIndex].Coupons,orderGroupId:e.orderGroup.currentOrderGroup.OrderGroupId,orderForm:e.orderGroup.currentOrderGroup.Forms[e.orderGroup.selectedFormIndex],couponTextFieldValue:e.orderGroup.couponTextFieldValue,classes:t.classes,isReadonly:t.isReadonly,orderGroupType:e.orderGroup.currentOrderGroup.Type}}))((function(e){var r=e.classes,n=function(t){e.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(t)),e.dispatch(fr.OrderGroupActions.setCouponTextFieldValue(""))},s=function(t){e.dispatch(fr.ApplicationActions.showNotification(t))};return t($,null,t($,null,t(We,{variant:"subtitle2",gutterBottom:!0},"Discount Codes")),t($,{container:!0,alignItems:"center",spacing:16},!e.isReadonly&&t($,{item:!0},t(At,{value:e.couponTextFieldValue,className:r.couponTextField,onChange:function(t){return r=t.target.value,void e.dispatch(fr.OrderGroupActions.setCouponTextFieldValue(r));var r},variant:"outlined",margin:"dense",onKeyDown:function(t){13===t.keyCode&&e.couponTextFieldValue.length>0&&qi(e.orderGroupType,e.orderGroupId,e.orderForm.OrderFormId,e.couponTextFieldValue,n,s)},inputProps:{className:r.couponTextFieldFocus},InputProps:{className:r.couponTextFieldInput,endAdornment:t(Ot,{position:"end"},t(at,{title:"Add "+e.couponTextFieldValue+" as a coupon code"},t("div",null,t(ie,{disabled:0===e.couponTextFieldValue.length,onClick:function(){return qi(e.orderGroupType,e.orderGroupId,e.orderForm.OrderFormId,e.couponTextFieldValue,n,s)}},t(Ye,null)))))}})),e.coupons.length>0?e.coupons.map((function(i,o){return t($,{item:!0,key:o},t(bt,{avatar:i.Applied?t(wt,{className:r.chipAvatar},t(Tt,null)):void 0,className:r.chip,label:i.Code,variant:i.Applied?"default":"outlined",onDelete:e.isReadonly?void 0:function(){return function(e,t,r,n,s,i){return Wt(void 0,void 0,void 0,(function(){var o;return qt(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,ln.OrderGroup.removeCoupon(e,t,r,i)];case 1:return a.sent(),Wi(e,t,n,s),[3,3];case 2:return o=a.sent(),s(o.message),[3,3];case 3:return[2]}}))}))}(e.orderGroupType,e.orderGroupId,e.orderForm.OrderFormId,n,s,i)}}))})):t($,{item:!0},t(xi,{message:Qs(e.orderGroupType)+" contains no coupons.",renderInline:!0}))))})));!function(e){e[e.None=0]="None",e[e.Money=1]="Money",e[e.Percentage=2]="Percentage",e[e.Free=3]="Free",e[e.FixedPrice=4]="FixedPrice",e[e.Gift=5]="Gift"}(wi||(wi={}));var Yi,zi=wi,Qi=function(e){return e.promotionInformation.RewardType===zi.Gift?t(We,Bt({},e),"Gift"):t(Rs,Bt({},e.typographyProps,{amount:e.promotionInformation.SavedAmount}))},Ki=z((function(e){e.palette,e.spacing,e.breakpoints;return c({})}))((function(e){var r=[{name:"Discount",selector:"Name"},{name:"Description",selector:"Description"},{name:"Coupon Code",selector:"CouponCode"},{name:"Saved Amount",right:!0,render:function(e){return t(Qi,{promotionInformation:e,typographyProps:{variant:"body1"}})}}];return t($,{direction:"column",spacing:16,container:!0},t($,{item:!0},t(We,{variant:"h6",gutterBottom:!0},"Discounts")),t($,{item:!0},t(L,null)),!e.isCreateNewOrder&&t($,{item:!0},t(ji,{isReadonly:e.isReadonly})),t($,{item:!0},e.promotionInformation.length>0?t(Us,{columns:r,data:e.promotionInformation}):t(xi,{message:"There are currently no discounts applied."})))})),Xi=z((function(e){e.palette,e.spacing,e.breakpoints;return c({root:{width:48,height:48,display:"inline-flex",justifyContent:"center",alignItems:"center"},tooltip:{postition:"relative",height:"100%",width:"100%"}})}))((function(e){var r=e.classes,n=e.children;return t("div",{className:r.root},t(at,{classes:{tooltip:r.tooltip},title:e.tooltipMessage},t(Gt,{badgeContent:e.badgeContent,color:"primary"},n)))})),Ji=function(e){var r=e.ThumbnailUrl?t(wt,{src:e.ThumbnailUrl}):t(Dt,null);return e.IsGift?t(Xi,{tooltipMessage:"Gift",badgeContent:t(Pt,{style:{width:"0.75em"}})},r):r},Zi=function(e){return t(l,{container:!0,direction:"row",justify:"flex-start",spacing:8},e.properties&&Object.keys(e.properties).map((function(r){return t(l,{item:!0,key:r},t(We,{color:"textSecondary",variant:"body2"},r,": ",t("strong",null,e.properties[r])))})))},$i=require("autosuggest-highlight/match"),eo=require("autosuggest-highlight/parse"),to=function(e){e.classes;var r=Ht(e,["classes"]);return t(h,Bt({fullWidth:!0,label:"Product Variant",placeholder:"Search by catalog SKU code or name",variant:"outlined"},r))},ro=function(e){return e.Code},no=function(e){function r(r){var n=e.call(this,r)||this;return n.classes=n.props.classes,n.state={searchFieldValue:"",suggestions:[],isWaitingSuggestions:!1},n.requiredSearchStringLength=3,n.SuggestionsContainer=function(e){var r=e.containerProps,s=e.children;return t(M,Bt({},r,{className:n.classes.suggestionsContainerOpen,square:!0}),n.state.isWaitingSuggestions&&t("div",{className:n.classes.progressContainer},t(F,{className:n.classes.progressIndicator})),s)},n.selectSuggestion=function(e,t){return Wt(n,void 0,void 0,(function(){return qt(this,(function(e){return this.props.onSelected(t.suggestion),[2]}))}))},n.getSuggestions=function(e){var t=e.value;return Wt(n,void 0,void 0,(function(){var e,r,n;return qt(this,(function(s){switch(s.label){case 0:return e=t.trim().toLowerCase(),r=[],this.props.dispatch(fr.ApplicationActions.setIsLoadingResource(!0)),e.length<this.requiredSearchStringLength?(this.clearSuggestions(),[3,4]):[3,1];case 1:return s.trys.push([1,3,,4]),[4,ln.Catalog.search(e)];case 2:return(r=s.sent()).length>0&&(r=r.map((function(e){return e})),this.setState({suggestions:r})),[3,4];case 3:return n=s.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,4];case 4:return this.props.dispatch(fr.ApplicationActions.setIsLoadingResource(!1)),[2,r]}}))}))},n.clearSuggestions=function(){n.setState({suggestions:[]})},n.updateSearchFieldValue=function(e,t){t&&(n.setState({searchFieldValue:t.newValue}),n.props.onSearchFieldChanged&&n.props.onSearchFieldChanged(t.newValue))},n.renderEntrySuggestion=function(e,r){return function(e,r){var n=$i(e.DisplayName,r.query),s=eo(e.DisplayName,n),i=$i(e.Code,r.query),o=eo(e.Code,i),a=r.isHighlighted?fn.hoveredList:"#fff";return t(pe,{style:{backgroundColor:a,paddingTop:0,paddingBottom:0}},t(le,{style:{height:"auto"}},""!==e.ThumbnailUrl?t(k,{src:e.ThumbnailUrl}):t(k,null,t(Dt,null)),t(he,{primaryText:t("div",{style:{textAlign:"left",minHeight:"50px",paddingLeft:"16px",width:"100%"}},t(m,{variant:"subtitle1"},s.map((function(e,r){return e.highlight?t("span",{key:String(r),style:{fontWeight:500}},e.text):t("strong",{key:String(r),style:{fontWeight:300}},e.text)}))),t($,{container:!0,spacing:16,justify:"space-between"},t($,{item:!0,xs:12,sm:6},t(m,{variant:"body1",color:"textSecondary"},o.map((function(e,r){return e.highlight?t("span",{key:String(r),style:{fontWeight:500}},e.text):t("strong",{key:String(r),style:{fontWeight:300}},e.text)})))),t($,{item:!0,xs:12,sm:3},t(m,{variant:"body1",color:"textSecondary",style:{fontWeight:300}},"In Stock: ",e.InStock)),t($,{item:!0,xs:12,sm:3},e.ProductUrl&&t("a",{href:e.ProductUrl,target:"_blank",rel:"noopener noreferrer",onClick:function(e){e.stopPropagation()}},t(m,null,"More Details"))),t($,{item:!0,xs:12},t(Zi,{properties:e.CustomProperties}))))}),e.QuantityInShipment>0&&t("div",{style:{marginLeft:"-40px"}},t(Xi,{badgeContent:e.QuantityInShipment,tooltipMessage:"The shipment already contains "+e.QuantityInShipment+" of this item."},t(xt,null)))),t(me,null))}(e,r)},n.getSuggestionsDebounce=Nt(n.getSuggestions,1e3,{trailing:!0}),n}return Vt(r,e),r.prototype.render=function(){return t("div",{className:this.classes.root},t(Et,{suggestions:this.state.suggestions.slice(0,20),renderInputComponent:to,onSuggestionsFetchRequested:this.getSuggestionsDebounce,onSuggestionsClearRequested:this.clearSuggestions,renderSuggestionsContainer:this.SuggestionsContainer,getSuggestionValue:ro,renderSuggestion:this.renderEntrySuggestion,onSuggestionSelected:this.selectSuggestion,theme:{container:this.classes.container,suggestionsContainerOpen:this.classes.suggestionsContainerOpen,suggestionsList:this.classes.suggestionsList,suggestion:this.classes.suggestion},inputProps:{classes:this.classes,value:this.state.searchFieldValue,onChange:this.updateSearchFieldValue,type:"search"}}))},r}(n),so=z((function(e){var t=e.palette,r=e.spacing;e.breakpoints;return c({root:{flexGrow:1},container:{position:"relative",textAlign:"center",minHeight:56},suggestionsContainerOpen:{position:"absolute",zIndex:2,marginTop:r.unit,left:0,right:0,width:"100%"},suggestion:{display:"block",cursor:"pointer"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:2*r.unit},progressContainer:{marginTop:8},progressIndicator:{color:t.secondary.light,margin:8},noResultsFound:{fontStyle:"italic",textAlign:"center",padding:6,marginTop:8}})}))(u((function(e,t){return{classes:t.classes,onSelected:t.onSelected,onSearchFieldChanged:t.onSearchFieldChanged}}))(no));!function(e){e[e.Percentage=1]="Percentage",e[e.Value=2]="Value"}(Yi||(Yi={}));var io=Yi,oo=function(e){function n(t){var r=e.call(this,t)||this;if(r.state={lineItem:r.props.lineItem,openEntrySelectionView:!1,shipmentId:-1,quantity:1,placedPrice:r.props.lineItem.PlacedPrice?r.props.lineItem.PlacedPrice.Amount:0,defaultPlacedPrice:-1,entrySelectedSuggestion:{},editMode:!1,errorMessage:"",discountType:io.Value,discountValue:0,discountDescription:"",showDialog:!1,properties:new Array,shipmentOptions:[],isBundle:!1,isReadonly:r.props.isReadonly,originalLineItem:{},errors:{Quantity:"",PlacedPrice:"",DiscountValue:"",DiscountType:"",ShipmentId:"",LineItemCode:""}},r.customPropertiesForm={},r.validationSchema=Ae().shape({Quantity:we().required().positive().lessThan(Number.MAX_SAFE_INTEGER,"This value is out of range."),EditMode:Pe(),PlacedPrice:we().min(0).lessThan(Number.MAX_SAFE_INTEGER,"This value is out of range."),ShipmentId:we().required("Please select a Shipment."),LineItemCode:Oe().when("EditMode",{is:!1,then:Oe().required("Product variant is required.")}),DiscountType:we(),DiscountValue:we().min(0).when("DiscountType",{is:1,then:we().max(100,"DiscountValue must be between 0-100."),otherwise:we().max(Ge("PlacedPrice"),"DiscountValue can not exceed PlacedPrice.")})}),r.submitForm=function(){return Wt(r,void 0,void 0,(function(){var e,t,r,n,s,i,o,a,u,d,c,p,l,h,m;return qt(this,(function(f){switch(f.label){case 0:return this.customPropertiesForm.isFormValid()?[4,this.validateForm()]:[2];case 1:return f.sent()?(e=this.getExistedLineItem(this.state.entrySelectedSuggestion.Code),this.state.editMode||e?(t=e?e.LineItemId:this.props.lineItem.LineItemId,r=e?e.Quantity:0,n=r+this.state.quantity,s={OrderGroupId:this.props.orderGroup.OrderGroupId,OrderGroupType:this.props.orderGroup.Type,LineItemId:t,Quantity:n,PlacedPrice:this.state.placedPrice},this.state.discountValue>0&&(s.DiscountType=this.state.discountType,s.DiscountValue=this.state.discountValue,s.DiscountDescription=this.state.discountDescription),this.state.editMode?[4,this.updateLineItemProperties()]:[3,3]):[3,10]):[2];case 2:f.sent(),f.label=3;case 3:return this.props.orderGroup.IsDraft?((i=e?JSON.parse(JSON.stringify(e)):this.state.lineItem).Quantity=s.Quantity,s.PlacedPrice&&(i.PlacedPrice.Amount=s.PlacedPrice),(o=s.DiscountValue?{ManualDiscountType:s.DiscountType,DiscountValue:s.DiscountValue,Description:s.DiscountDescription}:void 0)&&(i.ManualDiscount=o),a=JSON.parse(JSON.stringify(this.props.orderGroup)),u=a.Forms[0].Shipments[0].LineItems,d=u.findIndex((function(e){return e.LineItemId===t})),u[d]=i,[4,ln.OrderGroup.calculateOrder(a)]):[3,5];case 4:return a=f.sent(),l=a.ValidationMessages,this.lineItemHasChangedPrice(e||this.state.originalLineItem,a)&&(h="The price for product "+i.Code+" has changed since it was added to your cart.",l.push(h)),l.length>0?this.props.dispatch(fr.ApplicationActions.showNotification(l.join("\n"))):this.props.dispatch(fr.ApplicationActions.showNotification("The line item was successfully updated.")),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(a)),[3,9];case 5:return f.trys.push([5,8,,9]),[4,ln.OrderGroup.updateLineItem(s)];case 6:return c=f.sent(),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 7:return p=f.sent(),l=[],this.isValidationMessagesReturned(c)&&(l=c.data),this.lineItemHasChangedPrice(e||this.state.originalLineItem,p)&&(h="The price for product "+(e?e.Code:this.state.originalLineItem.Code)+" has changed since it was added to your cart.",l.push(h)),l.length>0?this.props.dispatch(fr.ApplicationActions.showNotification(l.join("\n"))):this.props.dispatch(fr.ApplicationActions.showNotification("The line item was successfully updated.")),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(p)),[3,9];case 8:return m=f.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(m.message)),[3,9];case 9:return this.props.onClose(),[3,12];case 10:return[4,this.addLineItemToOrderGroup()];case 11:f.sent()&&this.props.onClose(),f.label=12;case 12:return[2]}}))}))},r.lineItemHasChangedPrice=function(e,t){var r=t.Forms[0];if(t.IsDraft)for(var n=0;n<r.Shipments.length;n++){if(r.Shipments[n].LineItems.find((function(t){return t.Code===e.Code&&t.PlacedPrice.Amount!==e.PlacedPrice.Amount})))return!0}else for(n=0;n<r.Shipments.length;n++){if(r.Shipments[n].LineItems.find((function(t){return t.LineItemId===e.LineItemId&&t.PlacedPrice.Amount!==e.PlacedPrice.Amount})))return!0}return!1},r.updatePlacedPrice=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return t=Number(e.target.value),!isNaN(t)&&t>=0&&this.setState({placedPrice:t},this.validateForm),[2]}))}))},r.updateDiscountPrice=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return t=Number(e.target.value),!isNaN(t)&&t>=0&&this.setState({discountValue:t},this.validateForm),[2]}))}))},r.updateDiscountDescription=function(e){return Wt(r,void 0,void 0,(function(){return qt(this,(function(t){return this.setState({discountDescription:e.target.value}),[2]}))}))},r.quantityChangeHandler=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return t=Number(e.target.value),isNaN(t)||this.setState({quantity:t},this.validateForm),[2]}))}))},r.quantityBluredHandler=function(){return Wt(r,void 0,void 0,(function(){var e,t,r;return qt(this,(function(n){switch(n.label){case 0:return[4,this.validateForm()];case 1:if(!n.sent())return[2];e=this.state.editMode?this.props.lineItem.Code:this.state.entrySelectedSuggestion.Code,n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this.getPlacedPrice(e,this.state.quantity)];case 3:return(t=n.sent())&&t.Amount!==this.state.defaultPlacedPrice&&this.setState({defaultPlacedPrice:t.Amount,placedPrice:t.Amount},this.validateForm),[3,5];case 4:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,5];case 5:return[2]}}))}))},r.getPlacedPrice=function(e,t){return Wt(r,void 0,void 0,(function(){var r;return qt(this,(function(n){switch(n.label){case 0:if(!e)return[2,null];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,ln.OrderGroup.getPlacedPrice(e,t,this.props.orderGroup.MarketId,this.props.orderGroup.Currency,this.props.orderGroup.Customer.Id)];case 2:return[2,n.sent().data];case 3:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),404===r.response.status&&this.setState({isReadonly:!0}),[2,null];case 4:return[2]}}))}))},r.customPropertyChangedHandler=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return(t=this.state.properties.findIndex((function(t){return t.Name===e.Name})))>=0&&(this.state.properties[t]=Bt({},e),this.setState({properties:jt(this.state.properties)}),this.forceUpdate()),[2]}))}))},void 0!==r.props.lineItem.LineItemId){if(r.state.editMode=!0,r.state.quantity=r.props.lineItem.Quantity,r.state.placedPrice=r.props.lineItem.PlacedPrice.Amount,r.state.shipmentId=r.props.orderForm.Shipments[r.props.lineItem.ShipmentNo-1].ShipmentId,r.props.lineItem.ManualDiscount){var n=r.props.lineItem.ManualDiscount;r.state.discountType=n.ManualDiscountType,r.state.discountValue=n.DiscountValue,r.state.discountDescription=n.Description}r.state.properties=jt(r.props.lineItem.Properties),r.state.originalLineItem=JSON.parse(JSON.stringify(r.props.lineItem))}else r.state.shipmentId=r.props.orderForm.Shipments[0].ShipmentId;return r}return Vt(n,e),n.prototype.componentDidMount=function(){var e=this;this.props.lineItem.Code&&this.props.lineItem.IsEntryAvailable?this.getPlacedPrice(this.props.lineItem.Code,this.state.quantity).then((function(t){t?e.setState({defaultPlacedPrice:t.Amount,showDialog:!0}):e.setState({showDialog:!0})})):this.setState({showDialog:!0}),this.initData()},n.prototype.addLineItemToOrderGroup=function(){return Wt(this,void 0,void 0,(function(){var e,t,r,n,s,i;return qt(this,(function(o){switch(o.label){case 0:e=this.createLineItemPostData(this.state.entrySelectedSuggestion,this.state.quantity,this.state.placedPrice),o.label=1;case 1:return o.trys.push([1,8,,9]),this.props.orderGroup.IsDraft?[4,ln.OrderGroup.initLineItem(this.props.orderGroup.Currency,this.props.orderGroup.MarketId,this.props.orderGroup.Customer.Id,e)]:[3,4];case 2:return t=o.sent(),r=JSON.parse(JSON.stringify(this.props.orderGroup)),t.forEach((function(e){var t=r.Forms[0].Shipments[0].LineItems.find((function(t){return t.Code===e.Code}));t?t.Quantity+=e.Quantity:r.Forms[0].Shipments[0].LineItems.push(e)})),[4,ln.OrderGroup.calculateOrder(r)];case 3:return(r=o.sent()).ValidationMessages.length>0&&this.props.dispatch(fr.ApplicationActions.showNotification(r.ValidationMessages.join("\n"))),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(r)),[3,7];case 4:return[4,ln.OrderGroup.addLineItemToOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId,this.props.orderForm.OrderFormId,this.state.shipmentId,e)];case 5:return n=o.sent(),this.isValidationMessagesReturned(n)&&this.props.dispatch(fr.ApplicationActions.showNotification(n.data.join("\n"))),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 6:s=o.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(s)),o.label=7;case 7:return[3,9];case 8:return i=o.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(i.message)),[2,!1];case 9:return[2,!0]}}))}))},n.prototype.getExistedLineItem=function(e){var t,r=this,n=this.props.orderForm.Shipments.find((function(e){return e.ShipmentId===r.state.shipmentId}));return n&&(t=n.LineItems.find((function(t){return!t.IsGift&&t.Code===e}))),t},n.prototype.isValidationMessagesReturned=function(e){return e&&e.data&&Array.isArray(e.data)&&e.data.length>0},n.prototype.createLineItemPostData=function(e,t,r){return{code:e.Code,displayName:e.DisplayName,quantity:t,placedPrice:r}},n.prototype.validateForm=function(){return Wt(this,void 0,void 0,(function(){var e,t,r;return qt(this,(function(n){switch(n.label){case 0:e=!0,t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.validationSchema.validate({Quantity:this.state.quantity,PlacedPrice:this.state.placedPrice,DiscountValue:this.state.discountValue,DiscountType:this.state.discountType,ShipmentId:this.state.shipmentId,EditMode:this.state.editMode,LineItemCode:this.state.entrySelectedSuggestion.Code},{strict:!0,abortEarly:!1})];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),e=!1,r.inner.map((function(e){t[e.path]=e.message})),[3,4];case 4:return this.setState({errors:t}),[2,e]}}))}))},n.prototype.updateLineItemProperties=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:if(this.props.orderGroup.IsDraft)return this.setState({lineItem:Bt(Bt({},this.state.lineItem),{Properties:this.state.properties})}),[2];e=0,r.label=1;case 1:if(!(e<this.props.lineItem.Properties.length))return[3,6];if(this.props.lineItem.Properties[e].Value===this.state.properties[e].Value)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,ln.MetaField.updateOrderLineItemMetaFields(this.props.orderGroup.OrderGroupId,this.props.orderGroup.Type,this.props.lineItem.LineItemId,this.state.properties[e])];case 3:return r.sent(),[3,5];case 4:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},n.prototype.handleEntrySearchSelected=function(e){this.setState({placedPrice:e.Price.Amount,entrySelectedSuggestion:e,isBundle:e.IsBundle},this.validateForm)},n.prototype.handleEntrySearchChanged=function(e){""===e&&this.setState({placedPrice:0,quantity:1,entrySelectedSuggestion:{},isBundle:!1,defaultPlacedPrice:-1})},n.prototype.initData=function(){var e=[],t=this.props.orderForm.Shipments.map((function(e,t){return{label:"Shipment "+(t+1),orderShipmentStatus:e.OrderShipmentStatus,shipmentId:e.ShipmentId,value:e.ShipmentId.toString()}})),r=t.filter((function(e){return e.orderShipmentStatus.Name===Ti.AwaitingInventory||e.orderShipmentStatus.Name===Ti.InventoryAssigned})),n=r.length>0?r[0].shipmentId:-1;e=this.state.editMode?t:r,this.setState({shipmentOptions:e}),this.state.editMode||n===this.state.shipmentId||this.setState({shipmentId:n})},n.prototype.render=function(){var e=this,n={title:this.state.isReadonly?"Line Item Details":this.state.editMode?"Edit Line Item":"Add Line Item",open:!0,onClose:function(){e.props.onClose()},closeLabel:this.state.isReadonly?"Close":"Cancel"};return this.state.isReadonly||(n.okLabel=this.state.editMode?"Save":"Add Line Item",n.onOK=function(){return Wt(e,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.submitForm()];case 1:return e.sent(),[2]}}))}))}),t(Cn,Bt({},n),this.state.showDialog&&t(Ee,{instantValidate:!0,onSubmit:function(){return null},ref:function(t){return e.customPropertiesForm=t}},t(l,{container:!0,spacing:16,style:{marginTop:"5px"}},t(l,{item:!0,xs:12},this.state.editMode?t(h,{label:"Product variant",name:"productName",variant:"outlined",value:this.props.lineItem.DisplayName,fullWidth:!0,disabled:!0}):t(so,{onSelected:function(t){e.handleEntrySearchSelected(t)},onSearchFieldChanged:function(t){e.handleEntrySearchChanged(t)}}),t(m,{variant:"caption",color:"error"},this.state.errors.LineItemCode)),this.props.orderForm.Shipments.length>1&&t(l,{item:!0,xs:12},t(Jr,{label:"Shipment",fullWidth:!0,value:this.state.shipmentId,options:this.state.shipmentOptions,disabled:this.state.editMode,required:!0,onChange:function(t){e.setState({shipmentId:t})}}),t(m,{variant:"caption",color:"error"},this.state.errors.ShipmentId)),t(l,{item:!0,xs:12},t(h,{label:"Quantity",name:"Quantity",type:"number",variant:"outlined",value:this.state.quantity,onChange:this.quantityChangeHandler,onBlur:this.quantityBluredHandler,fullWidth:!0,error:!!this.state.errors.Quantity,helperText:this.state.errors.Quantity,required:!0,disabled:this.state.isReadonly,inputProps:{step:.1,min:0}})),this.state.editMode&&t(r,null,t(l,{item:!0,xs:6},t(h,{label:"Discount",name:"DiscountValue",type:"number",variant:"outlined",value:this.state.discountValue,onChange:this.updateDiscountPrice,fullWidth:!0,disabled:this.state.isReadonly||"Cart"===this.props.orderGroup.Type,inputProps:{min:0},error:!!this.state.errors.DiscountValue,helperText:this.state.errors.DiscountValue})),t(l,{item:!0,xs:6},t(Jr,{label:"Discount Type",value:this.state.discountType.toString(),options:[{label:"Percentage",value:"1"},{label:"Value",value:"2"}],onChange:function(t){e.setState({discountType:Number(t)},(function(){e.validateForm()}))},fullWidth:!0,disabled:this.state.isReadonly||"Cart"===this.props.orderGroup.Type})),t(l,{item:!0,xs:12},t(h,{label:"Discount Description",variant:"outlined",value:this.state.discountDescription,onChange:this.updateDiscountDescription,fullWidth:!0,disabled:this.state.isReadonly||"Cart"===this.props.orderGroup.Type}))),t(l,{item:!0,xs:12},t(h,{label:"Placed Price"+(this.props.orderGroup.Currency?"("+this.props.orderGroup.Currency+")":""),type:"number",name:"PlacedPrice",fullWidth:!0,variant:"outlined",value:this.state.placedPrice,onChange:this.updatePlacedPrice,error:!!this.state.errors.PlacedPrice,helperText:this.state.errors.PlacedPrice,inputProps:{min:0,step:.1},InputLabelProps:{shrink:!0},required:!0,disabled:this.state.isReadonly||"Cart"===this.props.orderGroup.Type||this.state.isBundle}),this.state.defaultPlacedPrice>=0&&this.state.defaultPlacedPrice!==this.state.placedPrice&&t(m,{variant:"caption",component:"h6"},"Default PlacedPrice is ",t("b",null,this.state.defaultPlacedPrice))),this.props.lineItem.Properties&&this.props.lineItem.Properties.map((function(r,n){return t(l,{item:!0,xs:12,key:n},t(js,{key:n,property:r,isReadonly:e.state.isReadonly||!r.IsEditable,onPropertyChanged:e.customPropertyChangedHandler}))})))))},n}(n),ao=u((function(e,t){var r=e.orderGroup.currentOrderGroup,n=r.Forms[e.orderGroup.selectedFormIndex];return Bt({orderGroup:r,orderForm:n},t)}))(oo),uo=function(){},co=function(e){function r(t){var r=e.call(this,t)||this;return r.handleReturnCommentChange=function(e){r.setState({returnComment:e.target.value})},r.state={isLoadingResource:!1,returnReasons:Array(),returnLineItems:Array(),returnComment:""},r}return Vt(r,e),r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return this.initReturnLineItem(),[4,this.getData()];case 1:return e.sent(),[2]}}))}))},r.prototype.initReturnLineItem=function(){var e=this.props.lineItems.map((function(e){return Bt(Bt({},e),{OriginalLineItemId:e.LineItemId,ReturnQuantity:e.ReturnableQuantity,ReturnReason:""})}));this.setState({returnLineItems:e})},r.prototype.getData=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return this.setState({isLoadingResource:!0}),[4,ln.OrderGroup.getReturnReasons()];case 1:return e=r.sent(),t=e.map((function(e){return{label:e.Label,value:e.Label}})),this.setState({returnReasons:t,isLoadingResource:!1}),[2]}}))}))},r.prototype.onCloseDialog=function(){this.props.closeView()},r.prototype.onCreateReturn=function(){return Wt(this,void 0,void 0,(function(){var e,t,r;return qt(this,(function(n){switch(n.label){case 0:if(!this.validate())return this.props.dispatch(fr.ApplicationActions.showNotification("Please input valid return information!")),[2];(e=new uo).LineItems=this.state.returnLineItems,e.ReturnComment=this.state.returnComment,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,ln.OrderGroup.createReturn(this.props.orderGroupId,e)];case 2:return(t=n.sent()).ReturnFormId&&as.push(Er+"/"+this.props.orderGroupId+"/returns/"+t.ReturnFormId),this.props.closeView(),[3,4];case 3:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,4];case 4:return[2]}}))}))},r.prototype.validate=function(){return!!this.state.returnLineItems.every((function(e){return e.ReturnQuantity>0&&""!==e.ReturnReason}))},r.prototype.render=function(){var e=this;return t(Cn,{title:"Create Return",open:!0,large:!0,onClose:function(){e.props.closeView()},onOK:function(){return Wt(e,void 0,void 0,(function(){return qt(this,(function(e){return this.onCreateReturn(),[2]}))}))},okLabel:"Create",closeLabel:"Cancel"},t($,{container:!0,spacing:16,direction:"column"},!this.state.isLoadingResource&&this.state.returnLineItems.map((function(r,n){return t($,{item:!0,key:n},t($,{container:!0,direction:"row",key:n,spacing:8},t($,{item:!0,xs:7},t($,{container:!0,direction:"row"},t($,{item:!0,xs:2},t(Ji,Bt({},r))),t($,{item:!0,xs:10},t(m,{variant:"body1",color:"inherit"},r.DisplayName),t($,{container:!0,direction:"row"},t($,{item:!0,xs:6},t(m,{variant:"body2",color:"inherit",align:"left"},r.Code)),t($,{item:!0,xs:6},t(m,{variant:"body2",color:"inherit",align:"right"},"Shipment No: ",r.ShipmentNo)))))),t($,{item:!0,xs:2},t(Lt,{outlined:!0,style:{width:"100%"},label:"Return Quantity"},t(Mt,{type:"number",step:"0.01",max:r.ReturnableQuantity,min:0,value:r.ReturnQuantity.toString(),onChange:function(t){r.ReturnQuantity=Number.parseFloat(t.currentTarget.value),e.setState({returnLineItems:e.state.returnLineItems})}}))),t($,{item:!0,xs:3},t(Jr,{label:"Return Reason",fullWidth:!0,value:r.ReturnReason,options:e.state.returnReasons,required:!0,onChange:function(t){r.ReturnReason=t,e.setState({returnLineItems:e.state.returnLineItems})}}))))}))),t($,{container:!0,direction:"column",spacing:8},t($,{item:!0},t(m,null,"Comment")),t($,{item:!0},t(Lt,{textarea:!0,label:"Comment",size:5,fullWidth:!0},t(Mt,{style:{height:"100px"},maxLength:1024,value:this.state.returnComment,onChange:this.handleReturnCommentChange})))))},r}(n),po=p((function(e){e.spacing;return c({})}))(u((function(e,t){return Bt({},t)}))(co)),lo={productRemoved:{textDecorationLine:"line-through"}},ho=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.state={isReturnDialogOpen:!1,selectedLineItems:[],isAddDialogOpen:!1,currentLineItem:{},contextAction:{isDeleteButtonVisible:!0,isCreateReturnButtonVisible:!1},delConfirmDialog:{isOpen:!1,onConfirm:function(){return null}}},r.tableInstance={},r.columns=[{name:"NAME",render:function(e,r){return t(l,{container:!0,direction:"row",alignItems:"center",wrap:"nowrap",spacing:8},t(l,{item:!0},t(Ji,Bt({},e))),t(l,{item:!0,style:e.IsEntryAvailable?void 0:lo.productRemoved},t(We,{variant:"body2",color:"inherit"},e.DisplayName),t(We,null,e.Code)))}},{name:"PLACED PRICE",right:!0,render:function(e,r){return t(We,null,e.PlacedPrice.Amount," ",e.PlacedPrice.Currency)}},{name:"SHIPMENT NO",selector:"ShipmentNo",right:!0},{name:"SHIPMENT STATUS",selector:"ShipmentStatus",render:function(e,t){return Qs(e.ShipmentStatus)}},{name:"TOTAL DISCOUNT",right:!0,render:function(e,r){var n,s,i;return t(We,null,null===(n=e.DiscountTotal)||void 0===n?void 0:n.Amount.toFixed(null===(s=e.DiscountTotal)||void 0===s?void 0:s.Fractions)," ",null===(i=e.DiscountTotal)||void 0===i?void 0:i.Currency)}},{name:"QUANTITY",selector:"Quantity",right:!0},{name:"TOTAL",right:!0,render:function(e,r){var n,s,i;return t(We,null,null===(n=e.DiscountedPrice)||void 0===n?void 0:n.Amount.toFixed(null===(s=e.DiscountedPrice)||void 0===s?void 0:s.Fractions)," ",null===(i=e.DiscountedPrice)||void 0===i?void 0:i.Currency)}},{width:50,render:function(e,n){var s=new Array;return r.isEditableLineItem(e)&&!e.IsGift&&e.IsEntryAvailable?(s.push({title:"Edit",clickHandler:function(t){r.setState({isAddDialogOpen:!0,currentLineItem:e})}}),s.push({title:"Delete",clickHandler:function(e){var t={isOpen:!0,onConfirm:function(){r.deleteLineItems([r.state.currentLineItem])}};r.setState({currentLineItem:e,delConfirmDialog:t})}})):s.push({title:"View",clickHandler:function(t){r.setState({isAddDialogOpen:!0,currentLineItem:e})}}),e.ReturnableQuantity>0&&s.push({title:"Create Return",clickHandler:function(e){r.openReturnDialog([e])}}),0===s.length?null:t(Ci,{actions:s,rowData:e,rowIndex:n})}}],r.deleteLineItems=function(e){return Wt(r,void 0,void 0,(function(){var t,r,n,s,i,o;return qt(this,(function(a){switch(a.label){case 0:return this.setState({delConfirmDialog:{isOpen:!1}}),this.props.orderGroup.IsDraft?(t=JSON.parse(JSON.stringify(this.props.orderGroup)),r=e.map((function(e){return e.Code})),t.Forms[0].Shipments[0].LineItems=t.Forms[0].Shipments[0].LineItems.filter((function(e){return-1===r.indexOf(e.Code)})),[4,ln.OrderGroup.calculateOrder(t)]):[3,2];case 1:return t=a.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(t)),[3,11];case 2:n=0,a.label=3;case 3:if(!(n<e.length))return[3,8];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,ln.OrderGroup.deleteLineItem(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId,e[n].LineItemId)];case 5:return a.sent(),[3,7];case 6:return s=a.sent(),this.props.dispatch(fr.ApplicationActions.showNotification('Error occurred while deleting line item "'+e[n].DisplayName+'". <br/> '+s.message)),[3,8];case 7:return n++,[3,3];case 8:return a.trys.push([8,10,,11]),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 9:return i=a.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(i)),[3,11];case 10:return o=a.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(o.message)),[3,11];case 11:return[2]}}))}))},r.openReturnDialog=function(e){r.setState({isReturnDialogOpen:!0,selectedLineItems:e})},r.handleOnRowSelected=function(e,t){return Wt(r,void 0,void 0,(function(){var e,t,r,n,s;return qt(this,(function(i){for(e=!0,t=!0,r=this.tableInstance.getSelectedRows(),n=0;n<r.length;n++){if((s=r[n]).IsGift){e=!1,0===s.ReturnableQuantity&&(t=!1);break}0===s.ReturnableQuantity&&(t=!1),this.isShipmentEditable(s.ShipmentStatus)||(e=!1)}return this.setState({contextAction:{isDeleteButtonVisible:e,isCreateReturnButtonVisible:t}}),[2]}))}))},r.isShipmentEditable=function(e){return e===Ti.AwaitingInventory||e===Ti.InventoryAssigned},r.buildTableProps=function(){var e={columns:r.columns,data:r.props.lineItems,selectableRows:!0,tableInstance:r.tableInstance,onRowSelected:r.handleOnRowSelected,onHeaderRowSelected:r.handleOnRowSelected},t={buttons:[]};r.props.isReadonly||r.props.shipments.filter((function(e){return r.isShipmentEditable(e.OrderShipmentStatus.Name)})).length>0&&t.buttons&&t.buttons.push({title:"Add Line Items",clickHandler:function(e){r.setState({isAddDialogOpen:!0,currentLineItem:{}})}});e.toolbar=t;var n=new Array;return!r.props.isReadonly&&r.state.contextAction.isDeleteButtonVisible&&n.push({title:"Delete",clickHandler:function(e){var t={isOpen:!0,onConfirm:function(){var e=r.tableInstance.getSelectedRows();r.deleteLineItems(e),r.tableInstance.setHeaderRowChecked(!1)}};r.setState({delConfirmDialog:t})}}),r.state.contextAction.isCreateReturnButtonVisible&&n.push({title:"Create Return",clickHandler:function(e){var t=r.tableInstance.getSelectedRows();r.openReturnDialog(t),r.tableInstance.setHeaderRowChecked(!1)}}),n.length>0&&(e.contextActions=n),e},r}return Vt(r,e),r.prototype.componentDidMount=function(){var e=this.props.lineItems.filter((function(e){return!e.IsEntryAvailable})).map((function(e){return e.Code}));if(e.length>0){var t="You can not edit line items "+e.join(", ")+" because their entries have been removed or their code have been changed.";this.props.dispatch(fr.ApplicationActions.showNotification(t))}},r.prototype.isEditableLineItem=function(e){return!e.Code||!!e.IsEntryAvailable&&(!e.IsGift&&this.isShipmentEditable(e.ShipmentStatus))},r.prototype.render=function(){var e=this,r=this.buildTableProps();return t("div",null,t(We,{variant:"h6",gutterBottom:!0},"Line Items"),t(Us,Bt({},r)),this.state.isAddDialogOpen&&t(ao,{onClose:function(){return e.setState({isAddDialogOpen:!1})},lineItem:this.state.currentLineItem,isReadonly:!this.isEditableLineItem(this.state.currentLineItem)}),this.state.delConfirmDialog.isOpen&&t(Sn,{title:"Delete Line Item",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:this.state.delConfirmDialog.onConfirm,onClose:function(){e.setState({delConfirmDialog:{isOpen:!1}})}},t(We,{variant:"body1"},"Are you sure you want to delete?")),this.state.isReturnDialogOpen&&t(po,{lineItems:this.state.selectedLineItems,orderGroupId:this.props.orderGroup.OrderGroupId,closeView:function(){return e.setState({isReturnDialogOpen:!1})}}))},r}(n);function mo(e){if(!e.Shipments||0===e.Shipments.length)return[];for(var t=new Array,r=function(r){var n=e.Shipments[r];n.LineItems.forEach((function(e){e.ShipmentNo=r+1,e.ShipmentStatus=n.OrderShipmentStatus.Name,t.push(e)}))},n=0;n<e.Shipments.length;n++)r(n);return t}var fo=u((function(e,t){var r=e.orderGroup.currentOrderGroup,n=r.Forms[e.orderGroup.selectedFormIndex];return{lineItems:mo(n),orderGroup:r,shipments:n.Shipments,isReadonly:t.isReadonly}}))(ho),go=function(e){function r(t){var r=e.call(this,t)||this;return r.orderGroupApi=new qr,t.isCreateNewOrder||r.getData(),r}return Vt(r,e),r.prototype.getData=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroupType,this.props.orderGroupId)];case 1:return e=r.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(e)),[3,3];case 2:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,3];case 3:return[2]}}))}))},r.prototype.render=function(){return t($,{container:!0,direction:"column",spacing:32},t($,{item:!0},t(Ei,{shipments:this.props.orderForm.Shipments})),t($,{item:!0},t(fo,{isReadonly:this.props.isReadonly})),t($,{item:!0,style:{textAlign:"right",paddingRight:"100px"}},t($,{container:!0,direction:"row"},t($,{item:!0,md:!0},t(m,{variant:"subtitle2"},"Line Item Total")),t($,{item:!0,md:1},t(Rs,{amount:this.props.orderForm.ItemsTotal,variant:"subtitle2",align:"right"}))),t($,{container:!0,direction:"row"},t($,{item:!0,md:!0},t(m,{variant:"subtitle2"},"Shipping Total")),t($,{item:!0,md:1},t(Rs,{amount:this.props.orderForm.ShippingTotal,variant:"subtitle2",align:"right"}))),t($,{container:!0,direction:"row"},t($,{item:!0,md:!0},t(m,{variant:"subtitle2"},"Handling Total")),t($,{item:!0,md:1},t(Rs,{amount:this.props.orderForm.HandlingTotal,variant:"subtitle2",align:"right"}))),t($,{container:!0,direction:"row"},t($,{item:!0,md:!0},t(m,{variant:"subtitle2"},"Form Total")),t($,{item:!0,md:1},t(Rs,{amount:this.props.orderForm.Total,variant:"subtitle2",align:"right"})))),t($,{item:!0},t(Ki,{promotionInformation:this.props.orderForm.Promotions,isReadonly:this.props.isReadonly,isCreateNewOrder:this.props.isCreateNewOrder})),("Cart"!==this.props.orderGroupType&&!this.props.isCreateNewOrder||this.props.orderForm.Payments.length>0)&&t($,{item:!0},t(Hi,{payments:this.props.orderForm.Payments})))},r}(n),yo=z((function(e){e.palette,e.spacing,e.breakpoints;return c({})}))(u((function(e,t){var r=e.orderGroup.currentOrderGroup;return{orderGroupId:r.OrderGroupId,orderForm:t.orderForm,orderGroupType:r.Type,classes:t.classes,isReadonly:li(r),isCreateNewOrder:r.IsDraft}}))(go)),vo=function(e){function n(t){var r=e.call(this,t)||this;r.state={selectedOrderTabIndex:0,showCancelPaymentPlanConfirm:!1},r.orderTabNames=new Array,r.closeOrderGroupView=function(){r.props.dispatch(fr.ApplicationActions.closeOrderGroupView()),r.props.dispatch(fr.ContactActions.setCurrentContact(null)),r.props.dispatch(fr.ContactActions.setCurrentAddress(null)),r.props.dispatch(fr.PaymentActions.hideAcceptPaymentForm()),r.props.dispatch(fr.PaymentActions.setPaymentMethodId("")),r.props.dispatch(fr.PaymentActions.setPayment(null)),r.props.dispatch(fr.PaymentActions.setBillingAddress(null)),r.props.dispatch(fr.PaymentActions.setBillingAddressDropdownIsExpanded(!1)),r.props.dispatch(fr.OrderGroupActions.setPaymentPlanSetting({}))},r.orderTabIndexChangedHandler=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return this.setState({selectedOrderTabIndex:e}),(t=new URLSearchParams(as.location.search)).set("tab",this.orderTabNames[e].key),as.replace(as.location.pathname+"?"+t.toString()),[2]}))}))},r.customPropertyChangedHandler=function(e){return Wt(r,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,ln.MetaField.updateOrderGroupMetaFields(this.props.orderGroup.OrderGroupId,this.props.orderGroup.Type,e)];case 1:return n.sent(),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroup.Type,this.props.orderGroup.OrderGroupId)];case 2:return t=n.sent(),this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(t)),[3,4];case 3:return r=n.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,4];case 4:return[2]}}))}))},r.convertCartToOrderHandler=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),hi(this.props.orderGroup)?[4,ln.Cart.convertToPurchaseOrder(this.props.orderGroup.OrderGroupId)]:[3,2];case 1:return e=r.sent(),as.replace(Er+"/"+e.OrderGroupId),us(Mr,wr+"?type=Order"),[3,3];case 2:this.props.dispatch(fr.ApplicationActions.showNotification("Cannot convert an empty cart to purchase order.")),r.label=3;case 3:return[3,5];case 4:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,5];case 5:return[2]}}))}))},r.convertCartToPaymentPlanHandler=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),hi(this.props.orderGroup)?[4,ln.Cart.convertToPaymentPlan(this.props.orderGroup.OrderGroupId)]:[3,2];case 1:return e=r.sent(),as.replace(Lr+"/"+e.OrderGroupId),us(kr,wr+"?type=PaymentPlan"),[3,3];case 2:this.props.dispatch(fr.ApplicationActions.showNotification("Cannot convert an empty cart to payment plan.")),r.label=3;case 3:return[3,5];case 4:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,5];case 5:return[2]}}))}))},r.convertPaymentPlanToOrderHandler=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),hi(this.props.orderGroup)?[4,ln.PaymentPlan.convertToPurchaseOrder(this.props.orderGroup.OrderGroupId)]:[3,2];case 1:return e=r.sent(),as.replace(Er+"/"+e.OrderGroupId),us(Mr,Lr+"/"+this.props.orderGroup.OrderGroupId),[3,3];case 2:this.props.dispatch(fr.ApplicationActions.showNotification("Cannot convert an empty payment plan to purchase order.")),r.label=3;case 3:return[3,5];case 4:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,5];case 5:return[2]}}))}))},r.cancelPaymentPlanHandler=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:this.setState({showCancelPaymentPlanConfirm:!1}),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,ln.PaymentPlan.cancelPaymentPlan(this.props.orderGroup.OrderGroupId)];case 2:return r.sent(),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroupType,this.props.orderGroupId)];case 3:return e=r.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(e)),[3,5];case 4:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,5];case 5:return[2]}}))}))},r.loadPaymentMethods=function(){return Wt(r,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return[4,ln.PaymentMethod.getPaymentMethods(this.props.orderGroup.MarketId)];case 1:return e=t.sent(),this.props.dispatch(fr.PaymentActions.setPaymentMethods(e)),[2]}}))}))},r.loadCurrencies=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ln.Currency.getCurrencies(this.props.orderGroup.MarketId)];case 1:return e=r.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrencies(e)),[3,3];case 2:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,3];case 3:return[2]}}))}))},r.initOrderTabs(t);var n=new URLSearchParams(as.location.search).get("tab");if(n){var s=r.orderTabNames.findIndex((function(e){return e.key===n}));s>0&&(r.state.selectedOrderTabIndex=s)}return r}return Vt(n,e),n.prototype.componentDidUpdate=function(){this.initOrderTabs(this.props)},n.prototype.initOrderTabs=function(e){var t=this;this.orderTabNames=[],this.orderTabNames.push({key:"summary",name:"Summary"}),this.orderTabNames.push({key:"details",name:"Form Details "}),"Order"===e.orderGroupType&&this.orderTabNames.push({key:"return",name:"Return & Exchange"}),this.orderTabNames.push({key:"contact",name:"Contact Details"}),"PaymentPlan"===e.orderGroupType&&(this.orderTabNames.push({key:"plansettings",name:"Settings"}),this.orderTabNames.push({key:"orders",name:"Orders"})),"Order"===e.orderGroupType&&this.props.orderDetailExtraTabs&&this.props.orderDetailExtraTabs.map((function(e,r){t.orderTabNames.push({key:"extraTab_"+r,name:e.title})})),"Cart"===e.orderGroupType&&this.props.cartDetailExtraTabs&&this.props.cartDetailExtraTabs.map((function(e,r){t.orderTabNames.push({key:"extraTab_"+r,name:e.title})})),"PaymentPlan"===e.orderGroupType&&this.props.paymentPlanExtraTabs&&this.props.paymentPlanExtraTabs.map((function(e,r){t.orderTabNames.push({key:"extraTab_"+r,name:e.title})}))},n.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return e.sent(),[2]}}))}))},n.prototype.shouldComponentUpdate=function(e,t){var r=this;return e.orderGroupId!==this.props.orderGroupId&&(as.push(ln.OrderGroup.getOrderGroupRouting(e.orderGroupType)+"/"+e.orderGroupId),setTimeout((function(){r.getData()}),200)),!0},n.prototype.getData=function(){return Wt(this,void 0,void 0,(function(){var e,t,r,n;return qt(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),[4,ln.OrderGroup.getSingleOrderGroup(this.props.orderGroupType,this.props.orderGroupId)];case 1:return e=s.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(e)),e.ValidationMessages.length>0&&this.props.dispatch(fr.ApplicationActions.showNotification(e.ValidationMessages.join(", "))),e.Customer.IsAnonymous?[3,3]:[4,ln.Contact.get(e.Customer.Id)];case 2:t=s.sent(),this.props.dispatch(fr.ContactActions.setCurrentContact(t)),s.label=3;case 3:return this.loadCurrencies(),[4,ln.Shipment.getShippingMethods()];case 4:return r=s.sent(),this.props.dispatch(fr.ShipmentActions.setShippingMethods(r)),"Cart"!==this.props.orderGroup.Type&&this.loadPaymentMethods(),[3,6];case 5:return n=s.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(n.message)),404===n.response.status&&as.replace("/?type="+this.props.orderGroupType),[3,6];case 6:return[2]}}))}))},n.prototype.closeView=function(){var e=new URLSearchParams(as.location.search).get("returnUrl"),t=void 0;if(e)return as.push(e),void this.closeOrderGroupView();switch(this.props.orderGroupType){case"Order":t=ds(Mr);break;case"PaymentPlan":t=ds(kr);break;default:t=ds(Fr)}void 0!==t?as.push(t):as.push("/"),this.closeOrderGroupView()},n.prototype.render=function(){var e,n,s=this,i=this.orderTabNames[this.state.selectedOrderTabIndex].key,o=function(){return t(r,null)},a=null===(e=this.props.extendUI)||void 0===e?void 0:e.topPlaceHolder,u=null===(n=this.props.extendUI)||void 0===n?void 0:n.bottomPlaceHolder;if(i.startsWith("extraTab_")){var d=parseInt(i.substring(i.lastIndexOf("_")+1,i.length),10);"Order"===this.props.orderGroupType&&this.props.orderDetailExtraTabs&&(o=this.props.orderDetailExtraTabs[d].render),"Cart"===this.props.orderGroupType&&this.props.cartDetailExtraTabs&&(o=this.props.cartDetailExtraTabs[d].render),"PaymentPlan"===this.props.orderGroupType&&this.props.paymentPlanExtraTabs&&(o=this.props.paymentPlanExtraTabs[d].render)}return this.props.orderGroup&&t("div",null,t(pi,null),t(Nn,{closeView:function(){return s.closeView()},title:("PaymentPlan"===this.props.orderGroupType?"Payment Plan":this.props.orderGroupType)+" Details",showDialogActions:!0},a&&t(a,{Id:this.props.orderGroupId,className:"top-placeholder"}),t($,{container:!0,direction:"column",spacing:8},t($,{item:!0},"Order"===this.props.orderGroup.Type&&t(yi,null),"Cart"===this.props.orderGroup.Type&&t($,{container:!0,justify:"flex-end",spacing:8},t($,{item:!0},t(se,{outlined:!0,onClick:this.convertCartToOrderHandler,id:"convertToPurchaseOrder"},"Convert to purchase order")),t($,{item:!0},t(se,{outlined:!0,onClick:this.convertCartToPaymentPlanHandler,id:"convertToPaymentPlan"},"Convert to payment plan"))),"PaymentPlan"===this.props.orderGroup.Type&&t($,{container:!0,justify:"flex-end",spacing:8},this.props.orderGroup.CanConvertPaymentPlanToPurchaseOrder&&t($,{item:!0},t(se,{outlined:!0,onClick:this.convertPaymentPlanToOrderHandler,id:"convertPaymenPlanToPurchaseOrder"},"Create First Purchase Order")),this.props.orderGroup.OrderStatus===oi.InProgress&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return s.setState({showCancelPaymentPlanConfirm:!0})},id:"cancelPaymentPlan"},"Cancel Payment Plan")))),t($,null,t(Xe,{position:"static",color:"default"},t(fe,{activeIndex:this.state.selectedOrderTabIndex,handleActiveIndexUpdate:this.orderTabIndexChangedHandler},this.orderTabNames.map((function(e){return t(ge,{key:e.key},e.name)})))),t(b,null,t(O,null,t($,null,"summary"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&("Cart"===this.props.orderGroupType?t(ni,{orderGroup:this.props.orderGroup}):t(ti,{orderGroup:this.props.orderGroup,isReadonly:this.props.isReadonly})),"details"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t($,null,t(yo,{orderForm:this.props.orderGroup.Forms[0]})),"return"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&"Order"===this.props.orderGroup.Type&&t($,null,t(Ai,{orderGroupId:this.props.orderGroupId})),"contact"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t($,null,t(si,{orderGroup:this.props.orderGroup})),"plansettings"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&"PaymentPlan"===this.props.orderGroup.Type&&t($,null,t(ci,{editMode:!1,paymentPlan:this.props.orderGroup})),"orders"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&"PaymentPlan"===this.props.orderGroup.Type&&t($,null,t(Oi,{paymentPlan:this.props.orderGroup})),o&&t(o,{Id:this.props.orderGroupId,className:"extra-tab-content"})))))),u&&t(u,{Id:this.props.orderGroupId,className:"bottom-placeholder"}),this.state.showCancelPaymentPlanConfirm&&t(Sn,{title:"Cancel Payment Plan",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:this.cancelPaymentPlanHandler,onClose:function(){s.setState({showCancelPaymentPlanConfirm:!1})}},t(m,{variant:"body1"},"Are you sure you want to cancel this payment plan?"))))},n}(n),Co=function(e,t){var r,n,s,i;switch(e){case"Order":i=null===(r=t.setting.pageConfig.orderDetail)||void 0===r?void 0:r.extendUI;break;case"Cart":i=null===(n=t.setting.pageConfig.cartDetail)||void 0===n?void 0:n.extendUI;break;case"PaymentPlan":i=null===(s=t.setting.pageConfig.paymentPlanDetail)||void 0===s?void 0:s.extendUI}return i},So=z((function(){return c({})}))(u((function(e,t){var r,n,s,i,o,a,u,d,c,p;return{orderGroupType:t.orderGroupType,orderGroupId:t.orderGroupId,orderGroup:e.orderGroup.currentOrderGroup,rowsPerPage:e.application.rowsPerPage,orderStatuses:e.orderGroup.orderStatuses,currencies:e.orderGroup.currencies,isReadonly:li(e.orderGroup.currentOrderGroup),selectedEntry:e.orderGroup.selectedEntry,hasReadonlyOrderStatus:(p=e.orderGroup.currentOrderGroup,!!p&&("Cart"===p.Type||p.OrderStatus===oi.Cancelled||p.OrderStatus===oi.Completed)),classes:t.classes,orderDetailExtraTabs:null===(s=null===(n=null===(r=e.setting.pageConfig)||void 0===r?void 0:r.orderDetail)||void 0===n?void 0:n.config)||void 0===s?void 0:s.extraTabs,cartDetailExtraTabs:null===(a=null===(o=null===(i=e.setting.pageConfig)||void 0===i?void 0:i.cartDetail)||void 0===o?void 0:o.config)||void 0===a?void 0:a.extraTabs,paymentPlanExtraTabs:null===(c=null===(d=null===(u=e.setting.pageConfig)||void 0===u?void 0:u.paymentPlanDetail)||void 0===d?void 0:d.config)||void 0===c?void 0:c.extraTabs,extendUI:Co(t.orderGroupType,e)}}))(vo)),Io=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.render=function(){return t(So,Bt({},this.props))},r}(n),bo=function(e){return t($,{container:!0,justify:"flex-end",direction:"row",alignItems:"center",spacing:8},t($,{item:!0},t(We,{style:{fontWeight:"normal"},variant:e.variant},e.label)),t($,{item:!0},t(Rs,{amount:e.amount,align:"right",variant:e.variant,style:{fontWeight:"bold",paddingRight:16}})))},Ao=function(e){function r(t){var r=e.call(this,t)||this;return r.state={loaded:!1,errorMessage:"",refundAmountMessage:"",paymentMethodOptions:[],currentPayment:{},returnOrderSummary:{ItemTotal:0,InvalidatedDiscountsTotal:0,ExchangeTotal:0,RefundAmount:0,ExistingPayments:[]},refundAmount:0,maxRefundAmount:0},r.refundForm={},r.existPaymentHandleChange=function(e){var t=r.state.returnOrderSummary.ExistingPayments[e];r.setState({currentPayment:t,refundAmount:Math.min(r.state.maxRefundAmount,t.Amount.Amount)})},r.refundAmountHandlerChange=function(e,t){r.setState({refundAmount:Number(t)})},r.completeReturn=function(){return Wt(r,void 0,void 0,(function(){var e,t,r=this;return qt(this,(function(n){switch(n.label){case 0:if(""!==this.validateRefundForm())return[2];e=this.state.currentPayment,n.label=1;case 1:return n.trys.push([1,5,,6]),this.state.refundAmount>0?[4,ln.OrderGroup.createRefund(this.props.orderGroupId,this.props.orderGroup.Forms[0].OrderFormId,{existingPaymentId:e.PaymentId,amount:this.state.refundAmount})]:[3,3];case 2:n.sent(),n.label=3;case 3:return[4,ln.OrderGroup.completeReturn(this.props.orderGroupId,this.props.returnFormId).catch((function(e){r.setState({errorMessage:e.message})}))];case 4:return n.sent(),this.props.onClose(),as.go(0),[3,6];case 5:return t=n.sent(),this.setState({errorMessage:t.message}),[3,6];case 6:return[2]}}))}))},r.state.paymentMethodOptions=r.props.paymentMethods.map((function(e){return{label:e.Name,value:e.PaymentMethodId}})),r}return Vt(r,e),r.prototype.componentDidMount=function(){return Wt(this,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return[4,ln.OrderGroup.getRefundInfo(this.props.orderGroupId,this.props.returnFormId)];case 1:return(e=t.sent())&&this.setState({returnOrderSummary:Bt({},e.data),maxRefundAmount:e.data.RefundAmount,loaded:!0}),this.state.returnOrderSummary.ExistingPayments.length>0&&this.existPaymentHandleChange(0),[2]}}))}))},r.prototype.validateRefundForm=function(){var e="",t=this.state.currentPayment;return this.state.currentPayment?this.state.refundAmount>t.Amount.Amount&&(e="Total Refund Amount cannot exceed "+t.Amount.Amount):e="Please select Existing Payments!",this.setState({errorMessage:e}),e},r.prototype.render=function(){var e=this;return t(Cn,{open:!0,title:"Create Refund",okLabel:"OK",onOK:this.completeReturn,closeLabel:"Cancel",onClose:function(){e.props.onClose()}},this.state.loaded&&t(Ee,{instantValidate:!0,onSubmit:function(){return null},ref:function(t){return e.refundForm=t}},t(l,{container:!0,direction:"column",spacing:16},t(l,{item:!0},t("span",{style:{color:"red"}},this.state.errorMessage)),t(l,{item:!0},t(h,{variant:"outlined",type:"number",label:"Return Items ("+this.props.orderGroup.Currency+")",fullWidth:!0,disabled:!0,value:this.state.returnOrderSummary.ItemTotal})),t(l,{item:!0},t(h,{variant:"outlined",type:"number",label:"Invalidated Discounts ("+this.props.orderGroup.Currency+")",fullWidth:!0,disabled:!0,value:this.state.returnOrderSummary.InvalidatedDiscountsTotal})),t(l,{item:!0},t(h,{variant:"outlined",type:"number",label:"Exchange Total ("+this.props.orderGroup.Currency+")",fullWidth:!0,disabled:!0,value:this.state.returnOrderSummary.ExchangeTotal})),t(l,{item:!0},t(h,{variant:"outlined",type:"number",label:"Refund Total ("+this.props.orderGroup.Currency+")",fullWidth:!0,disabled:!0,value:this.state.maxRefundAmount})),t(l,{item:!0},this.state.returnOrderSummary.ExistingPayments.map((function(r,n){return t(l,{container:!0,key:n},t(l,{item:!0},t(l,{container:!0,alignItems:"center",spacing:8},t(l,{item:!0},t(_,{value:r.PaymentId,onChange:function(t){return e.existPaymentHandleChange(n)},checked:r.PaymentId===e.state.currentPayment.PaymentId,style:{marginLeft:"-12px"}})),t(l,{item:!0},t(m,null,r.PaymentMethodName+" ("+r.TransactionType+") \n                              - "+r.Amount.Amount+" "+e.props.orderGroup.Currency)))),e.state.currentPayment.PaymentId===r.PaymentId&&t(l,{item:!0,xs:12},t(l,{container:!0,spacing:16},t(l,{item:!0,xs:6},t(h,{variant:"outlined",type:"number",label:"Amount ("+e.props.orderGroup.Currency+")",fullWidth:!0,value:e.state.refundAmount,onChange:function(t){return e.refundAmountHandlerChange(r,t.target.value)},inputProps:{min:0,max:e.state.maxRefundAmount,step:.1}})),t(l,{item:!0,xs:6},t(Jr,{label:"Payment Method",options:e.state.paymentMethodOptions,fullWidth:!0,value:r.PaymentMethodId,disabled:!0})),t(l,{item:!0,xs:12,style:{marginTop:"-10px"}},e.state.refundAmount!==e.state.maxRefundAmount&&t("span",{style:{fontSize:"12px",color:"red"}},"The amount you are refunding is different from the suggested refund total")))))}))))))},r}(n),Oo=u((function(e,t){return Bt(Bt({},t),{paymentMethods:e.payment.paymentMethods,orderGroup:e.orderGroup.currentOrderGroup})}))(Ao),wo=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={confirmDialog:{isOpen:!1,title:"",message:"",closeButtonLabel:"",confirmButtonLabel:"",onConfirm:function(){return null}},isOpenRefundDialog:!1},t}return Vt(r,e),r.prototype.cancelReturn=function(){return Wt(this,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ln.OrderGroup.cancelReturn(this.props.orderGroupId,this.props.returnOrderForm.OrderFormId)];case 1:return t.sent(),this.props.onUpdated(),[3,3];case 2:return e=t.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(e.message)),[3,3];case 3:return this.closeDialog(),[2]}}))}))},r.prototype.updateAcknowledgeReceiptItems=function(){return Wt(this,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ln.OrderGroup.acknowledgeReceiptItems(this.props.orderGroupId,this.props.returnOrderForm.OrderFormId)];case 1:return t.sent(),this.props.onUpdated(),[3,3];case 2:return e=t.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(e.message)),[3,3];case 3:return this.closeDialog(),[2]}}))}))},r.prototype.closeDialog=function(){this.setState({confirmDialog:{isOpen:!1}})},r.prototype.showCancelConfirmDialog=function(){var e=this;this.setState({confirmDialog:{isOpen:!0,title:"Cancel Return",message:"Are you sure you want to cancel this return?",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:function(){return e.cancelReturn()}}})},r.prototype.showAcknowledgeReceiptItemsConfirmDialog=function(){var e=this;this.setState({confirmDialog:{isOpen:!0,title:"Acknowledge Receipt Items",message:"Are you sure you want to acknowledge receipt items?",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:function(){return e.updateAcknowledgeReceiptItems()}}})},r.prototype.canShowCancelButton=function(){return this.props&&this.props.returnOrderForm&&(this.props.returnOrderForm.Status.Code===Ii.AwaitingStockReturn||this.props.returnOrderForm.Status.Code===Ii.AwaitingCompletion)},r.prototype.canShowAcknowledgeButton=function(){return this.props&&this.props.returnOrderForm&&this.props.returnOrderForm.Status.Code===Ii.AwaitingStockReturn},r.prototype.canShowCompleteButton=function(){return this.props&&this.props.returnOrderForm&&this.props.returnOrderForm.Status.Code===Ii.AwaitingCompletion},r.prototype.canShowViewExchangeButton=function(){return this.props&&this.props.returnOrderForm&&this.props.returnOrderForm.ExchangeOrderId>0},r.prototype.canShowCreateExchangeButton=function(){return this.canShowCancelButton()&&this.props.returnOrderForm.ExchangeOrderId<=0},r.prototype.showCreateRefundDialog=function(){this.setState({isOpenRefundDialog:!0})},r.prototype.createExchangeOrder=function(){return Wt(this,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return[4,ln.OrderGroup.initExchangeOrder(this.props.orderGroupId)];case 1:return e=t.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(e)),us("previous_order_create"),as.push(Vr+"?returnFormId="+this.props.returnOrderForm.OrderFormId),[2]}}))}))},r.prototype.viewExchangeOrder=function(e){as.push(Er+"/"+e+"?returnUrl="+cs())},r.prototype.render=function(){var e=this;return t("div",null,t($,{container:!0,justify:"flex-end",spacing:8},this.canShowCompleteButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.showCreateRefundDialog()}},"Complete Return")),this.canShowAcknowledgeButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.showAcknowledgeReceiptItemsConfirmDialog()}},"Acknowledge Receipt Items")),this.canShowViewExchangeButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.viewExchangeOrder(e.props.returnOrderForm.ExchangeOrderId)}},"View Exchange")),this.canShowCreateExchangeButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.createExchangeOrder()}},"Create Exchange")),this.canShowCancelButton()&&t($,{item:!0},t(se,{outlined:!0,onClick:function(){return e.showCancelConfirmDialog()}},"Cancel Return"))),t(Cn,{open:this.state.confirmDialog.isOpen,title:this.state.confirmDialog.title,closeLabel:this.state.confirmDialog.closeButtonLabel,okLabel:this.state.confirmDialog.confirmButtonLabel,onOK:this.state.confirmDialog.onConfirm,onClose:function(){return e.closeDialog()}},t(m,{variant:"body1"},this.state.confirmDialog.message)),this.state.isOpenRefundDialog&&t(Oo,{onClose:function(){e.setState({isOpenRefundDialog:!1})},orderGroupId:this.props.orderGroupId,returnFormId:this.props.returnOrderForm.OrderFormId}))},r}(n),To=u((function(e,t){return Bt({},t)}))(wo),Do=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={returnLineItem:t.props.returnLineItem,returnReasons:Array(),isLoadingResource:!1,returnQuantity:t.props.returnLineItem.ReturnQuantity},t.handleReturnQuantityChange=function(e){isNaN(e.target.value)?t.setState({returnQuantity:0}):t.setState({returnQuantity:Number(e.target.value)})},t.handleReturnReasonChange=function(e){var r=Bt({},t.state.returnLineItem);r.ReturnReason=e,t.setState({returnLineItem:r})},t.update=function(){return Wt(t,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.state.returnQuantity>this.state.returnLineItem.Quantity?(this.props.dispatch(fr.ApplicationActions.showNotification("The return quantity must be less than or equal to available quantity.")),[2]):[4,ln.OrderGroup.updateReturnLineItem(this.props.orderGroupId,this.props.returnFormId,this.state.returnLineItem.LineItemId,this.state.returnQuantity,this.state.returnLineItem.ReturnReason)];case 1:return t.sent(),this.props.onUpdated&&this.props.onUpdated(),[3,3];case 2:return e=t.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(e.message)),[3,3];case 3:return[2]}}))}))},t}return Vt(r,e),r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return e.sent(),[2]}}))}))},r.prototype.getData=function(){return Wt(this,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return this.setState({isLoadingResource:!0}),[4,ln.OrderGroup.getReturnReasons()];case 1:return e=r.sent(),t=e.map((function(e){return{label:e.Label,value:e.Label}})),this.setState({returnReasons:t,isLoadingResource:!1}),[2]}}))}))},r.prototype.render=function(){var e=t($,{container:!0,spacing:16},t($,{item:!0,xs:12,sm:12,md:12},t(Lt,{outlined:!0,label:"Display Name",style:{width:"100%"}},t(Mt,{readOnly:!0,disabled:!0,style:{width:"100%"},value:this.props.returnLineItem.DisplayName}))),t($,{item:!0,xs:12,sm:12,md:12},t(Lt,{outlined:!0,label:"Quantity",style:{width:"100%"}},t(Mt,{type:"number",readOnly:!0,disabled:!0,style:{width:"100%"},value:this.props.returnLineItem.Quantity}))),t($,{item:!0,xs:12,sm:12,md:12},t(Lt,{outlined:!0,onChange:this.handleReturnQuantityChange,style:{width:"100%"},label:"Return Quantity"},t(Mt,{type:"number",step:"0.01",min:"0",disabled:!this.props.isReturnEditable,readOnly:!this.props.isReturnEditable,max:this.state.returnLineItem.Quantity,value:this.state.returnQuantity}))),t($,{item:!0,xs:12,sm:12,md:12},t(Lt,{outlined:!0,type:"number",label:"Placed Price",style:{width:"100%"}},t(Mt,{type:"number",style:{width:"100%"},readOnly:!0,disabled:!0,value:this.props.returnLineItem.PlacedPrice.Amount}))),t($,{item:!0,xs:12,sm:12,md:12},!this.state.isLoadingResource&&t(Jr,{label:"Return Reason",disabled:!this.props.isReturnEditable,fullWidth:!0,value:this.state.returnLineItem.ReturnReason,options:this.state.returnReasons,required:!0,onChange:this.handleReturnReasonChange})));return this.props.isReturnEditable?t(Cn,{title:"Edit Return Line Item",open:!0,okLabel:"Save",onOK:this.update,onClose:this.props.onClose},e):t(Cn,{title:"View Return Line Item",open:!0,onClose:this.props.onClose},e)},r}(n),Po=u()(Do),Go=function(e){function r(r){var n=e.call(this,r)||this;return n.columns=[{name:"NAME",selector:"DisplayName",render:function(e){return t(l,{container:!0,direction:"row",className:n.props.classes.rowData},t(Ji,Bt({},e)),t(l,{item:!0},t(We,{noWrap:!0,variant:"body2",color:"inherit"},e.DisplayName),t(We,{variant:"body1",color:"inherit"},e.Code)))}},{name:"PLACED PRICE",selector:"PlacedPrice",right:!0,render:function(e){return t(Rs,{amount:e.PlacedPrice})}},{name:"PURCHASED QUANTITY",selector:"Quantity",right:!0},{name:"SHIPMENT NO",selector:"OriginalShipmentNo",right:!0},{name:"RETURN QUANTITY",selector:"ReturnQuantity",right:!0},{name:"TOTAL BEFORE RETURN",selector:"Total",right:!0,render:function(e){return t(Rs,{amount:e.Total})}},{name:"",width:10,render:function(e,r){var s=[];return n.isReturnEditable()?(s.push({title:"Edit",clickHandler:function(){return Wt(n,void 0,void 0,(function(){return qt(this,(function(t){return this.goToLineItemDetail(e),[2]}))}))}}),s.push({title:"Delete",clickHandler:function(){return Wt(n,void 0,void 0,(function(){return qt(this,(function(t){return this.setState({currentItem:e,isDeleteDialogOpen:!0}),[2]}))}))}})):s.push({title:"View",clickHandler:function(){return Wt(n,void 0,void 0,(function(){return qt(this,(function(t){return this.goToLineItemDetail(e),[2]}))}))}}),t(Ci,{actions:s,rowData:e,rowIndex:r})}}],n.handleReturnCommentChange=function(e){var t=Bt({},n.state.returnOrderForm);t.ReturnComment=e.target.value,n.setState({returnOrderForm:t})},n.closeDialog=n.closeDialog.bind(n),n}return Vt(r,e),r.prototype.loadPaymentMethods=function(e){return Wt(this,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return[4,ln.PaymentMethod.getPaymentMethods(e)];case 1:return[2,t.sent()]}}))}))},r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return this.setState({isLoadingResource:!0}),[4,this.getData()];case 1:return e.sent(),this.setState({isLoadingResource:!1}),[2]}}))}))},r.prototype.getData=function(){return Wt(this,void 0,void 0,(function(){var e,t,r,n;return qt(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),[4,ln.OrderGroup.getReturn(this.props.orderGroupId,this.props.returnFormId)];case 1:return e=s.sent(),this.setState({returnOrderForm:e}),[4,ln.OrderGroup.getSingleOrderGroup("Order",this.props.orderGroupId)];case 2:return t=s.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(t)),t.ValidationMessages.length>0&&this.props.dispatch(fr.ApplicationActions.showNotification(t.ValidationMessages.join(", "))),[4,this.loadPaymentMethods(t.MarketId)];case 3:return r=s.sent(),this.props.dispatch(fr.PaymentActions.setPaymentMethods(r)),[3,5];case 4:return n=s.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,5];case 5:return[2]}}))}))},r.prototype.cancelReturn=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,ln.OrderGroup.cancelReturn(this.props.orderGroupId,this.props.returnFormId)];case 1:return e.sent(),[4,this.getData()];case 2:return e.sent(),[2]}}))}))},r.prototype.closeView=function(){var e=Er+"/"+this.props.orderGroupId+"?tab=return";as.push(e)},r.prototype.closeDialog=function(){this.setState({lineItemDialogOpen:!1})},r.prototype.goToLineItemDetail=function(e){this.setState({lineItemDialogOpen:!0,returnLineItemSelected:e,isReturnEditable:this.isReturnEditable()})},r.prototype.deleteLineItem=function(e){return Wt(this,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return this.setState({isLoadingResource:!0}),[4,ln.OrderGroup.deleteReturnLineItem(this.props.orderGroupId,this.props.returnFormId,e.LineItemId)];case 1:return t.sent(),[2]}}))}))},r.prototype.updateReturnComment=function(){return Wt(this,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ln.OrderGroup.updateReturnForm(this.props.orderGroupId,this.props.returnFormId,this.state.returnOrderForm)];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(e.message)),[3,3];case 3:return[2]}}))}))},r.prototype.isReturnEditable=function(){return this.state.returnOrderForm.Status.Code===Ii.AwaitingStockReturn},r.prototype.render=function(){var e=this;return t("div",null,t(Nn,{closeView:function(){return e.closeView()},title:"Return Details",showDialogActions:!0},this.state.lineItemDialogOpen&&t(Po,{orderGroupId:this.props.orderGroupId,returnFormId:this.props.returnFormId,returnLineItem:this.state.returnLineItemSelected,isReturnEditable:this.state.isReturnEditable,onUpdated:function(){return Wt(e,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return this.closeDialog(),[4,this.getData()];case 1:return e.sent(),[2]}}))}))},onClose:this.closeDialog}),t(l,{container:!0,direction:"column",spacing:8},t(l,{item:!0},t(To,{onUpdated:function(){return e.getData()},returnOrderForm:this.state.returnOrderForm,orderGroupId:this.props.orderGroupId})),t(l,{item:!0},t(b,null,t(O,null,this.state&&this.state.returnOrderForm&&t(l,{container:!0,direction:"column",spacing:16},t(l,{item:!0},t(We,{className:this.props.classes.rowLabel},"Return No"),t(We,{className:this.props.classes.rowData},this.state.returnOrderForm.RMANumber)),t(l,{item:!0},t(We,{className:this.props.classes.rowLabel},"Created Date"),t(We,{className:this.props.classes.rowData},ot(this.state.returnOrderForm.Created).format("LLL"))),t(l,{item:!0},t(We,{className:this.props.classes.rowLabel},"Created By"),t(We,{className:this.props.classes.rowData},this.state.returnOrderForm.Creator.FullName)),t(l,{item:!0},t(We,{className:this.props.classes.rowLabel},"Status"),t(We,{className:this.props.classes.rowData},this.state.returnOrderForm.Status.Name)),t(l,{item:!0},t(We,{className:this.props.classes.rowLabel},"Comment"),t(Lt,{className:this.props.classes.rowData,textarea:!0,style:{height:"100px",width:"400px"}},t(Mt,{style:{resize:"none"},maxLength:1024,readOnly:this.state.returnOrderForm.Status.Code!==Ii.AwaitingStockReturn,value:this.state.returnOrderForm.ReturnComment,onChange:this.handleReturnCommentChange,onBlur:function(){e.updateReturnComment()}}))),t(l,{item:!0},!this.state.isLoadingResource&&this.state.returnOrderForm&&t(Us,{columns:this.columns,data:mo(this.state.returnOrderForm)})),t(l,null,t(l,null,t(bo,{amount:this.state.returnOrderForm.ItemsTotal,label:"Line Item Total",variant:"subtitle1"})),t(l,null,t(bo,{amount:this.state.returnOrderForm.InvalidDiscount,label:"Invalidated Discounts",variant:"subtitle1"})),t(l,null,t(bo,{amount:this.state.returnOrderForm.Total,label:"Return Total",variant:"subtitle1"}))))))))),t(Cn,{open:this.state.isDeleteDialogOpen,title:"Delete Item",closeLabel:"No",okLabel:"Yes",onOK:function(){e.deleteLineItem(e.state.currentItem).then((function(){e.setState({isDeleteDialogOpen:!1}),e.getData().then((function(){return e.setState({isLoadingResource:!1})}))}))},onClose:function(){return e.setState({isDeleteDialogOpen:!1})}},t(We,{variant:"body1"},"Are you sure you want to delete this item?")))},r}(n),No=p((function(e){e.spacing;return c({rowLabel:{display:"inline-block",width:"200px"},rowData:{display:"inline-block"}})}))(u((function(e,t){return Bt({orderGroup:e.orderGroup.currentOrderGroup},t)}))(Go)),Ro=function(e){function n(t){var r,n=e.call(this,t)||this;if(n.state={selectedOrderTabIndex:1,showConfirmDiscardDialog:!1,returnOrderFormId:-1},n.orderTabNames=new Array,n.orderTabIndexChangedHandler=function(e){return Wt(n,void 0,void 0,(function(){var t;return qt(this,(function(r){return this.setState({selectedOrderTabIndex:e}),(t=new URLSearchParams(as.location.search)).set("tab",this.orderTabNames[e].key),as.replace(as.location.pathname+"?"+t.toString()),[2]}))}))},n.createOrderHandler=function(){return Wt(n,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,ln.OrderGroup.createPurchaseOrder(this.props.orderGroup)];case 1:return e=r.sent(),this.state.returnOrderFormId>-1&&e.ParentOrderId?[4,ln.OrderGroup.updateExchangeOrderId(e.ParentOrderId,this.state.returnOrderFormId,e.OrderGroupId)]:[3,3];case 2:r.sent(),r.label=3;case 3:return as.replace(Er+"/"+e.OrderGroupId),[3,5];case 4:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,5];case 5:return[2]}}))}))},!n.props.orderGroup)return as.push("/?type=Order"),n;n.initOrderTabs(t);var s=new URLSearchParams(as.location.search),i=s.get("tab");if(i){var o=n.orderTabNames.findIndex((function(e){return e.key===i}));o>0&&(n.state.selectedOrderTabIndex=o)}return n.state.returnOrderFormId=parseInt(null!=(r=s.get("returnFormId"))?r:"-1",10),n}return Vt(n,e),n.prototype.initOrderTabs=function(e){this.orderTabNames.push({key:"summary",name:"Summary"}),this.orderTabNames.push({key:"details",name:"Form Details "}),this.orderTabNames.push({key:"contact",name:"Contact Details"})},n.prototype.closeView=function(){var e=ds("previous_order_create");as.push(null!=e?e:"/")},n.prototype.render=function(){var e,n,s=this,i=null===(e=this.props.extendUI)||void 0===e?void 0:e.topPlaceHolder,o=null===(n=this.props.extendUI)||void 0===n?void 0:n.bottomPlaceHolder;return t(r,null,this.props.orderGroup&&t(Nn,{closeView:function(){return s.setState({showConfirmDiscardDialog:!0})},title:"Prepare Order",showDialogActions:!0},i&&t(i,{MarketId:this.props.selectedMarket,CustomerId:this.props.orderGroup.Customer.Id}),t(l,{container:!0,direction:"column",spacing:8},t(l,{item:!0},t(l,{container:!0,justify:"flex-end"},t(l,{item:!0},t(se,{outlined:!0,type:"submit",disabled:!mi(this.props.orderGroup),onClick:this.createOrderHandler},"Create Order")))),t(l,{item:!0},t(V,{position:"static",color:"default"},t(fe,{activeIndex:this.state.selectedOrderTabIndex,handleActiveIndexUpdate:this.orderTabIndexChangedHandler},this.orderTabNames.map((function(e){return t(ge,{key:e.key},e.name)})))),t(b,null,t(O,null,t(l,null,"summary"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t(ti,{orderGroup:this.props.orderGroup,isReadonly:!0,createMode:!0}),"details"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t(l,null,t(yo,{orderForm:this.props.orderGroup.Forms[0]})),"contact"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t(l,null,t(si,{orderGroup:this.props.orderGroup}))))))),o&&t(o,{MarketId:this.props.selectedMarket,CustomerId:this.props.orderGroup.Customer.Id})),this.state.showConfirmDiscardDialog&&t(Sn,{title:"Discard Order",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:this.closeView,onClose:function(){s.setState({showConfirmDiscardDialog:!1})}},t(m,{variant:"body1"},"Are you sure you want to discard Order?")))},n}(n),Eo=u((function(e,t){var r,n;return{selectedMarket:e.market.selectedMarket,orderGroup:e.orderGroup.currentOrderGroup,extendUI:null===(n=null===(r=e.setting.pageConfig)||void 0===r?void 0:r.createOrder)||void 0===n?void 0:n.extendUI}}))(Ro),xo=function(e){function n(t){var r=e.call(this,t)||this;r.state={selectedOrderTabIndex:1,showConfirmDiscardDialog:!1,loaded:!1},r.orderTabNames=new Array,r.paymentPlanSettingValidator={validate:function(){return!1}},r.initCartData=function(){return Wt(r,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return[4,ln.Cart.getCustomerCart(this.props.customerId,this.props.marketId)];case 1:return t.sent()&&this.props.dispatch(fr.ApplicationActions.showNotification("EPiServer Commerce does not allow carts with same customer and market. Existing cart of the customer in current market was cleared.")),[4,ln.Cart.createOrRefreshCart(this.props.customerId,this.props.marketId,"Default")];case 2:return(e=t.sent())&&this.props.dispatch(fr.OrderGroupActions.updateCurrentOrderGroup(e)),[2]}}))}))},r.orderTabIndexChangedHandler=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return this.setState({selectedOrderTabIndex:e}),(t=new URLSearchParams(as.location.search)).set("tab",this.orderTabNames[e].key),as.replace(as.location.pathname+"?"+t.toString()),[2]}))}))},r.closeView=function(){r.props.dispatch(fr.ApplicationActions.closeCustomerSelectionView()),r.props.dispatch(fr.OrderGroupActions.setPaymentPlanSetting({})),ln.Cart.deleteCart(r.props.orderGroup.OrderGroupId);var e=ds("previous_paymentplan_create");as.push(null!=e?e:"/")},r.createPaymentPlanHandler=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ln.PaymentPlan.createPaymentPlan(this.props.orderGroup.OrderGroupId,this.props.paymentPlanSetting)];case 1:return e=r.sent(),as.replace(Lr+"/"+e.OrderGroupId),[3,3];case 2:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,3];case 3:return[2]}}))}))},r.initOrderTabs(t);var n=new URLSearchParams(as.location.search).get("tab");if(n){var s=r.orderTabNames.findIndex((function(e){return e.key===n}));s>0&&(r.state.selectedOrderTabIndex=s)}return r}return Vt(n,e),n.prototype.componentDidMount=function(){return Wt(this,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return this.props.orderGroup&&this.props.orderGroup.OrderGroupId&&this.props.currentOrderGroupId===this.props.orderGroup.OrderGroupId?[3,3]:[4,this.initCartData()];case 1:return t.sent(),[4,ln.Currency.getCurrencies(this.props.orderGroup.MarketId)];case 2:e=t.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrencies(e)),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroupId(this.props.orderGroup.OrderGroupId)),t.label=3;case 3:return this.setState({loaded:!0}),[2]}}))}))},n.prototype.initOrderTabs=function(e){this.orderTabNames.push({key:"summary",name:"Summary"}),this.orderTabNames.push({key:"details",name:"Form Details "}),this.orderTabNames.push({key:"contact",name:"Contact Details"}),this.orderTabNames.push({key:"settings",name:"Settings"})},n.prototype.render=function(){var e,n,s=this,i=null===(e=this.props.extendUI)||void 0===e?void 0:e.topPlaceHolder,o=null===(n=this.props.extendUI)||void 0===n?void 0:n.bottomPlaceHolder;return t(r,null,this.props.orderGroup&&this.state.loaded&&t(Nn,{closeView:function(){return s.setState({showConfirmDiscardDialog:!0})},title:"Create Payment Plan",showDialogActions:!0},i&&t(i,{MarketId:this.props.marketId,CustomerId:this.props.customerId}),t(l,{container:!0,direction:"column",spacing:8},t(l,{item:!0},t(l,{container:!0,justify:"flex-end"},t(l,{item:!0},t(se,{outlined:!0,type:"submit",disabled:!mi(this.props.orderGroup)||!this.paymentPlanSettingValidator.validate(),onClick:this.createPaymentPlanHandler},"Create Payment Plan")))),t(l,{item:!0},t(V,{position:"static",color:"default"},t(fe,{activeIndex:this.state.selectedOrderTabIndex,handleActiveIndexUpdate:this.orderTabIndexChangedHandler},this.orderTabNames.map((function(e){return t(ge,{key:e.key},e.name)})))),t(b,null,t(O,null,t(l,null,"summary"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t(ti,{orderGroup:this.props.orderGroup,isReadonly:!1,createMode:!0}),"details"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t(l,null,t(yo,{orderForm:this.props.orderGroup.Forms[0]})),"contact"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t(l,null,t(si,{orderGroup:this.props.orderGroup})),"settings"===this.orderTabNames[this.state.selectedOrderTabIndex].key&&t(l,null,t(ci,{editMode:!0,createMode:!0,paymentPlan:this.props.orderGroup,validator:this.paymentPlanSettingValidator}))))))),o&&t(o,{MarketId:this.props.marketId,CustomerId:this.props.customerId})),this.state.showConfirmDiscardDialog&&t(Sn,{title:"Discard Payment Plan",closeButtonLabel:"No",confirmButtonLabel:"Yes",onConfirm:this.closeView,onClose:function(){s.setState({showConfirmDiscardDialog:!1})}},t(m,{variant:"body1"},"Are you sure you want to discard Payment Plan?")))},n}(n),Lo=u((function(e,t){var r,n;return{orderGroup:e.orderGroup.currentOrderGroup,currentOrderGroupId:e.orderGroup.currentOrderGroupId,marketId:t.marketId,customerId:t.customerId,paymentPlanSetting:e.orderGroup.paymentPlanSetting,extendUI:null===(n=null===(r=e.setting.pageConfig)||void 0===r?void 0:r.createPaymentPlan)||void 0===n?void 0:n.extendUI}}))(xo),Mo=z((function(e){e.palette,e.spacing,e.breakpoints;return c({root:{border:"solid 1px #000",padding:"8px 12px",backgroundColor:"#fff",textAlign:"center"}})}))(u((function(e,t){return{orderGroupFilterIsVisible:e.application.orderGroupFilterIsVisible,classes:t.classes}}))((function(e){var r=e.classes;return e.orderGroupFilterIsVisible?t("div",{className:r.root},t(We,null,"This feature is yet not available.")):null}))),Fo=require("autosuggest-highlight/match"),ko=require("autosuggest-highlight/parse"),_o=function(e,r){var n=Fo(e.FullName,r.query),s=ko(e.FullName,n),i=Fo(e.Email,r.query),o=ko(e.Email,i);return t(pe,null,t(le,{style:{height:"48px"}},t(he,{primaryText:t("div",null,s.map((function(e,r){return e.highlight?t("span",{key:String(r),style:{fontWeight:500}},e.text):t("strong",{key:String(r),style:{fontWeight:300}},e.text)})),t("div",null,t(m,{color:"textSecondary",gutterBottom:!0},t("div",null,o.map((function(e,r){return e.highlight?t("span",{key:String(r),style:{fontWeight:500}},e.text):t("strong",{key:String(r),style:{fontWeight:300}},e.text)}))))))})),t(me,null))},Vo=function(e){var r=e.ref,n=Ht(e,["ref"]);return t(h,{autoFocus:!0,required:!0,fullWidth:!0,label:"Choose customer",placeholder:"Search by name or e-mail...",variant:"outlined",InputProps:Bt({inputRef:r},n)})},Uo=function(e){return e.FullName};var Bo=z((function(e){e.palette;var t=e.spacing;e.breakpoints;return c({container:{position:"relative"},suggestionsContainerOpen:{position:"absolute",zIndex:1,marginTop:t.unit,left:0,right:0,maxHeight:"300px",overflowY:"auto"},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:2*t.unit},email:{display:"block",fontSize:"0.9em"}})}))(u((function(e,t){var r=e.market.markets.find((function(e){return!0===e.IsCurrentMarket}));return{suggestions:e.application.customerSearchFieldSuggestions,classes:t.classes,listedOrderGroups:e.orderGroup.listedOrderGroups,orderPageIndex:e.application.pageIndex,orderRowsPerPage:e.application.rowsPerPage,selectedMarket:e.market.selectedMarket||(r?r.Id:""),selectedContactId:e.application.selectedContactId,onSelectionChanged:t.onSelectionChanged}}))((function(e){var r=this,n=e.classes,s=i(""),u=s[0],d=s[1],c=i(""),p=c[0],h=c[1];o((function(){!function(){Wt(this,void 0,void 0,(function(){var t,r;return qt(this,(function(n){switch(n.label){case 0:if(!e.selectedContactId||u===e.selectedContactId)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),d(e.selectedContactId),[4,ln.Contact.get(e.selectedContactId)];case 2:return t=n.sent(),e.dispatch(fr.ApplicationActions.setCustomerSearchFieldSuggestions([{Id:t.Id,FullName:t.FullName?t.FullName:"",Email:t.Email?t.Email:""}])),h(t.FullName),e.onSelectionChanged(e.selectedMarket,e.selectedContactId),[3,4];case 3:return r=n.sent(),e.dispatch(fr.ApplicationActions.showNotification(r.message)),[3,4];case 4:return[2]}}))}))}()}),[e.selectedContactId]);var m=a(Nt((function(t){var n=t.value;return Wt(r,void 0,void 0,(function(){var t,r,s;return qt(this,(function(i){switch(i.label){case 0:t=n.trim().toLowerCase(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,ln.Contact.list(t)];case 2:return r=i.sent(),e.dispatch(fr.ApplicationActions.setCustomerSearchFieldSuggestions(r)),[3,4];case 3:return s=i.sent(),e.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,4];case 4:return[2]}}))}))}),1e3,{trailing:!0}),[]),f=function(){e.dispatch(fr.CreateContactFormActions.showCreateContactForm())};return t(l,{container:!0,spacing:16,direction:"row"},t(l,{item:!0,xs:12},t($s,{selectedMarket:e.selectedMarket,updateInputValue:function(t){return function(t){return Wt(r,void 0,void 0,(function(){return qt(this,(function(r){return e.dispatch(fr.MarketActions.setSelectedMarket(t)),e.onSelectionChanged(t,e.selectedContactId),[2]}))}))}(t)}})),t(l,{item:!0,xs:12},t(Et,{renderInputComponent:Vo,suggestions:e.suggestions,onSuggestionsFetchRequested:m,onSuggestionsClearRequested:function(){e.dispatch(fr.ApplicationActions.setCustomerSearchFieldSuggestions([]))},renderSuggestionsContainer:function(e){return function(e,r){var n=e.containerProps,s=e.children;return t("div",{style:{marginTop:"8px"}},!s&&t(se,{onClick:function(e){e.preventDefault(),r(e)},outlined:!0},"New Customer"),t(M,Bt({},n,{style:{marginTop:0},square:!0}),s))}(e,f)},getSuggestionValue:Uo,renderSuggestion:_o,onSuggestionSelected:function(t,n){return Wt(r,void 0,void 0,(function(){return qt(this,(function(t){return e.dispatch(fr.ApplicationActions.setSelectedContactId(n.suggestion.Id)),e.onSelectionChanged(e.selectedMarket,n.suggestion.Id),d(n.suggestion.Id),[2]}))}))},inputProps:{value:p,onChange:function(t,r){r&&(h(r.newValue),""===r.newValue&&(e.onSelectionChanged(e.selectedMarket,""),e.dispatch(fr.ApplicationActions.setSelectedContactId(""))))},type:"search"},theme:{container:n.container,suggestionsContainerOpen:n.suggestionsContainerOpen,suggestionsList:n.suggestionsList,suggestion:n.suggestion}})))}))),Ho=function(e){function n(t){var r=e.call(this,t)||this;return r.getTitle=function(e){switch(e){case"Cart":return"Open Cart";case"Order":return"Create Order";case"PaymentPlan":return"Create Payment Plan";default:return""}},r.selectionChangedHandler=function(e,t){return Wt(r,void 0,void 0,(function(){var r,n;return qt(this,(function(s){switch(s.label){case 0:if(!e||!t)return this.setState({cartMode:null,currentCart:null,isFormValid:!1}),[2];if(this.setState({cartMode:null,isFormValid:!0}),"Cart"!==this.props.orderGroupType)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,ln.Cart.getCustomerCart(t,e)];case 2:return r=s.sent(),this.setState({currentCart:r,cartMode:r?"open":"create"}),[3,4];case 3:return n=s.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(n.message)),[3,4];case 4:return[2]}}))}))},r.createOrRefreshCart=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ln.Cart.createOrRefreshCart(this.props.selectedContactId,this.props.selectedMarket,"Default")];case 1:return(e=r.sent())&&(this.closeView(),as.push(xr+"/"+e.OrderGroupId)),[3,3];case 2:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,3];case 3:return[2]}}))}))},r.openCustomerCart=function(){return Wt(r,void 0,void 0,(function(){return qt(this,(function(e){return this.state.currentCart?(this.closeView(),as.push(xr+"/"+this.state.currentCart.OrderGroupId)):this.props.dispatch(fr.ApplicationActions.showNotification("Cart is not found.")),[2]}))}))},r.createCustomerOrder=function(){return Wt(r,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return[4,ln.OrderGroup.initPurchaseOrder(this.props.selectedContactId,this.props.selectedMarket)];case 1:return e=t.sent(),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup(e)),this.closeView(),us("previous_order_create"),as.push(""+Vr),[2]}}))}))},r.createPaymentPlan=function(){return Wt(r,void 0,void 0,(function(){return qt(this,(function(e){return this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroup({})),this.props.dispatch(fr.OrderGroupActions.setCurrentOrderGroupId(null)),this.closeView(),us("previous_paymentplan_create"),as.push(Ur+"?marketId="+this.props.selectedMarket+"&customerId="+this.props.selectedContactId),[2]}))}))},r.closeView=function(){r.props.dispatch(fr.ApplicationActions.setSelectedContactId("")),r.props.dispatch(fr.ApplicationActions.closeCustomerSelectionView())},r.state={title:r.getTitle(r.props.orderGroupType),orderGroupType:r.props.orderGroupType,isFormValid:!1,currentCart:null,cartMode:null},r}return Vt(n,e),n.prototype.render=function(){return t(te,{open:!0,maxWidth:"sm",fullWidth:!0,onClose:this.closeView,className:this.props.classes.root,classes:{paper:this.props.classes.paper}},t(Ct,null,this.state.title),t(ne,{className:this.props.classes.dialogContent},t(Bo,{onSelectionChanged:this.selectionChangedHandler})),t(re,null,t(se,{onClick:this.closeView},"Cancel"),"Cart"===this.props.orderGroupType&&t(r,null,"create"===this.state.cartMode&&t(se,{disabled:!this.state.isFormValid,unelevated:!0,type:"submit",onClick:this.createOrRefreshCart},"Create a cart"),"open"===this.state.cartMode&&t(se,{disabled:!this.state.isFormValid,unelevated:!0,type:"submit",onClick:this.openCustomerCart},"Open cart")),"Order"===this.props.orderGroupType&&t(se,{disabled:!this.state.isFormValid,unelevated:!0,type:"submit",onClick:this.createCustomerOrder},"Create Order"),"PaymentPlan"===this.props.orderGroupType&&t(se,{disabled:!this.state.isFormValid,unelevated:!0,type:"submit",onClick:this.createPaymentPlan},"Create Payment Plan")))},n}(n),Wo=z((function(e){e.palette,e.spacing,e.breakpoints;return c({root:{},paper:{overflowY:"visible"},dialogContent:{overflowY:"visible"}})}))(u((function(e,t){return{selectedMarket:e.market.selectedMarket,selectedContactId:e.application.selectedContactId,listedOrderGroups:e.orderGroup.listedOrderGroups,orderGroupType:t.orderGroupType,classes:t.classes}}))(Ho)),qo=function(e){function r(t){var r=e.call(this,t)||this;return r.updateInputValue=function(e){return Wt(r,void 0,void 0,(function(){var t;return qt(this,(function(r){return(t=Object.assign({},this.props.contact))[e.target.name]=String(e.target.value),this.props.dispatch(fr.CreateContactFormActions.setCreateContactFormContact(t)),[2]}))}))},r.saveChanges=function(){return Wt(r,void 0,void 0,(function(){var e,t;return qt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,ln.Contact.createContact(this.props.contact)];case 1:return e=r.sent(),this.props.dispatch(fr.ApplicationActions.setSelectedContactId(e.Id)),this.closeView(),[3,3];case 2:return t=r.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(t.message)),[3,3];case 3:return[2]}}))}))},r.closeView=function(){r.props.dispatch(fr.CreateContactFormActions.hideCreateContactForm())},r}return Vt(r,e),r.prototype.componentDidUpdate=function(e){this.currentForm&&e.isCurrentFormValid!==this.currentForm.isFormValid()&&this.props.dispatch(fr.CreateContactFormActions.setCreateContactFormIsValid(this.currentForm.isFormValid()))},r.prototype.render=function(){var e=this;return t(te,{open:!0,maxWidth:"sm",fullWidth:!0},t(Ct,null,"Create Contact"),t(ne,null,t(Ee,{ref:function(t){return e.currentForm=t},onSubmit:this.saveChanges},t(ms,{contact:this.props.contact,saveChanges:this.saveChanges,updateInputValue:this.updateInputValue}))),t(re,null,t(se,{onClick:this.closeView},"Cancel"),t(se,{unelevated:!0,type:"submit",disabled:!this.props.isCurrentFormValid,onClick:this.saveChanges},"Save Customer")))},r}(n),jo=u((function(e){return{contact:e.createContactForm.contact,selectedMarket:e.market.selectedMarket,isCurrentFormValid:e.createContactForm.isValid,listedOrderGroups:e.orderGroup.listedOrderGroups}}))(qo),Yo=require("autosuggest-highlight/match"),zo=require("autosuggest-highlight/parse"),Qo=function(e,r){var n=Yo(e.FullName,r.query),s=zo(e.FullName,n),i=Yo(e.Email,r.query),o=zo(e.Email,i);return t(pe,null,t(le,{style:{height:"48px"}},t(he,{primaryText:t("div",null,s.map((function(e,r){return e.highlight?t("span",{key:String(r),style:{fontWeight:500}},e.text):t("strong",{key:String(r),style:{fontWeight:300}},e.text)})),t("div",null,t(m,{color:"textSecondary",gutterBottom:!0},t("div",null,o.map((function(e,r){return e.highlight?t("span",{key:String(r),style:{fontWeight:500}},e.text):t("strong",{key:String(r),style:{fontWeight:300}},e.text)}))))))})),t(me,null))},Ko=function(e){var r=e.ref,n=Ht(e,["ref"]);return t(h,{autoFocus:!0,required:!0,fullWidth:!0,label:"Choose customer",placeholder:"Search by name or e-mail...",variant:"outlined",InputProps:Bt({inputRef:r},n)})},Xo=function(e){return e.FullName};var Jo=z((function(){return c({container:{position:"relative"},suggestionsContainerOpen:{zIndex:1,position:"fixed",marginTop:"0px",maxHeight:"300px",overflowY:"auto",width:"512px"},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"}})}))(u((function(e,t){return{classes:t.classes,onContactSelected:t.onContactSelected,onClose:t.onClose}}))((function(e){var r=this,n=e.classes,s=i(""),o=s[0],u=s[1],d=i([]),c=d[0],p=d[1],h=a(Nt((function(t){var n=t.value;return Wt(r,void 0,void 0,(function(){var t,r,s;return qt(this,(function(i){switch(i.label){case 0:t=n.trim().toLowerCase(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,ln.Contact.list(t)];case 2:return r=i.sent(),p(r),[3,4];case 3:return s=i.sent(),e.dispatch(fr.ApplicationActions.showNotification(s.message)),[3,4];case 4:return[2]}}))}))}),1e3,{trailing:!0}),[]);return t(Cn,{title:"Open Customer",open:!0,onClose:e.onClose},t(l,{container:!0,spacing:16},t(l,{item:!0,xs:12},t(Et,{renderInputComponent:Ko,suggestions:c,onSuggestionsFetchRequested:h,onSuggestionsClearRequested:function(){p([])},renderSuggestionsContainer:function(e){return function(e){var r=e.containerProps,n=e.children;return t(M,Bt({},r),n)}(e)},getSuggestionValue:Xo,renderSuggestion:Qo,onSuggestionSelected:function(t,n){return Wt(r,void 0,void 0,(function(){return qt(this,(function(t){return e.onContactSelected&&e.onContactSelected(n.suggestion.Id),[2]}))}))},inputProps:{value:o,onChange:function(e,t){t&&u(t.newValue)},type:"search"},theme:{container:n.container,suggestionsContainerOpen:n.suggestionsContainerOpen,suggestionsList:n.suggestionsList,suggestion:n.suggestion}}))))}))),Zo=function(e){function r(t){var r=e.call(this,t)||this;return r.state={orderGroupType:r.props.orderGroupType,searchText:r.props.searchText,searchInputValue:r.props.searchText,isLoadingResource:!0,searchOptions:r.getSearchTypeOptions(r.props.orderGroupType),searchType:r.props.searchType,openCustomerDialogVisible:!1},r.handleScroll=function(){return Wt(r,void 0,void 0,(function(){var e;return qt(this,(function(t){switch(t.label){case 0:return window.innerHeight+window.pageYOffset>=document.body.offsetHeight&&this.props.listedOrderGroups.length<this.props.totalOrderGroups?(e=this.props.pageIndex+1,this.props.dispatch(fr.ApplicationActions.setOrderGroupListPageIndex(e)),[4,this.loadOrderGroups(this.state.orderGroupType,e*this.props.rowsPerPage,this.props.rowsPerPage,this.state.searchText,this.state.searchType)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},r.handleCreateOrder=function(){us(Mr),r.openCustomerSelectionView()},r.handleCreatePaymentPlan=function(){us(Mr),r.openCustomerSelectionView()},r.handleSearchTextChange=function(e){r.setState({searchInputValue:e.target.value})},r.clearSearchText=function(){r.setState({searchInputValue:"",searchText:""}),r.loadSearchResults({orderGroupType:r.state.orderGroupType,startingIndex:0,numberOfRecords:r.props.rowsPerPage,searchText:"",searchType:r.state.searchType})},r.loadSearchResults=function(e){return Wt(r,void 0,void 0,(function(){return qt(this,(function(t){return 0===e.searchText.length?as.push("/?type="+e.orderGroupType+"&searchBy="+e.searchType):as.push("/?type="+e.orderGroupType+"&search="+encodeURIComponent(e.searchText)+"&searchBy="+e.searchType),this.setState({isLoadingResource:!0}),this.loadOrderGroups(e.orderGroupType,e.startingIndex,e.numberOfRecords,e.searchText,e.searchType),[2]}))}))},r.handleEnterKeypress=function(){return Wt(r,void 0,void 0,(function(){var e;return qt(this,(function(t){return e=this.state.searchInputValue.trim(),this.setState({searchText:e}),this.loadSearchResults({orderGroupType:this.state.orderGroupType,startingIndex:0,numberOfRecords:this.props.rowsPerPage,searchText:e,searchType:this.state.searchType}),[2]}))}))},r.handleSearchTypeChange=function(e){r.setState({searchInputValue:"",searchText:"",searchType:e}),r.loadSearchResults({orderGroupType:r.state.orderGroupType,startingIndex:0,numberOfRecords:r.props.rowsPerPage,searchText:"",searchType:e})},r.handleOpenCustomerSearchDialog=function(){r.setState({openCustomerDialogVisible:!0})},r.handleCloseCustomerSearchDialog=function(){r.setState({openCustomerDialogVisible:!1})},r.handleContactSelected=function(e){us(Dr),as.push(Tr+"/"+e+"/info"),r.setState({openCustomerDialogVisible:!1})},r.listOrderGroups=function(e){r.props.dispatch(fr.OrderGroupActions.listOrderGroups(e)),r.props.dispatch(fr.ContactActions.setCurrentContact(null))},r.openCustomerSelectionView=function(){r.props.dispatch(fr.ApplicationActions.setCustomerSearchFieldValue("")),r.props.dispatch(fr.ApplicationActions.openCustomerSelectionView())},r.handleEnterThrottle=Rt(r.handleEnterKeypress,500),r}return Vt(r,e),r.prototype.componentWillReceiveProps=function(e){var t=e.searchText===this.props.searchText||e.searchText===this.state.searchText,r=e.searchType===this.props.searchType||e.searchType===this.state.searchType;t&&r||(this.setState({searchInputValue:e.searchText,searchText:e.searchText,searchType:e.searchType}),this.loadOrderGroups(e.orderGroupType,0,this.props.rowsPerPage,e.searchText,e.searchType))},r.prototype.componentWillUnmount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){return window.removeEventListener("scroll",this.handleScroll),[2]}))}))},r.prototype.componentDidMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){return window.addEventListener("scroll",this.handleScroll),[2]}))}))},r.prototype.componentWillMount=function(){return Wt(this,void 0,void 0,(function(){var e=this;return qt(this,(function(t){switch(t.label){case 0:return[4,this.loadOrderGroups(this.state.orderGroupType,0,this.props.rowsPerPage,this.state.searchText,this.state.searchType).then((function(){e.setState({isLoadingResource:!1})}))];case 1:return t.sent(),[2]}}))}))},r.prototype.switchOrderGroupType=function(e){return Wt(this,void 0,void 0,(function(){return qt(this,(function(t){switch(t.label){case 0:return as.replace("/?type="+e),this.setState({orderGroupType:e,searchOptions:this.getSearchTypeOptions(e),searchType:ii.CustomerName,searchInputValue:"",searchText:""}),[4,this.loadOrderGroups(e,0,this.props.rowsPerPage,"",ii.CustomerName)];case 1:return t.sent(),[2]}}))}))},r.prototype.loadOrderGroups=function(e,t,r,n,s){return Wt(this,void 0,void 0,(function(){var i,o,a;return qt(this,(function(u){switch(u.label){case 0:this.setState({isLoadingResource:!0}),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,ln.OrderGroup.getOrders({orderGroupType:e,startingIndex:t,numberOfRecords:r,searchText:n,searchType:s})];case 2:return i=u.sent(),o=i.Results,0===t?this.listOrderGroups(jt(o)):this.listOrderGroups(jt(this.props.listedOrderGroups,o)),this.props.dispatch(fr.ApplicationActions.setTotalOrderGroups(i.TotalOrderGroups)),[3,4];case 3:return a=u.sent(),this.props.dispatch(fr.ApplicationActions.showNotification(a.message)),[3,4];case 4:return this.setState({isLoadingResource:!1}),[2]}}))}))},r.prototype.goToDetail=function(e,t){switch(t){case"Order":us(Mr),as.push(Er+"/"+e);break;case"PaymentPlan":us(kr),as.push(Lr+"/"+e);break;default:us(Fr),as.push(xr+"/"+e)}},r.prototype.getSearchTypeOptions=function(e){switch(e){case"Order":return[{label:"Search by Customer Name",value:ii.CustomerName},{label:"Search by Order Number",value:ii.OrderNumber},{label:"Search by Email",value:ii.Email}];default:return[{label:"Search by Customer Name",value:ii.CustomerName},{label:"Search by Email",value:ii.Email}]}},r.prototype.renderGridBody=function(){var e=this;return this.state.searchText.length>0&&0===this.props.listedOrderGroups.length?t(We,null,"Sorry, we couldn't find any results matching \""+this.state.searchText+'"'):this.props.listedOrderGroups.map((function(r,n){var s=t(We,{variant:"body1",className:e.props.classes.orderStatusText},Qs(r.OrderStatus)),i=[];return r.HasAwaitingReturnCompletable&&i.push("Awaiting Return Completion"),r.HasAwaitingStockReturns&&i.push("Awaiting Stock Return"),t($,{item:!0,key:n,onClick:function(){return e.goToDetail(r.OrderGroupId,r.Type)},className:e.props.classes.orderRow},t($,{container:!0,direction:"row",spacing:16,alignItems:"flex-start",justify:"space-between"},t($,{item:!0,xs:12,md:1,className:e.props.classes.orderGroupId},t(We,{variant:"body1"},"Order"===r.Type?r.OrderNumber:"# "+r.OrderGroupId)),t($,{item:!0,xs:12,md:2,className:e.props.classes.orderDate},t(We,{variant:"body1",className:e.props.classes.orderDateText},r.Created&&ot(r.Created).format("LLL"))),t($,{item:!0,xs:12,md:1,className:e.props.classes.cartName},t(We,{variant:"body1"},r.Name)),t($,{item:!0,xs:12,md:1,className:e.props.classes.marketName},t(We,{variant:"body1"},r.MarketName)),t($,{item:!0,xs:12,md:1,className:e.props.classes.customerName},t(We,{variant:"body1"},r.CustomerName)),t($,{item:!0,xs:12,sm:12,md:2,className:e.props.classes.email},t(We,{variant:"body1"},r.Customer.Email)),t($,{item:!0,xs:12,sm:6,md:2,className:e.props.classes.orderAmount},t(Rs,{amount:r.Total,className:e.props.classes.orderAmountText,align:"right"})),t($,{item:!0,xs:12,sm:6,md:2,className:e.props.classes.orderStatus},s,i.length>0&&t(We,{variant:"subtitle2"},"(",i.join(", "),")"))))}))},r.prototype.render=function(){var e=this;return t(b,{className:this.props.classes.root},t(O,null,t($,{container:!0,spacing:16,direction:"column"},t($,{item:!0},t($,{container:!0,justify:"space-between"},t($,{item:!0},t($,{container:!0,spacing:8},t($,{item:!0},t(se,{unelevated:"Cart"===this.state.orderGroupType,outlined:!0,onClick:function(){return e.switchOrderGroupType("Cart")}},"Carts")),t($,{item:!0},t(se,{unelevated:"Order"===this.state.orderGroupType,outlined:!0,onClick:function(){return e.switchOrderGroupType("Order")}},"Orders")),t($,{item:!0},t(se,{unelevated:"PaymentPlan"===this.state.orderGroupType,outlined:!0,onClick:function(){return e.switchOrderGroupType("PaymentPlan")}},"Payment plan")),t($,{item:!0},t(Jr,{dense:!0,value:this.state.searchType,options:this.state.searchOptions,onChange:this.handleSearchTypeChange})),t($,{item:!0},t(h,{value:this.state.searchInputValue,variant:"outlined",placeholder:"Search",onChange:this.handleSearchTextChange,onKeyPress:function(t){"Enter"===t.key&&e.handleEnterThrottle()},InputProps:{classes:{root:this.props.classes.searchInput},startAdornment:t(U,{position:"start"},t(Ft,null)),endAdornment:0===this.state.searchInputValue.length?void 0:t(U,{position:"end"},t(kt,{onClick:this.clearSearchText}))}})))),t($,{item:!0},t($,{container:!0,spacing:8},t($,{item:!0},"Cart"===this.state.orderGroupType&&t(se,{onClick:this.openCustomerSelectionView,outlined:!0},"Open Cart"),"Order"===this.state.orderGroupType&&t(se,{outlined:!0,onClick:this.handleCreateOrder},"Create Order"),"PaymentPlan"===this.state.orderGroupType&&t(se,{outlined:!0,onClick:this.handleCreatePaymentPlan},"Create Payment Plan")),t($,{item:!0},t(se,{outlined:!0,onClick:this.handleOpenCustomerSearchDialog},"Open Customer"),this.state.openCustomerDialogVisible&&t(Jo,{onContactSelected:this.handleContactSelected,onClose:this.handleCloseCustomerSearchDialog})))))),t($,{item:!0},t($,{container:!0,direction:"column"},t($,{item:!0},t(Ke,{smDown:!0},t($,{item:!0,className:this.props.classes.orderHeaderRow},t($,{container:!0,direction:"row",spacing:16,alignItems:"flex-start",justify:"space-between"},t($,{item:!0,xs:6,md:1},t(We,{variant:"caption"},"No.")),t($,{item:!0,xs:6,md:2},t(We,{variant:"caption"},"Created Date")),t($,{item:!0,xs:6,md:1},t(We,{variant:"caption"},"Name")),t($,{item:!0,xs:6,md:1},t(We,{variant:"caption"},"Market")),t($,{item:!0,xs:12,sm:6,md:1},t(We,{variant:"caption"},"Customer Name")),t($,{item:!0,xs:12,sm:6,md:2},t(We,{variant:"caption"},"Customer Email")),t($,{item:!0,xs:6,sm:6,md:2},t(We,{variant:"caption",align:"right"},"Amount")),t($,{item:!0,xs:6,sm:6,md:2},t(We,{variant:"caption"},"Status"))))),this.renderGridBody()),this.state.isLoadingResource&&t($,{item:!0},t(Ce,{className:this.props.classes.progressIndicator})))))))},r}(n),$o={cursor:"pointer",borderBottom:"1px solid #eee",paddingTop:mn.paddingDefault,paddingBottom:mn.paddingDefault},ea=z((function(e){var t,r,n,s,i,o,a,u,d,p,l,h=e.palette,m=(e.spacing,e.breakpoints);return c({root:{margin:15,width:"calc(100% - 30px)"},orderRow:Bt(Bt({},$o),{paddingLeft:5,paddingRight:5,cursor:"pointer","&:hover":{backgroundColor:fn.hoveredList,color:h.getContrastText(fn.hoveredList)}}),orderHeaderRow:Bt({},$o),emptyListStatement:{margin:mn.marginDefault,padding:mn.paddingDefault,textAlign:"center"},progressContainer:{marginTop:8,textAlign:"center"},progressIndicator:{margin:8,color:h.secondary.light},customerName:(t={fontWeight:"bold",order:4},t[m.down("sm")]={order:0},t),email:(r={fontWeight:"bold",order:5},r[m.down("sm")]={order:1},r),customerNameText:{fontWeight:"bold"},orderDate:(n={order:2},n[m.down("sm")]={order:3},n),orderDateText:(s={},s[m.down("sm")]={color:h.secondary.light},s),orderGroupId:(i={order:1},i[m.down("sm")]={display:"none"},i),marketName:(o={order:4},o[m.down("sm")]={order:2},o),cartName:(a={order:3},a[m.down("sm")]={display:"none"},a),orderAmount:(u={order:6},u[m.down("sm")]={order:4},u),orderAmountText:(d={},d[m.down("sm")]={textAlign:"left"},d),orderStatus:(p={order:7},p[m.down("sm")]={order:5},p),orderStatusText:(l={},l[m.down("sm")]={color:h.secondary.light},l),searchInput:{height:"36px"}})}))(u((function(e,t){return{listedOrderGroups:e.orderGroup.listedOrderGroups,pageIndex:e.application.pageIndex,rowsPerPage:e.application.rowsPerPage,totalOrderGroups:e.application.totalOrderGroups,orderGroupType:t.orderGroupType,classes:t.classes,searchText:t.searchText,searchType:t.searchType}}))(Zo)),ta=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.render=function(){var e,r,n=null===(e=this.props.extendUI)||void 0===e?void 0:e.topPlaceHolder,s=null===(r=this.props.extendUI)||void 0===r?void 0:r.bottomPlaceHolder;return t("div",null,n&&t(n,{className:"top-placeholder"}),t(Mo,null),this.props.customerSelectionViewIsVisible&&t(Wo,{orderGroupType:this.props.orderGroupType}),this.props.createContactFormIsVisible&&t(jo,null),t(ea,{orderGroupType:this.props.orderGroupType,searchText:this.props.searchText,searchType:this.props.searchType}),s&&t(s,{className:"bottom-placeholder"}))},r}(n),ra=function(e,t){var r,n,s,i;switch(e){case"Order":i=null===(r=t.setting.pageConfig.orderList)||void 0===r?void 0:r.extendUI;break;case"Cart":i=null===(n=t.setting.pageConfig.cartList)||void 0===n?void 0:n.extendUI;break;case"PaymentPlan":i=null===(s=t.setting.pageConfig.paymentPlanList)||void 0===s?void 0:s.extendUI}return i};var na,sa=(na=z((function(e){return e.palette,e.spacing,e.breakpoints,c({})}))(u((function(e,t){return{customerSelectionViewIsVisible:e.application.customerSelectionViewIsVisible,orderGroupType:t.orderGroupType,searchText:t.searchText,searchType:t.searchType,orderGroupViewIsVisible:e.application.orderGroupViewIsVisible,createContactFormIsVisible:e.createContactForm.isVisible,classes:t.classes,extendUI:ra(t.orderGroupType,e)}}))(ta)),function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Vt(r,e),r.prototype.render=function(){return t("div",null,this.props.topPlaceHolder?this.props.topPlaceHolder:"",t(na,Bt({},this.props)),this.props.bottomPlaceHolder?this.props.bottomPlaceHolder:"")},r}(n)),ia=u((function(e,t){var r;return{extraPages:null===(r=e.setting.pageConfig)||void 0===r?void 0:r.extraPages}}))((function(e){return t(Ve,null,t("div",null,t(_e,{path:Dr,render:function(e){return t(Ns,Bt({customerId:e.match.params.id},e))}}),t(_e,{path:Mr,exact:!0,render:function(e){var r=e.match.params;return t(Io,{orderGroupId:r.id,orderGroupType:"Order"})}}),t(_e,{path:Fr,exact:!0,render:function(e){var r=e.match.params;return t(Io,{orderGroupId:r.id,orderGroupType:"Cart"})}}),t(_e,{path:kr,exact:!0,render:function(e){var r=e.match.params;return t(Io,{orderGroupId:r.id,orderGroupType:"PaymentPlan"})}}),t(_e,{path:_r,exact:!0,render:function(e){var r=e.match.params;return t(No,{orderGroupId:r.id,returnFormId:r.formId})}}),t(_e,{path:Vr,render:function(e){return t(Eo,Bt({},e))}}),t(_e,{path:Ur,render:function(e){var r=new URLSearchParams(e.location.search),n=r.get("customerId")||"",s=r.get("marketId")||"";return t(Lo,{customerId:n,marketId:s})}}),t(_e,{path:wr,exact:!0,render:function(e){var r,n,s,i=new URLSearchParams(e.location.search),o=i.get("type");switch(o){case"Order":o="Order";break;case"PaymentPlan":o="PaymentPlan";break;default:o="Cart"}var a=null!=(r=i.get("search"))?r:"",u=null!=(s=ii[(n=i.get("searchBy"),null!=n?n:"CustomerName")])?s:ii.CustomerName;return u===ii.OrderNumber&&"Order"!==o&&(u=ii.CustomerName),t(sa,{orderGroupType:o,searchText:a,searchType:u})}}),e.extraPages&&e.extraPages.map((function(e){return t(_e,{key:e.path,path:e.path,exact:e.exact,render:function(t){return e.render(t)}})}))))})),oa=K({typography:{fontFamily:"Barlow, sans-serif",useNextVariants:!0},palette:{primary:{main:"#1456F1",light:"#8EBAFF",contrastText:"#fff"},secondary:{main:"#FF9283",contrastText:"#000"},error:{main:"#f01c10"}},overrides:{MuiCard:{root:{overflow:"unset"}},MuiModal:{root:{zIndex:1e4}},MuiSnackbar:{root:{zIndex:10001}}}});(new Or).initialize(gr);var aa=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={ready:!1},t}return Vt(r,e),r.prototype.componentDidMount=function(){return Wt(this,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,Wt(void 0,void 0,void 0,(function(){var e,t,r,n,s,i;return qt(this,(function(o){switch(o.label){case 0:return[4,Wt(void 0,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,ln.Geographics.getCountries()];case 1:return[2,e.sent()]}}))}))];case 1:return e=o.sent(),gr.dispatch(fr.GeographicsActions.setCountries(e)),[4,Wt(void 0,void 0,void 0,(function(){return qt(this,(function(e){switch(e.label){case 0:return[4,ln.Market.getMarkets()];case 1:return[2,e.sent()]}}))}))];case 2:return t=o.sent(),gr.dispatch(fr.MarketActions.setMarkets(t)),r=t.find((function(e){return!0===e.IsCurrentMarket})),gr.dispatch(fr.MarketActions.setSelectedMarket(r?r.Id:"")),[4,ln.Shipment.getShippingMethods()];case 3:return n=o.sent(),gr.dispatch(fr.ShipmentActions.setShippingMethods(n)),[4,ln.OrderGroup.getOrderStatuses()];case 4:return s=o.sent(),gr.dispatch(fr.OrderGroupActions.setOrderStatuses(s)),[4,ln.Shipment.getShipmentStatuses()];case 5:return i=o.sent(),gr.dispatch(fr.ShipmentActions.setShipmentStatuses(i)),[2]}}))}))];case 1:return e.sent(),this.setState({ready:!0}),null!=this.props.setting&&gr.dispatch(fr.AppSettingActions.updateSetting(this.props.setting)),[2]}}))}))},r.prototype.render=function(){return this.state.ready&&t(d,{store:gr},t(B,{theme:oa},t(q,{utils:X},t(yr,null),t(Ar,null),t(vr,null),t(Cr,null),t(ia,null))))},r}(n),ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Vt(t,e),t}((function(){}));export{ua as AppSettingState,aa as CSRApp};
